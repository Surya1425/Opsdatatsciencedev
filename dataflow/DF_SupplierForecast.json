{
	"name": "DF_SupplierForecast",
	"properties": {
		"description": "SupplierForecast",
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "ds_csv_input",
						"type": "DatasetReference"
					},
					"name": "source1"
				},
				{
					"dataset": {
						"referenceName": "ds_csv_input",
						"type": "DatasetReference"
					},
					"name": "source2"
				},
				{
					"dataset": {
						"referenceName": "ds_csv_input",
						"type": "DatasetReference"
					},
					"name": "source3"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "ds_csv_output",
						"type": "DatasetReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "aggregate1"
				},
				{
					"name": "select1"
				},
				{
					"name": "filter1"
				},
				{
					"name": "join1"
				},
				{
					"name": "aggregate2"
				},
				{
					"name": "select2"
				},
				{
					"name": "select3"
				},
				{
					"name": "derivedColumn4"
				},
				{
					"name": "select4"
				},
				{
					"name": "aggregate3"
				},
				{
					"name": "aggregate4"
				},
				{
					"name": "aggregate5"
				},
				{
					"name": "select5"
				},
				{
					"name": "aggregate6"
				},
				{
					"name": "derivedColumn6"
				},
				{
					"name": "select6"
				},
				{
					"name": "aggregate7"
				},
				{
					"name": "pivot1"
				},
				{
					"name": "join2"
				},
				{
					"name": "derivedColumn7"
				},
				{
					"name": "select7"
				},
				{
					"name": "aggregate8"
				},
				{
					"name": "derivedColumn8"
				},
				{
					"name": "select8"
				},
				{
					"name": "aggregate9"
				},
				{
					"name": "pivot2"
				},
				{
					"name": "join3"
				},
				{
					"name": "join4"
				},
				{
					"name": "filter2"
				},
				{
					"name": "derivedColumn9"
				},
				{
					"name": "select9"
				},
				{
					"name": "filter3"
				},
				{
					"name": "filter4"
				},
				{
					"name": "join5"
				},
				{
					"name": "join6"
				},
				{
					"name": "select10"
				},
				{
					"name": "select11"
				},
				{
					"name": "derivedColumn10"
				},
				{
					"name": "derivedColumn11"
				},
				{
					"name": "filter5"
				},
				{
					"name": "filter6"
				},
				{
					"name": "select12"
				},
				{
					"name": "select13"
				},
				{
					"name": "aggregate10"
				},
				{
					"name": "union2"
				},
				{
					"name": "select14"
				},
				{
					"name": "aggregate11"
				},
				{
					"name": "derivedColumn12"
				},
				{
					"name": "select15"
				},
				{
					"name": "aggregate12"
				},
				{
					"name": "pivot3"
				},
				{
					"name": "join7"
				},
				{
					"name": "derivedColumn13"
				},
				{
					"name": "aggregate13"
				},
				{
					"name": "select16"
				},
				{
					"name": "derivedColumn14"
				},
				{
					"name": "aggregate14"
				},
				{
					"name": "select17"
				},
				{
					"name": "aggregate15"
				},
				{
					"name": "pivot4"
				},
				{
					"name": "join8"
				},
				{
					"name": "derivedColumn15"
				},
				{
					"name": "unionto1"
				},
				{
					"name": "unionto2"
				},
				{
					"name": "unionto3"
				},
				{
					"name": "unionto4"
				},
				{
					"name": "union3"
				},
				{
					"name": "union4"
				},
				{
					"name": "union5"
				},
				{
					"name": "sort1"
				},
				{
					"name": "aggregate16"
				},
				{
					"name": "join9"
				},
				{
					"name": "select18"
				}
			],
			"scriptLines": [
				"parameters{",
				"     Uniquerows as string ('Treasury Account Symbol,Unit Meas Lookup Code,Unit Price,Unit Price Base,Unit Price Base Orig,Unit Price Orig,Vendor Name,Vendor Number,Vendor Site,Wip Entity Id,Acceptance Due Date,Acceptance Required Flag,Account Segment4,Accrue On Receipt Flag,Accrued Flag,Acctacrl$Cv$Accounting Kff,Acctacrl$Code Combination Id,Acctacrl$Qv$Balancing,Acctacrl$Qv$Cost Center,Acctacrl$Qv$Natural Account,Acctacrl$Segment Name List,Acctacrl$Structure Name,Acctbdgt$Cv$Accounting Kff,Acctbdgt$Code Combination Id,Acctbdgt$Qv$Balancing,Acctbdgt$Qv$Cost Center,Acctbdgt$Qv$Natural Account,Acctbdgt$Segment Name List,Acctbdgt$Structure Name,Acctchrg$Cv$Accounting Kff,Acctchrg$Code Combination Id,Acctchrg$Qv$Balancing,Acctchrg$Qv$Cost Center,Acctchrg$Qv$Natural Account,Acctchrg$Segment Name List,Acctchrg$Structure Name,Acctvar$Cv$Accounting Kff,Acctvar$Code Combination Id,Acctvar$Qv$Balancing,Acctvar$Qv$Cost Center,Acctvar$Qv$Natural Account,Acctvar$Segment Name List,Acctvar$Structure Name,Actual Unit Price,Actual Unit Price Base,Agreed Unit Price,Agreed Unit Price Base,Amount Billed,Amount Billed Base,Authorization Status,Award Class Current Contract,Award Class Po,Base Currency Code,Buyer Name,Buyer Number,Cancel Flag,Canceled Amount,Chart Of Accounts Name,Class Code,Closed Code,Closure Status,Code Description,Consigned Flag,Cost Center Segment3,Deliver To Loc Description,Deliver To Location,Deliver To Person,Deliver To Person Number,Delivered Amount,Destination Org Code,Destination Organization,Destination Subinventory,Destination Type Code,Distribution Creation Date,Distribution Id,Distribution Number,Division Segment2,Expenditure Item Date,Expenditure Organization,Expenditure Type,Fob Code,First Po Approval Date,Gl Cancelled Date,Gl Closed Date,Gl Encumbered Date,Government Trasnparency Clause,Hazard Class,Header Id,Item$Inventory Item Id,Item$Organization Id,Item$Sv$Part Number,Itemcat$Cv$Item Category Kff,Itemcat$Category Id,Item Description,Item First Purchase Date,Item Processing Lead Time,Item Revision,Item Type,Job Name,Last Receipt Date,Ledger Name,Line Id,Matching Type,Naics Code,Need By Date,Non Recoverable Tax,Note To Vendor,Open Value,Operating Unit Name,Ordered Amount,Orig Rev Promised Date,Pdstr$Ams   Arrived At Vendor,Pdstr$Ams   Hold End,Pdstr$Ams   Hold Start,Pdstr$Ams   In Warranty,Pdstr$Ams   Vendor Pn,Pdstr$Ams   Vendor Rma,Pdstr$Ams   Vendor Sn,Pdstr$Ams   Viasat Nmr,Pdstr$Ams   Viasat Parent Rma,Pdstr$Ams   Viasat Rtv Rma,Pdstr$Award Classification,Pdstr$Taxable,Pohdr$Agreement Missing Condit,Pohdr$Buyer Id,Pohdr$Competitively Bid,Pohdr$Compliance String,Pohdr$Custom Terms And Conditi,Pohdr$Incoterm Named Place,Pohdr$Po Business Size,Pohdr$Po Class,Pohdr$Po Naics Code,Pohdr$Po Rev Acknowledged,Pohdr$Po Summary,Pohdr$Po Type,Pohdr$Quote Location,Pohdr$Transport Method,Polin$Lead Time For Update,Polin$Life Cycle Status,Polin$Measurement   Test Equip,Polin$Order Line Number,Polin$Order Number,Polin$Other Info,Polin$Qapps String,Polin$Replace Serial Number,Polin$Serial Number,Polin$Supplier Rma,Po Currency Code,Po Header Creation Date,Po Line Creation Date,Po Line Location Id,Po Line Number,Po Line Open Flag,Po Line Type,Po Number,Po Rate,Po Rate Date,Po Rate Type,Po Revision Number,Po Type,Prev Rev Promised Date,Price Override,Project Name,Project Number,Promised Date,Purchase Order Distribution Id,Purchase Order Header Id,Purchase Order Line Id,Purchase Order Release Id,Quantity Billed,Quantity Cancelled,Quantity Delivered,Quantity Ordered,Quantity Shipped,Rate,Rate Date,Receipt Required Flag,Recoverable Tax,Recovery Rate,Release Approved Date,Release Approved Flag,Release Authorization Status,Release Cancel Date,Release Cancel Flag,Release Cancel Reason,Release Closed Code,Release Date,Release Hold Flag,Release Number,Release Revision Number,Release Type,Requisition Approval Date,Requisition Created By,Requisition Creation Date,Requisition Line Number,Requisition Number,Requisition On Line Flag,Reserved,Routing Name,Shipm$Date Receipt Sent To Riv,Shipm$Date Sent To River One,Shipm$Email Notifications Sent,Shipm$Justification,Shipm$Otd Date Format,Shipm$On Time Delivery Date,Shipm$Past Due Status Code,Set Of Books Name,Ship To Location,Ship To Org Code,Ship To Organization,Shipment Cancel Flag,Shipment Number,Shipment Type,Small Business Flag,Source Document Line,Source Document Number,Source Document Type,Sub Category Class Code,Sub Category Description,Supplier Item Po,Supplier Item Req,Supplier Name,Supplier Site Id,Task Name,Task Number,Tax Name,Total Tax')",
				"}",
				"source(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> source1",
				"source(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> source2",
				"source(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> source3",
				"source1 aggregate(groupBy(dummy = sha2(256,byNames(split($Uniquerows,',')))),",
				"     each(match(true()), $$ = first($$))) ~> aggregate1",
				"aggregate1 select(mapColumn(",
				"          {Treasury Account Symbol},",
				"          {Unit Meas Lookup Code},",
				"          {Unit Price},",
				"          {Unit Price Base},",
				"          {Unit Price Base Orig},",
				"          {Unit Price Orig},",
				"          {Vendor Name},",
				"          {Vendor Number},",
				"          {Vendor Site},",
				"          {Wip Entity Id},",
				"          {Acceptance Due Date},",
				"          {Acceptance Required Flag},",
				"          {Account Segment4},",
				"          {Accrue On Receipt Flag},",
				"          {Accrued Flag},",
				"          {Acctacrl$Cv$Accounting Kff},",
				"          {Acctacrl$Code Combination Id},",
				"          {Acctacrl$Qv$Balancing},",
				"          {Acctacrl$Qv$Cost Center},",
				"          {Acctacrl$Qv$Natural Account},",
				"          {Acctacrl$Segment Name List},",
				"          {Acctacrl$Structure Name},",
				"          {Acctbdgt$Cv$Accounting Kff},",
				"          {Acctbdgt$Code Combination Id},",
				"          {Acctbdgt$Qv$Balancing},",
				"          {Acctbdgt$Qv$Cost Center},",
				"          {Acctbdgt$Qv$Natural Account},",
				"          {Acctbdgt$Segment Name List},",
				"          {Acctbdgt$Structure Name},",
				"          {Acctchrg$Cv$Accounting Kff},",
				"          {Acctchrg$Code Combination Id},",
				"          {Acctchrg$Qv$Balancing},",
				"          {Acctchrg$Qv$Cost Center},",
				"          {Acctchrg$Qv$Natural Account},",
				"          {Acctchrg$Segment Name List},",
				"          {Acctchrg$Structure Name},",
				"          {Acctvar$Cv$Accounting Kff},",
				"          {Acctvar$Code Combination Id},",
				"          {Acctvar$Qv$Balancing},",
				"          {Acctvar$Qv$Cost Center},",
				"          {Acctvar$Qv$Natural Account},",
				"          {Acctvar$Segment Name List},",
				"          {Acctvar$Structure Name},",
				"          {Actual Unit Price},",
				"          {Actual Unit Price Base},",
				"          {Agreed Unit Price},",
				"          {Agreed Unit Price Base},",
				"          {Amount Billed},",
				"          {Amount Billed Base},",
				"          {Authorization Status},",
				"          {Award Class Current Contract},",
				"          {Award Class Po},",
				"          {Base Currency Code},",
				"          {Buyer Name},",
				"          {Buyer Number},",
				"          {Cancel Flag},",
				"          {Canceled Amount},",
				"          {Chart Of Accounts Name},",
				"          {Class Code},",
				"          {Closed Code},",
				"          {Closure Status},",
				"          {Code Description},",
				"          {Consigned Flag},",
				"          {Cost Center Segment3},",
				"          {Deliver To Loc Description},",
				"          {Deliver To Location},",
				"          {Deliver To Person},",
				"          {Deliver To Person Number},",
				"          {Delivered Amount},",
				"          {Destination Org Code},",
				"          {Destination Organization},",
				"          {Destination Subinventory},",
				"          {Destination Type Code},",
				"          {Distribution Creation Date},",
				"          {Distribution Id},",
				"          {Distribution Number},",
				"          {Division Segment2},",
				"          {Expenditure Item Date},",
				"          {Expenditure Organization},",
				"          {Expenditure Type},",
				"          {Fob Code},",
				"          {First Po Approval Date},",
				"          {Gl Cancelled Date},",
				"          {Gl Closed Date},",
				"          {Gl Encumbered Date},",
				"          {Government Trasnparency Clause},",
				"          {Hazard Class},",
				"          {Header Id},",
				"          {Item$Inventory Item Id},",
				"          {Item$Organization Id},",
				"          {Item$Sv$Part Number},",
				"          {Itemcat$Cv$Item Category Kff},",
				"          {Itemcat$Category Id},",
				"          {Item Description},",
				"          {Item First Purchase Date},",
				"          {Item Processing Lead Time},",
				"          {Item Revision},",
				"          {Item Type},",
				"          {Job Name},",
				"          {Last Receipt Date},",
				"          {Ledger Name},",
				"          {Legal Entity Segment1},",
				"          {Line Id},",
				"          {Matching Type},",
				"          {Naics Code},",
				"          {Need By Date},",
				"          {Non Recoverable Tax},",
				"          {Note To Vendor},",
				"          {Open Value},",
				"          {Operating Unit Name},",
				"          {Ordered Amount},",
				"          {Orig Rev Promised Date},",
				"          {Pdstr$Ams   Arrived At Vendor},",
				"          {Pdstr$Ams   Hold End},",
				"          {Pdstr$Ams   Hold Start},",
				"          {Pdstr$Ams   In Warranty},",
				"          {Pdstr$Ams   Vendor Pn},",
				"          {Pdstr$Ams   Vendor Rma},",
				"          {Pdstr$Ams   Vendor Sn},",
				"          {Pdstr$Ams   Viasat Nmr},",
				"          {Pdstr$Ams   Viasat Parent Rma},",
				"          {Pdstr$Ams   Viasat Rtv Rma},",
				"          {Pdstr$Award Classification},",
				"          {Pdstr$Taxable},",
				"          {Pohdr$Agreement Missing Condit},",
				"          {Pohdr$Buyer Id},",
				"          {Pohdr$Competitively Bid},",
				"          {Pohdr$Compliance String},",
				"          {Pohdr$Custom Terms And Conditi},",
				"          {Pohdr$Incoterm Named Place},",
				"          {Pohdr$Po Business Size},",
				"          {Pohdr$Po Class},",
				"          {Pohdr$Po Naics Code},",
				"          {Pohdr$Po Rev Acknowledged},",
				"          {Pohdr$Po Summary},",
				"          {Pohdr$Po Type},",
				"          {Pohdr$Quote Location},",
				"          {Pohdr$Transport Method},",
				"          {Polin$Lead Time For Update},",
				"          {Polin$Life Cycle Status},",
				"          {Polin$Measurement   Test Equip},",
				"          {Polin$Order Line Number},",
				"          {Polin$Order Number},",
				"          {Polin$Other Info},",
				"          {Polin$Qapps String},",
				"          {Polin$Replace Serial Number},",
				"          {Polin$Serial Number},",
				"          {Polin$Supplier Rma},",
				"          {Po Currency Code},",
				"          {Po Header Creation Date},",
				"          {Po Line Creation Date},",
				"          {Po Line Location Id},",
				"          {Po Line Number},",
				"          {Po Line Open Flag},",
				"          {Po Line Type},",
				"          {Po Number},",
				"          {Po Rate},",
				"          {Po Rate Date},",
				"          {Po Rate Type},",
				"          {Po Revision Number},",
				"          {Po Type},",
				"          {Prev Rev Promised Date},",
				"          {Price Override},",
				"          {Project Name},",
				"          {Project Number},",
				"          {Promised Date},",
				"          {Purchase Order Distribution Id},",
				"          {Purchase Order Header Id},",
				"          {Purchase Order Line Id},",
				"          {Purchase Order Release Id},",
				"          {Quantity Billed},",
				"          {Quantity Cancelled},",
				"          {Quantity Delivered},",
				"          {Quantity Ordered},",
				"          {Quantity Shipped},",
				"          Rate,",
				"          {Rate Date},",
				"          {Receipt Required Flag},",
				"          {Recoverable Tax},",
				"          {Recovery Rate},",
				"          {Release Approved Date},",
				"          {Release Approved Flag},",
				"          {Release Authorization Status},",
				"          {Release Cancel Date},",
				"          {Release Cancel Flag},",
				"          {Release Cancel Reason},",
				"          {Release Closed Code},",
				"          {Release Date},",
				"          {Release Hold Flag},",
				"          {Release Number},",
				"          {Release Revision Number},",
				"          {Release Type},",
				"          {Requestor Name},",
				"          {Requisition Approval Date},",
				"          {Requisition Created By},",
				"          {Requisition Creation Date},",
				"          {Requisition Description},",
				"          {Requisition Line Number},",
				"          {Requisition Number},",
				"          {Requisition On Line Flag},",
				"          Reserved,",
				"          {Routing Name},",
				"          {Shipm$Date Receipt Sent To Riv},",
				"          {Shipm$Date Sent To River One},",
				"          {Shipm$Email Notifications Sent},",
				"          {Shipm$Justification},",
				"          {Shipm$Mrp Pull In Message Root},",
				"          {Shipm$Otd Date Format},",
				"          {Shipm$On Time Delivery Date},",
				"          {Shipm$Past Due Status Code},",
				"          {Set Of Books Name},",
				"          {Ship To Location},",
				"          {Ship To Org Code},",
				"          {Ship To Organization},",
				"          {Shipment Cancel Flag},",
				"          {Shipment Number},",
				"          {Shipment Type},",
				"          {Small Business Flag},",
				"          {Source Document Line},",
				"          {Source Document Number},",
				"          {Source Document Type},",
				"          {Sub Category Class Code},",
				"          {Sub Category Description},",
				"          {Supplier Item Po},",
				"          {Supplier Item Req},",
				"          {Supplier Name},",
				"          {Supplier Site Id},",
				"          {Task Name},",
				"          {Task Number},",
				"          {Tax Name},",
				"          {Total Tax},",
				"          {Repo Load Dttm}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select1",
				"select1 filter({Destination Org Code} == '75' && {Promised Date} >= addDays(currentDate(), -(dayOfMonth(currentDate()))+1) &&\r",
				"{Promised Date} <= addMonths(addDays(currentDate(), -(dayOfMonth(currentDate()))+1), 24)) ~> filter1",
				"filter1, select2 join({Item$Sv$Part Number} == Item,",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join1",
				"source3 aggregate(groupBy(PN),",
				"     each(match(name!='PN'), $$ = first($$))) ~> aggregate2",
				"aggregate2 select(mapColumn(",
				"          Item = PN,",
				"          Program,",
				"          {Qty Per}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select2",
				"join1 select(mapColumn(",
				"          {Treasury Account Symbol},",
				"          {Unit Meas Lookup Code},",
				"          {Unit Price},",
				"          {Unit Price Base},",
				"          {Unit Price Base Orig},",
				"          {Unit Price Orig},",
				"          {Source Vendor Name} = {Vendor Name},",
				"          {Vendor Number},",
				"          {Vendor Site},",
				"          {Wip Entity Id},",
				"          {Acceptance Due Date},",
				"          {Acceptance Required Flag},",
				"          {Account Segment4},",
				"          {Accrue On Receipt Flag},",
				"          {Accrued Flag},",
				"          {Acctacrl$Cv$Accounting Kff},",
				"          {Acctacrl$Code Combination Id},",
				"          {Acctacrl$Qv$Balancing},",
				"          {Acctacrl$Qv$Cost Center},",
				"          {Acctacrl$Qv$Natural Account},",
				"          {Acctacrl$Segment Name List},",
				"          {Acctacrl$Structure Name},",
				"          {Acctbdgt$Cv$Accounting Kff},",
				"          {Acctbdgt$Code Combination Id},",
				"          {Acctbdgt$Qv$Balancing},",
				"          {Acctbdgt$Qv$Cost Center},",
				"          {Acctbdgt$Qv$Natural Account},",
				"          {Acctbdgt$Segment Name List},",
				"          {Acctbdgt$Structure Name},",
				"          {Acctchrg$Cv$Accounting Kff},",
				"          {Acctchrg$Code Combination Id},",
				"          {Acctchrg$Qv$Balancing},",
				"          {Acctchrg$Qv$Cost Center},",
				"          {Acctchrg$Qv$Natural Account},",
				"          {Acctchrg$Segment Name List},",
				"          {Acctchrg$Structure Name},",
				"          {Acctvar$Cv$Accounting Kff},",
				"          {Acctvar$Code Combination Id},",
				"          {Acctvar$Qv$Balancing},",
				"          {Acctvar$Qv$Cost Center},",
				"          {Acctvar$Qv$Natural Account},",
				"          {Acctvar$Segment Name List},",
				"          {Acctvar$Structure Name},",
				"          {Actual Unit Price},",
				"          {Actual Unit Price Base},",
				"          {Agreed Unit Price},",
				"          {Agreed Unit Price Base},",
				"          {Amount Billed},",
				"          {Amount Billed Base},",
				"          {Authorization Status},",
				"          {Award Class Current Contract},",
				"          {Award Class Po},",
				"          {Base Currency Code},",
				"          {Buyer Name},",
				"          {Buyer Number},",
				"          {Cancel Flag},",
				"          {Canceled Amount},",
				"          {Chart Of Accounts Name},",
				"          {Class Code},",
				"          {Closed Code},",
				"          {Closure Status},",
				"          {Code Description},",
				"          {Consigned Flag},",
				"          {Cost Center Segment3},",
				"          {Deliver To Loc Description},",
				"          {Deliver To Location},",
				"          {Deliver To Person},",
				"          {Deliver To Person Number},",
				"          {Delivered Amount},",
				"          {Destination Org Code},",
				"          {Destination Organization},",
				"          {Destination Subinventory},",
				"          {Destination Type Code},",
				"          {Distribution Creation Date},",
				"          {Distribution Id},",
				"          {Distribution Number},",
				"          {Division Segment2},",
				"          {Expenditure Item Date},",
				"          {Expenditure Organization},",
				"          {Expenditure Type},",
				"          {Fob Code},",
				"          {First Po Approval Date},",
				"          {Gl Cancelled Date},",
				"          {Gl Closed Date},",
				"          {Gl Encumbered Date},",
				"          {Government Trasnparency Clause},",
				"          {Hazard Class},",
				"          {Header Id},",
				"          {Item$Inventory Item Id},",
				"          {Item$Organization Id},",
				"          {Item Number} = {Item$Sv$Part Number},",
				"          {Itemcat$Cv$Item Category Kff},",
				"          {Itemcat$Category Id},",
				"          {Item Description},",
				"          {Item First Purchase Date},",
				"          {Item Processing Lead Time},",
				"          {Item Revision},",
				"          {Item Type},",
				"          {Job Name},",
				"          {Last Receipt Date},",
				"          {Ledger Name},",
				"          {Legal Entity Segment1},",
				"          {Line Id},",
				"          {Matching Type},",
				"          {Naics Code},",
				"          {Need By Date},",
				"          {Non Recoverable Tax},",
				"          {Note To Vendor},",
				"          {Open Value},",
				"          {Operating Unit Name},",
				"          {Ordered Amount},",
				"          {Orig Rev Promised Date},",
				"          {Pdstr$Ams   Arrived At Vendor},",
				"          {Pdstr$Ams   Hold End},",
				"          {Pdstr$Ams   Hold Start},",
				"          {Pdstr$Ams   In Warranty},",
				"          {Pdstr$Ams   Vendor Pn},",
				"          {Pdstr$Ams   Vendor Rma},",
				"          {Pdstr$Ams   Vendor Sn},",
				"          {Pdstr$Ams   Viasat Nmr},",
				"          {Pdstr$Ams   Viasat Parent Rma},",
				"          {Pdstr$Ams   Viasat Rtv Rma},",
				"          {Pdstr$Award Classification},",
				"          {Pdstr$Taxable},",
				"          {Pohdr$Agreement Missing Condit},",
				"          {Pohdr$Buyer Id},",
				"          {Pohdr$Competitively Bid},",
				"          {Pohdr$Compliance String},",
				"          {Pohdr$Custom Terms And Conditi},",
				"          {Pohdr$Incoterm Named Place},",
				"          {Pohdr$Po Business Size},",
				"          {Pohdr$Po Class},",
				"          {Pohdr$Po Naics Code},",
				"          {Pohdr$Po Rev Acknowledged},",
				"          {Pohdr$Po Summary},",
				"          {Pohdr$Po Type},",
				"          {Pohdr$Quote Location},",
				"          {Pohdr$Transport Method},",
				"          {Polin$Lead Time For Update},",
				"          {Polin$Life Cycle Status},",
				"          {Polin$Measurement   Test Equip},",
				"          {Polin$Order Line Number},",
				"          {Polin$Order Number},",
				"          {Polin$Other Info},",
				"          {Polin$Qapps String},",
				"          {Polin$Replace Serial Number},",
				"          {Polin$Serial Number},",
				"          {Polin$Supplier Rma},",
				"          {Po Currency Code},",
				"          {Po Header Creation Date},",
				"          {Po Line Creation Date},",
				"          {Po Line Location Id},",
				"          {Po Line Number},",
				"          {Po Line Open Flag},",
				"          {Po Line Type},",
				"          {Po Number},",
				"          {Po Rate},",
				"          {Po Rate Date},",
				"          {Po Rate Type},",
				"          {Po Revision Number},",
				"          {Po Type},",
				"          {Prev Rev Promised Date},",
				"          {Price Override},",
				"          {Project Name},",
				"          {Project Number},",
				"          {Old Dock Date} = {Promised Date},",
				"          {Purchase Order Distribution Id},",
				"          {Purchase Order Header Id},",
				"          {Purchase Order Line Id},",
				"          {Purchase Order Release Id},",
				"          {Quantity Billed},",
				"          {Quantity Cancelled},",
				"          {Quantity Delivered},",
				"          {Quantity Ordered},",
				"          {Quantity Shipped},",
				"          Rate,",
				"          {Rate Date},",
				"          {Receipt Required Flag},",
				"          {Recoverable Tax},",
				"          {Recovery Rate},",
				"          {Release Approved Date},",
				"          {Release Approved Flag},",
				"          {Release Authorization Status},",
				"          {Release Cancel Date},",
				"          {Release Cancel Flag},",
				"          {Release Cancel Reason},",
				"          {Release Closed Code},",
				"          {Release Date},",
				"          {Release Hold Flag},",
				"          {Release Number},",
				"          {Release Revision Number},",
				"          {Release Type},",
				"          {Requestor Name},",
				"          {Requisition Approval Date},",
				"          {Requisition Created By},",
				"          {Requisition Creation Date},",
				"          {Requisition Description},",
				"          {Requisition Line Number},",
				"          {Requisition Number},",
				"          {Requisition On Line Flag},",
				"          Reserved,",
				"          {Routing Name},",
				"          {Shipm$Date Receipt Sent To Riv},",
				"          {Shipm$Date Sent To River One},",
				"          {Shipm$Email Notifications Sent},",
				"          {Shipm$Justification},",
				"          {Shipm$Mrp Pull In Message Root},",
				"          {Shipm$Otd Date Format},",
				"          {Shipm$On Time Delivery Date},",
				"          {Shipm$Past Due Status Code},",
				"          {Set Of Books Name},",
				"          {Ship To Location},",
				"          {Ship To Org Code},",
				"          {Ship To Organization},",
				"          {Shipment Cancel Flag},",
				"          {Shipment Number},",
				"          {Shipment Type},",
				"          {Small Business Flag},",
				"          {Source Document Line},",
				"          {Source Document Number},",
				"          {Source Document Type},",
				"          {Sub Category Class Code},",
				"          {Sub Category Description},",
				"          {Supplier Item Po},",
				"          {Supplier Item Req},",
				"          {Supplier Name},",
				"          {Supplier Site Id},",
				"          {Task Name},",
				"          {Task Number},",
				"          {Tax Name},",
				"          {Total Tax},",
				"          {Repo Load Dttm},",
				"          Item,",
				"          Program,",
				"          {Qty Per}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select3",
				"select3 derive(Date = {Old Dock Date},",
				"          {Quantity Rate} = toInteger({Quantity Ordered}) - toInteger({Quantity Cancelled}) - toInteger({Quantity Delivered} )) ~> derivedColumn4",
				"derivedColumn4 select(mapColumn(",
				"          {Treasury Account Symbol},",
				"          {Unit Meas Lookup Code},",
				"          {Unit Price},",
				"          {Unit Price Base},",
				"          {Unit Price Base Orig},",
				"          {Unit Price Orig},",
				"          {Source Vendor Name},",
				"          {Vendor Number},",
				"          {Vendor Site},",
				"          {Wip Entity Id},",
				"          {Acceptance Due Date},",
				"          {Acceptance Required Flag},",
				"          {Account Segment4},",
				"          {Accrue On Receipt Flag},",
				"          {Accrued Flag},",
				"          {Acctacrl$Cv$Accounting Kff},",
				"          {Acctacrl$Code Combination Id},",
				"          {Acctacrl$Qv$Balancing},",
				"          {Acctacrl$Qv$Cost Center},",
				"          {Acctacrl$Qv$Natural Account},",
				"          {Acctacrl$Segment Name List},",
				"          {Acctacrl$Structure Name},",
				"          {Acctbdgt$Cv$Accounting Kff},",
				"          {Acctbdgt$Code Combination Id},",
				"          {Acctbdgt$Qv$Balancing},",
				"          {Acctbdgt$Qv$Cost Center},",
				"          {Acctbdgt$Qv$Natural Account},",
				"          {Acctbdgt$Segment Name List},",
				"          {Acctbdgt$Structure Name},",
				"          {Acctchrg$Cv$Accounting Kff},",
				"          {Acctchrg$Code Combination Id},",
				"          {Acctchrg$Qv$Balancing},",
				"          {Acctchrg$Qv$Cost Center},",
				"          {Acctchrg$Qv$Natural Account},",
				"          {Acctchrg$Segment Name List},",
				"          {Acctchrg$Structure Name},",
				"          {Acctvar$Cv$Accounting Kff},",
				"          {Acctvar$Code Combination Id},",
				"          {Acctvar$Qv$Balancing},",
				"          {Acctvar$Qv$Cost Center},",
				"          {Acctvar$Qv$Natural Account},",
				"          {Acctvar$Segment Name List},",
				"          {Acctvar$Structure Name},",
				"          {Actual Unit Price},",
				"          {Actual Unit Price Base},",
				"          {Agreed Unit Price},",
				"          {Agreed Unit Price Base},",
				"          {Amount Billed},",
				"          {Amount Billed Base},",
				"          {Authorization Status},",
				"          {Award Class Current Contract},",
				"          {Award Class Po},",
				"          {Base Currency Code},",
				"          {Buyer Name},",
				"          {Buyer Number},",
				"          {Cancel Flag},",
				"          {Canceled Amount},",
				"          {Chart Of Accounts Name},",
				"          {Class Code},",
				"          {Closed Code},",
				"          {Closure Status},",
				"          {Code Description},",
				"          {Consigned Flag},",
				"          {Cost Center Segment3},",
				"          {Deliver To Loc Description},",
				"          {Deliver To Location},",
				"          {Deliver To Person},",
				"          {Deliver To Person Number},",
				"          {Delivered Amount},",
				"          {Destination Org Code},",
				"          {Destination Organization},",
				"          {Destination Subinventory},",
				"          {Destination Type Code},",
				"          {Distribution Creation Date},",
				"          {Distribution Id},",
				"          {Distribution Number},",
				"          {Division Segment2},",
				"          {Expenditure Item Date},",
				"          {Expenditure Organization},",
				"          {Expenditure Type},",
				"          {Fob Code},",
				"          {First Po Approval Date},",
				"          {Gl Cancelled Date},",
				"          {Gl Closed Date},",
				"          {Gl Encumbered Date},",
				"          {Government Trasnparency Clause},",
				"          {Hazard Class},",
				"          {Header Id},",
				"          {Item$Inventory Item Id},",
				"          {Item$Organization Id},",
				"          {Item Number},",
				"          {Itemcat$Cv$Item Category Kff},",
				"          {Itemcat$Category Id},",
				"          {Item Description},",
				"          {Item First Purchase Date},",
				"          {Item Processing Lead Time},",
				"          {Item Revision},",
				"          {Item Type},",
				"          {Job Name},",
				"          {Last Receipt Date},",
				"          {Ledger Name},",
				"          {Legal Entity Segment1},",
				"          {Line Id},",
				"          {Matching Type},",
				"          {Naics Code},",
				"          {Need By Date},",
				"          {Non Recoverable Tax},",
				"          {Note To Vendor},",
				"          {Open Value},",
				"          {Operating Unit Name},",
				"          {Ordered Amount},",
				"          {Orig Rev Promised Date},",
				"          {Pdstr$Ams   Arrived At Vendor},",
				"          {Pdstr$Ams   Hold End},",
				"          {Pdstr$Ams   Hold Start},",
				"          {Pdstr$Ams   In Warranty},",
				"          {Pdstr$Ams   Vendor Pn},",
				"          {Pdstr$Ams   Vendor Rma},",
				"          {Pdstr$Ams   Vendor Sn},",
				"          {Pdstr$Ams   Viasat Nmr},",
				"          {Pdstr$Ams   Viasat Parent Rma},",
				"          {Pdstr$Ams   Viasat Rtv Rma},",
				"          {Pdstr$Award Classification},",
				"          {Pdstr$Taxable},",
				"          {Pohdr$Agreement Missing Condit},",
				"          {Pohdr$Buyer Id},",
				"          {Pohdr$Competitively Bid},",
				"          {Pohdr$Compliance String},",
				"          {Pohdr$Custom Terms And Conditi},",
				"          {Pohdr$Incoterm Named Place},",
				"          {Pohdr$Po Business Size},",
				"          {Pohdr$Po Class},",
				"          {Pohdr$Po Naics Code},",
				"          {Pohdr$Po Rev Acknowledged},",
				"          {Pohdr$Po Summary},",
				"          {Pohdr$Po Type},",
				"          {Pohdr$Quote Location},",
				"          {Pohdr$Transport Method},",
				"          {Polin$Lead Time For Update},",
				"          {Polin$Life Cycle Status},",
				"          {Polin$Measurement   Test Equip},",
				"          {Polin$Order Line Number},",
				"          {Polin$Order Number},",
				"          {Polin$Other Info},",
				"          {Polin$Qapps String},",
				"          {Polin$Replace Serial Number},",
				"          {Polin$Serial Number},",
				"          {Polin$Supplier Rma},",
				"          {Po Currency Code},",
				"          {Po Header Creation Date},",
				"          {Po Line Creation Date},",
				"          {Po Line Location Id},",
				"          {Po Line Number},",
				"          {Po Line Open Flag},",
				"          {Po Line Type},",
				"          {Po Number},",
				"          {Po Rate},",
				"          {Po Rate Date},",
				"          {Po Rate Type},",
				"          {Po Revision Number},",
				"          {Po Type},",
				"          {Prev Rev Promised Date},",
				"          {Price Override},",
				"          {Project Name},",
				"          {Project Number},",
				"          {Old Dock Date},",
				"          {Purchase Order Distribution Id},",
				"          {Purchase Order Header Id},",
				"          {Purchase Order Line Id},",
				"          {Purchase Order Release Id},",
				"          {Quantity Billed},",
				"          {Quantity Cancelled},",
				"          {Quantity Delivered},",
				"          {Quantity Ordered},",
				"          {Quantity Shipped},",
				"          Rate,",
				"          {Rate Date},",
				"          {Receipt Required Flag},",
				"          {Recoverable Tax},",
				"          {Recovery Rate},",
				"          {Release Approved Date},",
				"          {Release Approved Flag},",
				"          {Release Authorization Status},",
				"          {Release Cancel Date},",
				"          {Release Cancel Flag},",
				"          {Release Cancel Reason},",
				"          {Release Closed Code},",
				"          {Release Date},",
				"          {Release Hold Flag},",
				"          {Release Number},",
				"          {Release Revision Number},",
				"          {Release Type},",
				"          {Requestor Name},",
				"          {Requisition Approval Date},",
				"          {Requisition Created By},",
				"          {Requisition Creation Date},",
				"          {Requisition Description},",
				"          {Requisition Line Number},",
				"          {Requisition Number},",
				"          {Requisition On Line Flag},",
				"          Reserved,",
				"          {Routing Name},",
				"          {Shipm$Date Receipt Sent To Riv},",
				"          {Shipm$Date Sent To River One},",
				"          {Shipm$Email Notifications Sent},",
				"          {Shipm$Justification},",
				"          {Shipm$Mrp Pull In Message Root},",
				"          {Shipm$Otd Date Format},",
				"          {Shipm$On Time Delivery Date},",
				"          {Shipm$Past Due Status Code},",
				"          {Set Of Books Name},",
				"          {Ship To Location},",
				"          {Ship To Org Code},",
				"          {Ship To Organization},",
				"          {Shipment Cancel Flag},",
				"          {Shipment Number},",
				"          {Shipment Type},",
				"          {Small Business Flag},",
				"          {Source Document Line},",
				"          {Source Document Number},",
				"          {Source Document Type},",
				"          {Sub Category Class Code},",
				"          {Sub Category Description},",
				"          {Supplier Item Po},",
				"          {Supplier Item Req},",
				"          {Supplier Name},",
				"          {Supplier Site Id},",
				"          {Task Name},",
				"          {Task Number},",
				"          {Tax Name},",
				"          {Total Tax},",
				"          {Repo Load Dttm},",
				"          Item,",
				"          Program,",
				"          {Qty Per},",
				"          Date,",
				"          {Quantity Rate}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select4",
				"select4 aggregate(groupBy({Item Number},",
				"          {Item Description},",
				"          Date),",
				"     {Sum_Quantity Rate} = sum(toInteger({Quantity Rate}))) ~> aggregate3",
				"select4 aggregate(groupBy({Item Number},",
				"          {Item Description},",
				"          {Source Vendor Name},",
				"          Date),",
				"     {Sum_Quantity Rate} = sum(toInteger({Quantity Rate}))) ~> aggregate4",
				"select4 aggregate(groupBy({Item Number}),",
				"     {CountDistinct_Source Vendor Name} = countDistinct({Source Vendor Name})) ~> aggregate5",
				"aggregate3 select(mapColumn(",
				"          {Item Number},",
				"          {Item Description},",
				"          Date,",
				"          {Sum_Quantity Rate}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select5",
				"select5 aggregate(groupBy({Item Number},",
				"          {Item Description}),",
				"     Total = sum({Sum_Quantity Rate})) ~> aggregate6",
				"select5 derive(Date = addDays(Date, -(dayOfMonth(currentDate()))+1)) ~> derivedColumn6",
				"derivedColumn6 select(mapColumn(",
				"          {Item Number},",
				"          {Item Description},",
				"          Date,",
				"          {Qty Due} = {Sum_Quantity Rate}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select6",
				"select6 aggregate(groupBy({Item Number},",
				"          {Item Description},",
				"          Date),",
				"     {Sum_Qty Due} = sum({Qty Due})) ~> aggregate7",
				"aggregate7 pivot(groupBy({Item Number},",
				"          {Item Description}),",
				"     pivotBy(Date),",
				"     {} = first({Sum_Qty Due}),",
				"     columnNaming: '$N$V',",
				"     lateral: true) ~> pivot1",
				"pivot1, aggregate6 join(pivot1@{Item Number} == aggregate6@{Item Number}",
				"     && pivot1@{Item Description} == aggregate6@{Item Description},",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join2",
				"join2 derive(Type = \"Total PO Qty Ordered\",",
				"          Order = 2) ~> derivedColumn7",
				"aggregate4 select(mapColumn(",
				"          {Item Number},",
				"          {Item Description},",
				"          {Source Vendor Name},",
				"          Date,",
				"          {Sum_Quantity Rate}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select7",
				"select7 aggregate(groupBy({Item Number},",
				"          {Item Description},",
				"          {Source Vendor Name}),",
				"     Total = sum({Sum_Quantity Rate})) ~> aggregate8",
				"select7 derive(Date = addDays(Date, -(dayOfMonth(currentDate()))+1)) ~> derivedColumn8",
				"derivedColumn8 select(mapColumn(",
				"          {Item Number},",
				"          {Item Description},",
				"          {Source Vendor Name},",
				"          Date,",
				"          {Qty Due} = {Sum_Quantity Rate}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select8",
				"select8 aggregate(groupBy({Item Number},",
				"          {Item Description},",
				"          {Source Vendor Name},",
				"          Date),",
				"     {Sum_Qty Due} = sum({Qty Due})) ~> aggregate9",
				"aggregate9 pivot(groupBy({Item Number},",
				"          {Item Description},",
				"          {Source Vendor Name}),",
				"     pivotBy(Date),",
				"     {} = first({Sum_Qty Due}),",
				"     columnNaming: '$N$V',",
				"     lateral: true) ~> pivot2",
				"pivot2, aggregate8 join(pivot2@{Item Number} == aggregate8@{Item Number}",
				"     && pivot2@{Item Description} == aggregate8@{Item Description}",
				"     && pivot2@{Source Vendor Name} == aggregate8@{Source Vendor Name},",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join3",
				"join3, filter2 join(pivot2@{Item Number} == aggregate5@{Item Number},",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join4",
				"aggregate5 filter({CountDistinct_Source Vendor Name} > 1) ~> filter2",
				"join4 derive(Type = concat(pivot2@{Source Vendor Name}, \" Qty Ordered\"),",
				"          Order = 1) ~> derivedColumn9",
				"source2 select(mapColumn(",
				"          {Implement Date},",
				"          {Implement As Text},",
				"          {Full Pegging},",
				"          {First Unit Start Date},",
				"          {Firm Planned Type},",
				"          {Days From Today},",
				"          {Compression Days},",
				"          {Component Revision},",
				"          {Cfm Routing Flag},",
				"          {Buyer Name},",
				"          {Build Sequence},",
				"          {Build In Wip Flag},",
				"          {Bom Item Type},",
				"          {Avg Item Cost},",
				"          Applied,",
				"          {Alternate Routing Designator},",
				"          {Alternate Bom Designator},",
				"          {Unit Number},",
				"          {Transaction Id},",
				"          {Task Num},",
				"          {Supply Avail Date},",
				"          {Suggested Req Buyer},",
				"          {Suggested Buyer Name},",
				"          {Sugg Start Date},",
				"          {Sugg Order Date},",
				"          {Sugg Due Date},",
				"          {Sugg Dock Date},",
				"          {Status Code},",
				"          Status,",
				"          {Source Vendor Site Code},",
				"          {Source Vendor Name},",
				"          {Source Table},",
				"          {Source Schedule},",
				"          {Source Organization Code},",
				"          {Snapshot Total Onhand Qty},",
				"          {Schedule Group},",
				"          {Rescheduled Flag},",
				"          {Repetitive Type},",
				"          {Release Time Fence Code},",
				"          {Release Errors},",
				"          {Quantity Rate},",
				"          {Quantity In Process},",
				"          {Project Num},",
				"          {Process Days},",
				"          {Po Price},",
				"          {Planning Group Quantity},",
				"          {Planning Group},",
				"          {Planner Code},",
				"          {Organization Id},",
				"          {Organization Code},",
				"          {Order Type},",
				"          {Order Number},",
				"          {Old Order Quantity},",
				"          {Old Due Date},",
				"          {Old Dock Date},",
				"          {New Quantity},",
				"          {New Date},",
				"          {Mrp Action},",
				"          {Make Buy Code},",
				"          {List Price},",
				"          {Line Code},",
				"          {Last Unit Start Date},",
				"          {Last Unit Completion Date},",
				"          {Item Status Code},",
				"          {Item Purchasable Flag},",
				"          {Item Planning Cat Code},",
				"          {Item Number},",
				"          {Item Mrp Plan Method},",
				"          {Item Description},",
				"          {Inventory Item Id},",
				"          {In Source Plan},",
				"          {Implemented Quantity},",
				"          {Implement Quantity Rate},",
				"          {Implement Employee Id},",
				"          {Wip Supply Type},",
				"          {Using Assembly Item Num},",
				"          {Repo Load Dttm}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select9",
				"select9 filter({Organization Code} == \"75\"\r",
				"&&\r",
				"({Mrp Action} == \"Release\" || {Order Type} == \"Purchase requisition\")) ~> filter3",
				"select9 filter({Organization Code} == '75' && \r",
				"({Mrp Action} == \"Release\" || {Order Type} == \"Purchase requisition\")) ~> filter4",
				"filter4, select2 join({Item Number} == Item,",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join5",
				"filter3, select2 join({Item Number} == Item,",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join6",
				"join5 select(mapColumn(",
				"          each(match(/* All input columns */true()),",
				"               /* Input name */$$ = $$)",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select10",
				"join6 select(mapColumn(",
				"          {Implement Date},",
				"          {Implement As Text},",
				"          {Full Pegging},",
				"          {First Unit Start Date},",
				"          {Firm Planned Type},",
				"          {Days From Today},",
				"          {Compression Days},",
				"          {Component Revision},",
				"          {Cfm Routing Flag},",
				"          {Buyer Name},",
				"          {Build Sequence},",
				"          {Build In Wip Flag},",
				"          {Bom Item Type},",
				"          {Avg Item Cost},",
				"          Applied,",
				"          {Alternate Routing Designator},",
				"          {Alternate Bom Designator},",
				"          {Unit Number},",
				"          {Transaction Id},",
				"          {Task Num},",
				"          {Supply Avail Date},",
				"          {Suggested Req Buyer},",
				"          {Suggested Buyer Name},",
				"          {Sugg Start Date},",
				"          {Sugg Order Date},",
				"          {Sugg Due Date},",
				"          {Sugg Dock Date},",
				"          {Status Code},",
				"          Status,",
				"          {Source Vendor Site Code},",
				"          {Source Vendor Name},",
				"          {Source Table},",
				"          {Source Schedule},",
				"          {Source Organization Code},",
				"          {Snapshot Total Onhand Qty},",
				"          {Schedule Group},",
				"          {Rescheduled Flag},",
				"          {Repetitive Type},",
				"          {Release Time Fence Code},",
				"          {Release Errors},",
				"          {Quantity Rate},",
				"          {Quantity In Process},",
				"          {Project Num},",
				"          {Process Days},",
				"          {Po Price},",
				"          {Planning Group Quantity},",
				"          {Planning Group},",
				"          {Planner Code},",
				"          {Organization Id},",
				"          {Organization Code},",
				"          {Order Type},",
				"          {Order Number},",
				"          {Old Order Quantity},",
				"          {Old Due Date},",
				"          {Old Dock Date},",
				"          {New Quantity},",
				"          {New Date},",
				"          {Mrp Action},",
				"          {Make Buy Code},",
				"          {List Price},",
				"          {Line Code},",
				"          {Last Unit Start Date},",
				"          {Last Unit Completion Date},",
				"          {Item Status Code},",
				"          {Item Purchasable Flag},",
				"          {Item Planning Cat Code},",
				"          {Item Number},",
				"          {Item Mrp Plan Method},",
				"          {Item Description},",
				"          {Inventory Item Id},",
				"          {In Source Plan},",
				"          {Implemented Quantity},",
				"          {Implement Quantity Rate},",
				"          {Implement Employee Id},",
				"          {Wip Supply Type},",
				"          {Using Assembly Item Num},",
				"          {Repo Load Dttm},",
				"          Item,",
				"          Program,",
				"          {Qty Per}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select11",
				"select10 derive(Date = iif( {Order Type}== \"Planned order\",{Sugg Dock Date},{Old Dock Date})) ~> derivedColumn10",
				"select11 derive(date = iif( {Order Type}== \"Planned order\",{Sugg Dock Date},{Old Dock Date})) ~> derivedColumn11",
				"derivedColumn10 filter(Date >= addDays(currentDate(), -(dayOfMonth(currentDate()))+1) &&\r",
				"Date <= addMonths(addDays(currentDate(), -(dayOfMonth(currentDate()))+1), 24)) ~> filter5",
				"derivedColumn11 filter(date >= addDays(currentDate(), -(dayOfMonth(currentDate()))+1) &&\r",
				"date <= addMonths(addDays(currentDate(), -(dayOfMonth(currentDate()))+1), 24)) ~> filter6",
				"filter5 select(mapColumn(",
				"          each(match(/* All input columns */true()),",
				"               /* Input name */$$ = $$)",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select12",
				"filter6 select(mapColumn(",
				"          {Implement Date},",
				"          {Implement As Text},",
				"          {Full Pegging},",
				"          {First Unit Start Date},",
				"          {Firm Planned Type},",
				"          {Days From Today},",
				"          {Compression Days},",
				"          {Component Revision},",
				"          {Cfm Routing Flag},",
				"          {Buyer Name},",
				"          {Build Sequence},",
				"          {Build In Wip Flag},",
				"          {Bom Item Type},",
				"          {Avg Item Cost},",
				"          Applied,",
				"          {Alternate Routing Designator},",
				"          {Alternate Bom Designator},",
				"          {Unit Number},",
				"          {Transaction Id},",
				"          {Task Num},",
				"          {Supply Avail Date},",
				"          {Suggested Req Buyer},",
				"          {Suggested Buyer Name},",
				"          {Sugg Start Date},",
				"          {Sugg Order Date},",
				"          {Sugg Due Date},",
				"          {Sugg Dock Date},",
				"          {Status Code},",
				"          Status,",
				"          {Source Vendor Site Code},",
				"          {Source Vendor Name},",
				"          {Source Table},",
				"          {Source Schedule},",
				"          {Source Organization Code},",
				"          {Snapshot Total Onhand Qty},",
				"          {Schedule Group},",
				"          {Rescheduled Flag},",
				"          {Repetitive Type},",
				"          {Release Time Fence Code},",
				"          {Release Errors},",
				"          {Quantity Rate},",
				"          {Quantity In Process},",
				"          {Project Num},",
				"          {Process Days},",
				"          {Po Price},",
				"          {Planning Group Quantity},",
				"          {Planning Group},",
				"          {Planner Code},",
				"          {Organization Id},",
				"          {Organization Code},",
				"          {Order Type},",
				"          {Order Number},",
				"          {Old Order Quantity},",
				"          {Old Due Date},",
				"          {Old Dock Date},",
				"          {New Quantity},",
				"          {New Date},",
				"          {Mrp Action},",
				"          {Make Buy Code},",
				"          {List Price},",
				"          {Line Code},",
				"          {Last Unit Start Date},",
				"          {Last Unit Completion Date},",
				"          {Item Status Code},",
				"          {Item Purchasable Flag},",
				"          {Item Planning Cat Code},",
				"          {Item Number},",
				"          {Item Mrp Plan Method},",
				"          {Item Description},",
				"          {Inventory Item Id},",
				"          {In Source Plan},",
				"          {Implemented Quantity},",
				"          {Implement Quantity Rate},",
				"          {Implement Employee Id},",
				"          {Wip Supply Type},",
				"          {Using Assembly Item Num},",
				"          {Repo Load Dttm},",
				"          Item,",
				"          Program,",
				"          {Qty Per},",
				"          date",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select13",
				"select12 aggregate(groupBy({Item Number},",
				"          {Item Description},",
				"          Date),",
				"     {Sum_Quantity Rate} = sum(toInteger({Quantity Rate}))) ~> aggregate10",
				"select13, select4 union(byName: true)~> union2",
				"aggregate10 select(mapColumn(",
				"          {Item Number},",
				"          {Item Description},",
				"          Date,",
				"          {Sum_Quantity Rate}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select14",
				"select14 aggregate(groupBy({Item Number},",
				"          {Item Description}),",
				"     Total = sum({Sum_Quantity Rate})) ~> aggregate11",
				"select14 derive(Date = addDays(Date, -(dayOfMonth(currentDate()))+1)) ~> derivedColumn12",
				"derivedColumn12 select(mapColumn(",
				"          {Item Number},",
				"          {Item Description},",
				"          Date,",
				"          {Qty Due} = {Sum_Quantity Rate}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select15",
				"select15 aggregate(groupBy({Item Number},",
				"          {Item Description},",
				"          Date),",
				"     {Sum_Qty Due} = sum(toInteger({Qty Due}))) ~> aggregate12",
				"aggregate12 pivot(groupBy({Item Number},",
				"          {Item Description}),",
				"     pivotBy(Date),",
				"     {} = sum({Sum_Qty Due}),",
				"     columnNaming: '$N$V',",
				"     lateral: true) ~> pivot3",
				"pivot3, aggregate11 join(pivot3@{Item Number} == aggregate11@{Item Number}",
				"     && pivot3@{Item Description} == aggregate11@{Item Description},",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join7",
				"join7 derive(Type = \"Forecast\",",
				"          Order = 3) ~> derivedColumn13",
				"union2 aggregate(groupBy({Item Number},",
				"          {Item Description},",
				"          union2@Date),",
				"     {Sum_Quantity Rate} = sum(toInteger({Quantity Rate}))) ~> aggregate13",
				"aggregate13 select(mapColumn(",
				"          {Item Number},",
				"          {Item Description},",
				"          Date,",
				"          {Sum_Quantity Rate}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select16",
				"select16 derive(Date = addDays(Date, -(dayOfMonth(currentDate()))+1)) ~> derivedColumn14",
				"select16 aggregate(groupBy({Item Number},",
				"          {Item Description}),",
				"     Total = sum({Sum_Quantity Rate})) ~> aggregate14",
				"derivedColumn14 select(mapColumn(",
				"          {Item Number},",
				"          {Item Description},",
				"          Date,",
				"          {Qty Due} = {Sum_Quantity Rate}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select17",
				"select17 aggregate(groupBy({Item Number},",
				"          {Item Description},",
				"          Date),",
				"     {Sum_Qty Due} = sum({Qty Due})) ~> aggregate15",
				"aggregate15 pivot(groupBy({Item Number},",
				"          {Item Description}),",
				"     pivotBy(Date),",
				"     {} = sum({Sum_Qty Due}),",
				"     columnNaming: '$N$V',",
				"     lateral: true) ~> pivot4",
				"pivot4, aggregate14 join(pivot4@{Item Number} == aggregate14@{Item Number}",
				"     && pivot4@{Item Description} == aggregate14@{Item Description},",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join8",
				"join8 derive(Type = \"Total (POs + Forecast)\",",
				"          Order = 4) ~> derivedColumn15",
				"derivedColumn9 select(mapColumn(",
				"          {Item Number} = pivot2@{Item Number},",
				"          {Item Description} = pivot2@{Item Description},",
				"          {Source Vendor Name} = pivot2@{Source Vendor Name},",
				"          {Item Number} = aggregate8@{Item Number},",
				"          {Item Description} = aggregate8@{Item Description},",
				"          {Source Vendor Name} = aggregate8@{Source Vendor Name},",
				"          Total,",
				"          {Item Number} = aggregate5@{Item Number},",
				"          {CountDistinct_Source Vendor Name},",
				"          Type,",
				"          Order",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> unionto1",
				"derivedColumn7 select(mapColumn(",
				"          {Item Number} = pivot1@{Item Number},",
				"          {Item Description} = pivot1@{Item Description},",
				"          {Item Number} = aggregate6@{Item Number},",
				"          {Item Description} = aggregate6@{Item Description},",
				"          Total,",
				"          Type,",
				"          Order",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> unionto2",
				"derivedColumn13 select(mapColumn(",
				"          {Item Number} = pivot3@{Item Number},",
				"          {Item Description} = pivot3@{Item Description},",
				"          {Item Number} = aggregate11@{Item Number},",
				"          {Item Description} = aggregate11@{Item Description},",
				"          Total,",
				"          Type,",
				"          Order",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> unionto3",
				"derivedColumn15 select(mapColumn(",
				"          {Item Number} = pivot4@{Item Number},",
				"          {Item Description} = pivot4@{Item Description},",
				"          {Item Number} = aggregate14@{Item Number},",
				"          {Item Description} = aggregate14@{Item Description},",
				"          Total,",
				"          Type,",
				"          Order",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> unionto4",
				"unionto2, unionto1 union(byName: true)~> union3",
				"union3, unionto3 union(byName: true)~> union4",
				"union4, unionto4 union(byName: true)~> union5",
				"union5 sort(asc({Item Number}, true),",
				"     asc(Order, true)) ~> sort1",
				"select2 aggregate(groupBy(Item,",
				"          Program,",
				"          {Qty Per}),",
				"     each(match(name!='Item'&&name!='Program'&&name!='Qty Per'), $$ = first($$))) ~> aggregate16",
				"sort1, aggregate16 join({Item Number} == Item,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join9",
				"join9 select(mapColumn(",
				"          {CItem Number} = {Item Number},",
				"          {DItem Description} = {Item Description},",
				"          ZTotal = Total,",
				"          EType = Type,",
				"          FOrder = Order,",
				"          {Source Vendor Name},",
				"          {CountDistinct_Source Vendor Name},",
				"          Item,",
				"          AProgram = Program,",
				"          {BQty Per} = {Qty Per}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select18",
				"select18 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     umask: 0022,",
				"     preCommands: [],",
				"     postCommands: [],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> sink1"
			]
		}
	}
}