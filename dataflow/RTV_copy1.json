{
	"name": "RTV_copy1",
	"properties": {
		"folder": {
			"name": "RTV Tableau Publish"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"name": "container33"
				},
				{
					"name": "ALLRTVDetails"
				}
			],
			"sinks": [
				{
					"name": "sink1"
				},
				{
					"name": "sink2"
				}
			],
			"transformations": [
				{
					"name": "UniqueRows"
				},
				{
					"name": "select1"
				},
				{
					"name": "filter1"
				},
				{
					"name": "filter2"
				},
				{
					"name": "filter3"
				},
				{
					"name": "select2"
				},
				{
					"name": "UniuqureRowsall"
				},
				{
					"name": "Formulae1"
				},
				{
					"name": "Summarise1"
				},
				{
					"name": "UniqueRowsall2"
				},
				{
					"name": "UniqueRows1"
				},
				{
					"name": "RightOuter1"
				},
				{
					"name": "deselect3"
				},
				{
					"name": "UniqueRows2"
				},
				{
					"name": "TenToTimestampCols"
				},
				{
					"name": "FiveToTimestampCols"
				},
				{
					"name": "filter4"
				},
				{
					"name": "ReqCols2"
				},
				{
					"name": "ReqCols3"
				},
				{
					"name": "innerJoin1"
				},
				{
					"name": "Unselectingdummy"
				},
				{
					"name": "UnselectDummy2"
				},
				{
					"name": "unselectingDummy3"
				},
				{
					"name": "RenamingRights1"
				},
				{
					"name": "LeftAnti1"
				},
				{
					"name": "RightAnti1"
				},
				{
					"name": "innerJoin2"
				},
				{
					"name": "RenamingRights2"
				},
				{
					"name": "LeftAnti2"
				},
				{
					"name": "RightAnti2"
				},
				{
					"name": "FullOuterJoin"
				},
				{
					"name": "RenamingRights3"
				},
				{
					"name": "UnioningAllJoins"
				},
				{
					"name": "FormulaBeforeInfinity"
				},
				{
					"name": "sortBeforeMultiRow1"
				},
				{
					"name": "MultiRow1"
				},
				{
					"name": "selectBeforeMultiRow"
				},
				{
					"name": "ConditionForMultiRow1"
				},
				{
					"name": "MultiRow2"
				},
				{
					"name": "derivedColumn1"
				},
				{
					"name": "sort1"
				},
				{
					"name": "FirstRows"
				},
				{
					"name": "filteringRanEquals1"
				},
				{
					"name": "FinalUniqueRowsForReport1"
				},
				{
					"name": "RemoveDum"
				},
				{
					"name": "sort2"
				},
				{
					"name": "window1"
				},
				{
					"name": "derivedColumn2"
				},
				{
					"name": "window2"
				},
				{
					"name": "derivedColumn3"
				},
				{
					"name": "sort3"
				},
				{
					"name": "window3"
				},
				{
					"name": "filter5"
				},
				{
					"name": "UniqueRowsforReport2"
				},
				{
					"name": "RemoveDumm"
				},
				{
					"name": "AllRepairOrdersContainer",
					"flowlet": {
						"referenceName": "all_repair_orders_fLOWLET",
						"type": "DataFlowReference"
					}
				}
			],
			"scriptLines": [
				"parameters{",
				"     Uniquerows as string ('AMS Item Name,Avg Addl Funds,Business Area,Contract Number,Contract Warranty End Date,Customer Name,Customer Product Id,Customer Type,Estimate Approval Status,Incident Type,Instance Warranty End Date,Internal Order Flag,Inventory Organisation Name,DRO Item Description,Item Instance Number,Item Insatnce Status,Item Lot Number,DRO Item Number,Item Revision,Item$Inventory Item Id,Item$Organisation Id,Locator,Product Line,Project Number,Quantity In Wip,Receive Date,Received Quantity,Repair Currency Code,Repair Item Serial Number,Repair Item Uom,Repair Line Id,Repair Number,Repair Order Closed Date,Repair Order Creation Date,Repair Order Project,Repair Order Promised Date,Repair Order Task,Repair Owner Name,Repair Quantity,Repair Reason,Repair Status,Repair Type,Repair$Actual Complete Date,Repair$Actual Repair Price,Repair$Actual Start Date,Repair$Metric Completion Date,Repair$Program,Repair$Returning Platform,Repair$Service Affliation,Repair$Ssl,Repair$Tail Number,Repair$Tat Adj,Repair$Tat Adj Reason,Repair$Vendor Name,Repair$Vendor RMA,report_date,Rma Order Number,Ship Date,Shipped Quantity,Sr group Name,Sr Owner Name,Time In Hold Status,Time In Open Status,Time In Repair,Times Returned,Total Actual Amount,Total Estimate Amount,Unit Selling Price,Warehouse Code,Warranty Status'),",
				"     UniqueRowsForReports as string (\"3PL RTV Receipt Date,3PL RTV Ship Date,AMS Item Name,Approval Date,Arrived at Vendor Date,AWR Ship Date,Business Area,Buyer Name,Customer Name,First Po Approval Date,NMR Creation Date,Nmr Det Date Action Taken,Nmr Det Line Creation Date,Nmr Det Oper Name,Nmr Nmr Date Closed,Nmr Pn,Nmr Pn Desc,Nmr Sn,NMR STATUS,NMR_ORIGINATOR,Order Created By,Order Status,Organization Code,Parent NMR,Parent RMA Number,PO Closure Status,Po Line Creation Date,Po Line Number,Po Number,PO OTD,PO Promised Date,PO Unit Price,Product Line,Program,Project Number,Receive Date,Repair Item Number,Repair Item Serial Number,Repair Number,Repair Order Closed Date,Repair Order Promised Date,Repair Owner Name,Repair Reason,Repair Status,Repair$Actual Complete Date,Repair$Actual Start Date,Req Create Date,Requisition Line Number,Requisition Number,Rma Creation Date,RO Line Status,RTV NMR Number,Shipped from Vendor Date,Sr Owner Name,Task Number,Time In Repair,Vendor Age,Vendor Name,Vendor Turnaround Time\")",
				"}",
				"source(output(",
				"          ACTION_CODE as string,",
				"          ACTION_DESCRIPTION as string,",
				"          ACTION_TYPE as string,",
				"          ACTUAL_SHIPMENT_DATE as string,",
				"          CUSTOMER_NAME as string,",
				"          ORDER_NUMBER as string,",
				"          PO_NUMBER as string,",
				"          {ITEM$SV$PART_NUMBER} as string,",
				"          ITEM_DESCRIPTION as string,",
				"          ORDERED_DATE as string,",
				"          RECEIVED_QUANTITY as short,",
				"          REPAIR_LINE_ID as integer,",
				"          REPAIR_NUMBER as string,",
				"          REPAIR_ORDER_CREATION_DATE as string,",
				"          REPAIR_ORDER_PROMISED_DATE as string,",
				"          REPAIR_QUANTITY as boolean,",
				"          REPAIR_STATUS as string,",
				"          REPAIR_TYPE as string,",
				"          SR_OWNER_NAME as string,",
				"          SALES_ORDER_STATUS as string,",
				"          WAREHOUSE_CODE as short,",
				"          LINE_CATEGORY_CODE as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     fileSystem: 'rtv-tableau-workflow',",
				"     folderPath: 'input',",
				"     fileName: 'container33.csv',",
				"     columnDelimiter: ',',",
				"     escapeChar: '\\\\',",
				"     quoteChar: '\\\"',",
				"     columnNamesAsHeader: true) ~> container33",
				"source(output(",
				"          Name as string,",
				"          {RTV NMR Number} as string,",
				"          {Viasat NMR Number} as string,",
				"          {Nmr Parent Nmr} as string,",
				"          {Nmr Det Sn} as string,",
				"          {Nmr Sn} as string,",
				"          {Item Number} as string,",
				"          {Nmr Pn} as string,",
				"          {Nmr Parent Sn} as string,",
				"          {Repair Item Serial Number} as string,",
				"          {OM Order Number} as string,",
				"          {Order Number} as string,",
				"          {Repair Number} as string,",
				"          {Viasat RMA Number} as string,",
				"          {ViaSat Parent RMA} as string,",
				"          {DRO RMA Order Number} as string,",
				"          {Parent RMA Number} as string,",
				"          NMR_ORIGINATOR as string,",
				"          {Nmr Det Oper Name} as string,",
				"          {Repair Owner Name} as string,",
				"          {Order Created By} as string,",
				"          {Sr Owner Name} as string,",
				"          {Requisition Number} as string,",
				"          {Requisition Line Number} as string,",
				"          {Po Number} as string,",
				"          {Po Line Number} as string,",
				"          {Vendor Name} as string,",
				"          {Buyer Name} as string,",
				"          {AMS Item Name} as string,",
				"          {Product Line} as string,",
				"          Program as string,",
				"          {Business Area} as string,",
				"          {Customer Name} as string,",
				"          {RO Line Status} as string,",
				"          {Order Status} as string,",
				"          {Repair Status} as string,",
				"          {Repair Reason} as string,",
				"          {PO Closure Status} as string,",
				"          {PO Unit Price} as string,",
				"          {Repair Order Creation Date} as string,",
				"          {Rma Creation Date} as string,",
				"          {Repair$Actual Start Date} as string,",
				"          {Receive Date} as string,",
				"          {NMR Creation Date} as string,",
				"          {Nmr Det Line Creation Date} as string,",
				"          {Nmr Det Action Taken} as string,",
				"          {Req Create Date} as string,",
				"          {Approval Date} as string,",
				"          {Po Line Creation Date} as string,",
				"          {First Po Approval Date} as string,",
				"          {Arrived at Vendor Date} as string,",
				"          {On Time Delivery Date} as string,",
				"          {Shipped from Vendor Date} as string,",
				"          {Received from Vendor Date} as string,",
				"          {Repair Order Closed Date} as string,",
				"          {Ship Date} as string,",
				"          {Repair$Actual Complete Date} as string,",
				"          {Nmr Nmr Date Closed} as string,",
				"          {Promised Date} as string,",
				"          {Repair Order Promised Date} as string,",
				"          {Nmr Project No} as string,",
				"          {Project Number} as string,",
				"          {Task Number} as string,",
				"          {Nmr Pn Desc} as string,",
				"          DESCRIPTION as string,",
				"          ACTUAL_SHIPMENT_DATE as string,",
				"          {Item Description} as string,",
				"          {Line Number} as string,",
				"          {Line Quantity} as string,",
				"          {Line Ship From Org} as string,",
				"          {New Notes} as string,",
				"          {Nmr Det Date Action Taken} as string,",
				"          {Nmr Det Date Closed} as string,",
				"          {Nmr Det Desc Of Def} as string,",
				"          {Nmr Det Dispo} as string,",
				"          {NMR Details} as string,",
				"          {NMR STATUS} as string,",
				"          {Nmr Supplier} as string,",
				"          {Nmr Warranty} as string,",
				"          NMR_DET_REPAIR_ACTION as string,",
				"          {NMR RMA Line No} as string,",
				"          {NMR New Notes} as string,",
				"          {Om Or Pc} as string,",
				"          {Organization Code} as string,",
				"          {Po Item Description} as string,",
				"          {Po Revision Number} as string,",
				"          {Po Warranty Status} as string,",
				"          {Quantity In Wip} as string,",
				"          {Received Quantity} as string,",
				"          {Repair Line Id} as string,",
				"          {Repair Quantity} as string,",
				"          {Repair Type} as string,",
				"          {Repair$Tat Adj} as string,",
				"          {RQHDR$VSAT_CUST_PO_NUM} as string,",
				"          {RTV Hold End Date} as string,",
				"          {RTV Hold Start Date} as string,",
				"          {RTV Supplier SN} as string,",
				"          {Shipped Quantity} as string,",
				"          {Time In Hold Status} as string,",
				"          {Time In Open Status} as string,",
				"          {Time In Repair} as string,",
				"          {Times Returned} as string,",
				"          {Total Actual Amount} as string,",
				"          {Vendor Hold Time} as string,",
				"          {Vendor Pn} as string,",
				"          {Vendor Age} as string,",
				"          {Vendor RMA} as string,",
				"          {Warranty Status} as string,",
				"          {Salesforce Num} as string,",
				"          {NMR DATE CLOSED_DETCLOSED} as string,",
				"          {Requisition Created By} as string,",
				"          {DRO Po Number} as string,",
				"          {PO Note} as string,",
				"          {Price List} as string,",
				"          {Repair Type Reference} as string,",
				"          {Service Request Number} as string,",
				"          {Ship To Address1} as string,",
				"          {Ship To City} as string,",
				"          {Ship To State} as string,",
				"          {Sr Item Serial Number} as string,",
				"          {Sr Operating Unit Name} as string,",
				"          {Sr Severity} as string,",
				"          {Sr Status} as string,",
				"          Subinventory as string,",
				"          {Po Approved Date} as string,",
				"          {Failure Site} as string,",
				"          {Failure Date} as string,",
				"          {Report Symptom} as string,",
				"          Preparer as string,",
				"          {Cancelled Quantity} as string,",
				"          {Failure Cause Code} as string,",
				"          {Left_Right_PO Number} as string,",
				"          {Line Cancelled Flag} as string,",
				"          {Org Avg Item Cost} as string,",
				"          {Po Line Num} as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     container: 'rtv-tableau-workflow',",
				"     folderPath: 'input',",
				"     fileName: 'ALLRTVDetails.txt',",
				"     columnDelimiter: ',',",
				"     escapeChar: '\\\\',",
				"     quoteChar: '\\\"',",
				"     columnNamesAsHeader: true) ~> ALLRTVDetails",
				"compose(composition: 'all_repair_orders_fLOWLET') ~> AllRepairOrdersContainer@(HistoricalData)",
				"AllRepairOrdersContainer@HistoricalData aggregate(groupBy(dummy = sha2(256,byNames(split($Uniquerows,',')))),",
				"     each(match(true()), $$ = first($$))) ~> UniqueRows",
				"container33 select(mapColumn(",
				"          ACTION_CODE,",
				"          ACTION_DESCRIPTION,",
				"          ACTION_TYPE,",
				"          ACTUAL_SHIPMENT_DATE,",
				"          CUSTOMER_NAME,",
				"          ORDER_NUMBER,",
				"          PO_NUMBER,",
				"          {ITEM$SV$PART_NUMBER},",
				"          ITEM_DESCRIPTION,",
				"          ORDERED_DATE,",
				"          RECEIVED_QUANTITY,",
				"          REPAIR_LINE_ID,",
				"          REPAIR_NUMBER,",
				"          REPAIR_ORDER_CREATION_DATE,",
				"          REPAIR_ORDER_PROMISED_DATE,",
				"          REPAIR_QUANTITY,",
				"          REPAIR_STATUS,",
				"          REPAIR_TYPE,",
				"          SR_OWNER_NAME,",
				"          SALES_ORDER_STATUS,",
				"          WAREHOUSE_CODE,",
				"          LINE_CATEGORY_CODE",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select1",
				"select1 filter(SALES_ORDER_STATUS != \"CANCELLED\") ~> filter1",
				"filter1 filter(regexMatch(lower(ACTION_TYPE),\"third party\")) ~> filter2",
				"filter2 filter(!isNull(ORDER_NUMBER)) ~> filter3",
				"filter3 select(mapColumn(",
				"          ACTION_CODE,",
				"          ACTION_DESCRIPTION,",
				"          ACTION_TYPE,",
				"          ACTUAL_SHIPMENT_DATE,",
				"          CUSTOMER_NAME,",
				"          ORDER_NUMBER,",
				"          PO_NUMBER,",
				"          {ITEM$SV$PART_NUMBER},",
				"          ITEM_DESCRIPTION,",
				"          ORDERED_DATE,",
				"          RECEIVED_QUANTITY,",
				"          REPAIR_LINE_ID,",
				"          REPAIR_NUMBER,",
				"          REPAIR_ORDER_CREATION_DATE,",
				"          REPAIR_ORDER_PROMISED_DATE,",
				"          REPAIR_QUANTITY,",
				"          REPAIR_STATUS,",
				"          REPAIR_TYPE,",
				"          SR_OWNER_NAME,",
				"          SALES_ORDER_STATUS,",
				"          WAREHOUSE_CODE,",
				"          LINE_CATEGORY_CODE",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select2",
				"select2 aggregate(groupBy(dummycol = sha2(256,columns())),",
				"     each(match(true()), $$ = first($$))) ~> UniuqureRowsall",
				"UnselectDummy2 derive(RTV_SHIP_DATE = iif(LINE_CATEGORY_CODE == \"ORDER\",ACTUAL_SHIPMENT_DATE,\"\"),",
				"          RTV_RECEIPT_DATE = iif(LINE_CATEGORY_CODE == \"RETURN\",ACTUAL_SHIPMENT_DATE,\"\")) ~> Formulae1",
				"Formulae1 aggregate(groupBy(ORDER_NUMBER,",
				"          ACTION_CODE,",
				"          ACTION_DESCRIPTION,",
				"          CUSTOMER_NAME,",
				"          PO_NUMBER,",
				"          {ITEM$SV$PART_NUMBER},",
				"          ITEM_DESCRIPTION,",
				"          ORDERED_DATE,",
				"          REPAIR_LINE_ID,",
				"          REPAIR_NUMBER,",
				"          REPAIR_ORDER_CREATION_DATE,",
				"          REPAIR_ORDER_PROMISED_DATE,",
				"          RECEIVED_QUANTITY,",
				"          REPAIR_STATUS,",
				"          REPAIR_TYPE,",
				"          SR_OWNER_NAME,",
				"          WAREHOUSE_CODE),",
				"     Concat_RTV_SHIP_DATE = dropRight(toString(reduce(collect(RTV_SHIP_DATE),'',#item+','+#acc,#result)),1),",
				"          Concat_RTV_RECEIPT_DATE = dropRight(toString(reduce(collect(RTV_RECEIPT_DATE),'',#item+','+#acc,#result)),1)) ~> Summarise1",
				"Summarise1 aggregate(groupBy(duummycols = sha2(256,columns())),",
				"     each(match(true()), $$ = first($$))) ~> UniqueRowsall2",
				"unselectingDummy3 aggregate(groupBy(ORDER_NUMBER,",
				"          {ITEM$SV$PART_NUMBER},",
				"          Concat_RTV_RECEIPT_DATE,",
				"          Concat_RTV_SHIP_DATE,",
				"          REPAIR_LINE_ID,",
				"          REPAIR_NUMBER),",
				"     each(match(name!='ORDER_NUMBER'&&name!='ITEM$SV$PART_NUMBER'&&name!='Concat_RTV_RECEIPT_DATE'&&name!='Concat_RTV_SHIP_DATE'&&name!='Concat_RTV_SHIP_DATE'&&name!='REPAIR_NUMBER'&&name!='REPAIR_LINE_ID'), $$ = first($$))) ~> UniqueRows1",
				"Unselectingdummy, UniqueRows1 join({Repair Number} == REPAIR_NUMBER,",
				"     joinType:'right',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> RightOuter1",
				"RightOuter1 select(skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> deselect3",
				"deselect3 aggregate(groupBy(ORDER_NUMBER,",
				"          {Repair Line Id},",
				"          {Repair Number},",
				"          REPAIR_LINE_ID,",
				"          REPAIR_NUMBER),",
				"     each(match(name!='ORDER_NUMBER'&&name!='Repair Line Id'&&name!='Repair Number'&&name!='REPAIR_LINE_ID'&&name!='REPAIR_NUMBER'), $$ = first($$))) ~> UniqueRows2",
				"UniqueRows2 derive({Repair Order Closed Date} = {Repair Order Closed Date},",
				"          {Repair Order Promised Date} = toString(toTimestamp({Repair Order Promised Date}, 'yyyy-MM-dd HH:mm:ss'),'yyyy-MM-dd HH:mm:ss'),",
				"          {Repair Order Creation Date} = toString(toTimestamp({Repair Order Creation Date}, 'yyyy-MM-dd HH:mm:ss'),'yyyy-MM-dd HH:mm:ss'),",
				"          {Receive Date} = toString(toTimestamp({Receive Date}, 'yyyy-MM-dd HH:mm:ss'),'yyyy-MM-dd HH:mm:ss'),",
				"          {Repair$Actual Start Date} = toString(toTimestamp({Repair$Actual Start Date}, 'yyyy-MM-dd HH:mm:ss'),'yyyy-MM-dd HH:mm:ss'),",
				"          Concat_RTV_SHIP_DATE = toString(toTimestamp(Concat_RTV_SHIP_DATE, 'yyyy-MM-dd HH:mm:ss'),'yyyy-MM-dd HH:mm:ss'),",
				"          Concat_RTV_RECEIPT_DATE = toString(toTimestamp(Concat_RTV_RECEIPT_DATE, 'yyyy-MM-dd HH:mm:ss'),'yyyy-MM-dd HH:mm:ss'),",
				"          {Repair$Actual Complete Date} = toString(toTimestamp({Repair$Actual Complete Date}, 'yyyy-MM-dd HH:mm:ss'),'yyyy-MM-dd HH:mm:ss')) ~> TenToTimestampCols",
				"ALLRTVDetails derive({NMR Creation Date} = toString(toTimestamp({NMR Creation Date}, 'yyyy/MM/dd HH:mm:ss'),'yyyy-MM-dd HH:mm:ss'),",
				"          {Nmr Det Date Action Taken} = toString(toTimestamp({Nmr Det Date Action Taken}, 'yyyy/MM/dd HH:mm:ss'),'yyyy-MM-dd HH:mm:ss'),",
				"          {Nmr Det Line Creation Date} = toString(toTimestamp({Nmr Det Line Creation Date}, 'yyyy/MM/dd HH:mm:ss'),'yyyy-MM-dd HH:mm:ss')) ~> FiveToTimestampCols",
				"FiveToTimestampCols filter({Nmr Det Line Creation Date} > \"2015-01-01\" || isNull({Nmr Det Line Creation Date})) ~> filter4",
				"filter4 select(skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> ReqCols2",
				"TenToTimestampCols select(mapColumn(",
				"          ORDER_NUMBER,",
				"          {Repair Line Id},",
				"          {Repair Number},",
				"          REPAIR_LINE_ID,",
				"          REPAIR_NUMBER,",
				"          {Warehouse Code},",
				"          {Unit Selling Price},",
				"          {Total Estimate Amount},",
				"          {Total Actual Amount},",
				"          {Times Returned},",
				"          {Time In Repair},",
				"          {Time In Open Status},",
				"          {Time In Hold Status},",
				"          Subinventory,",
				"          {Shipped Quantity},",
				"          {Ship To State},",
				"          {Ship To City},",
				"          {Ship To Address1},",
				"          {Ship Date},",
				"          {Service Request Number},",
				"          {Salesforce Rma},",
				"          {Sr Status},",
				"          {Sr Severity},",
				"          {Sr Operating Unit Name},",
				"          {Sr Item Serial Number},",
				"          {Sr Group Name},",
				"          {Repair Type Reference},",
				"          {Repair Type},",
				"          {Repair Status},",
				"          {Repair Reason},",
				"          {Repair Quantity},",
				"          {Repair Priority},",
				"          {Repair Owner Name},",
				"          {Repair Order Task},",
				"          {Repair Order Promised Date},",
				"          {Repair Order Project},",
				"          {Repair Order Creation Date},",
				"          {Repair Order Closed Date},",
				"          {Repair Item Uom},",
				"          {Repair Item Serial Number},",
				"          {Repair Currency Code},",
				"          {Repair$Vendor Name},",
				"          {Repair$Tail Number},",
				"          {Repair$Tat Adj Reason},",
				"          {Repair$Service Affiliation},",
				"          {Repair$Ssl},",
				"          {Repair$Returning Platform},",
				"          {Repair$Program},",
				"          {Repair$Metric Completion Date},",
				"          {Repair$Ecd},",
				"          {Repair$Cust Rl Trx Context Val},",
				"          {Repair$Cust Rl Original Failur},",
				"          {Repair$Actual Start Date},",
				"          {Repair$Actual Repair Price},",
				"          {Repair$Actual Complete Date},",
				"          {Received Quantity},",
				"          {Receive Date},",
				"          {Price List},",
				"          Locator,",
				"          {Item Revision},",
				"          {Item Lot Number},",
				"          {Item Instance Status},",
				"          {Item Instance Number},",
				"          {Item Description},",
				"          {Item Number},",
				"          {Item$Organization Id},",
				"          {Item$Inventory Item Id},",
				"          {Inventory Organization Name},",
				"          {Internal Order Flag},",
				"          {Instance Warranty End Date},",
				"          {Incident Type},",
				"          {Estimate Approval Status},",
				"          {Customer Type},",
				"          {Customer Product Id},",
				"          {Customer Name},",
				"          {Contract Warranty End Date},",
				"          {Contract Number},",
				"          {Avg Addl Funds},",
				"          {Warranty Status},",
				"          {Product Line Business Area},",
				"          {Project Number},",
				"          {Product Line},",
				"          {Itemcat$Sv$Ams},",
				"          {Repair$Actual Complete Date2},",
				"          {Repair$Actual Start Date2},",
				"          report_date,",
				"          {Business Area},",
				"          {AMS Item Name},",
				"          {ITEM$SV$PART_NUMBER},",
				"          Concat_RTV_RECEIPT_DATE,",
				"          Concat_RTV_SHIP_DATE,",
				"          PO_NUMBER",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> ReqCols3",
				"ReqCols3, ReqCols2 join(ReqCols3@{Repair Number} == ReqCols2@{Repair Number}",
				"     && ReqCols3@{Repair Line Id} == ReqCols2@{Repair Line Id},",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> innerJoin1",
				"UniqueRows select(mapColumn(",
				"          {Warehouse Code},",
				"          {Unit Selling Price},",
				"          {Total Estimate Amount},",
				"          {Total Actual Amount},",
				"          {Times Returned},",
				"          {Time In Repair},",
				"          {Time In Open Status},",
				"          {Time In Hold Status},",
				"          Subinventory,",
				"          {Shipped Quantity},",
				"          {Ship To State},",
				"          {Ship To City},",
				"          {Ship To Address1},",
				"          {Ship Date},",
				"          {Service Request Number},",
				"          {Salesforce Rma},",
				"          {Sr Status},",
				"          {Sr Severity},",
				"          {Sr Operating Unit Name},",
				"          {Sr Item Serial Number},",
				"          {Sr Group Name},",
				"          {Repair Type Reference},",
				"          {Repair Type},",
				"          {Repair Status},",
				"          {Repair Reason},",
				"          {Repair Quantity},",
				"          {Repair Priority},",
				"          {Repair Owner Name},",
				"          {Repair Order Task},",
				"          {Repair Order Promised Date},",
				"          {Repair Order Project},",
				"          {Repair Order Creation Date},",
				"          {Repair Order Closed Date},",
				"          {Repair Number},",
				"          {Repair Line Id},",
				"          {Repair Item Uom},",
				"          {Repair Item Serial Number},",
				"          {Repair Currency Code},",
				"          {Repair$Vendor Name},",
				"          {Repair$Tail Number},",
				"          {Repair$Tat Adj Reason},",
				"          {Repair$Service Affiliation},",
				"          {Repair$Ssl},",
				"          {Repair$Returning Platform},",
				"          {Repair$Program},",
				"          {Repair$Metric Completion Date},",
				"          {Repair$Ecd},",
				"          {Repair$Cust Rl Trx Context Val},",
				"          {Repair$Cust Rl Original Failur},",
				"          {Repair$Actual Start Date},",
				"          {Repair$Actual Repair Price},",
				"          {Repair$Actual Complete Date},",
				"          {Received Quantity},",
				"          {Receive Date},",
				"          {Price List},",
				"          Locator,",
				"          {Item Revision},",
				"          {Item Lot Number},",
				"          {Item Instance Status},",
				"          {Item Instance Number},",
				"          {Item Description},",
				"          {Item Number},",
				"          {Item$Organization Id},",
				"          {Item$Inventory Item Id},",
				"          {Inventory Organization Name},",
				"          {Internal Order Flag},",
				"          {Instance Warranty End Date},",
				"          {Incident Type},",
				"          {Estimate Approval Status},",
				"          {Customer Type},",
				"          {Customer Product Id},",
				"          {Customer Name},",
				"          {Contract Warranty End Date},",
				"          {Contract Number},",
				"          {Avg Addl Funds},",
				"          {Warranty Status},",
				"          {Product Line Business Area},",
				"          {Project Number},",
				"          {Product Line},",
				"          {Itemcat$Sv$Ams},",
				"          {Repair$Actual Complete Date2},",
				"          {Repair$Actual Start Date2},",
				"          report_date,",
				"          {Business Area},",
				"          {AMS Item Name}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> Unselectingdummy",
				"UniuqureRowsall select(mapColumn(",
				"          ACTION_CODE,",
				"          ACTION_DESCRIPTION,",
				"          ACTION_TYPE,",
				"          ACTUAL_SHIPMENT_DATE,",
				"          CUSTOMER_NAME,",
				"          ORDER_NUMBER,",
				"          PO_NUMBER,",
				"          {ITEM$SV$PART_NUMBER},",
				"          ITEM_DESCRIPTION,",
				"          ORDERED_DATE,",
				"          RECEIVED_QUANTITY,",
				"          REPAIR_LINE_ID,",
				"          REPAIR_NUMBER,",
				"          REPAIR_ORDER_CREATION_DATE,",
				"          REPAIR_ORDER_PROMISED_DATE,",
				"          REPAIR_QUANTITY,",
				"          REPAIR_STATUS,",
				"          REPAIR_TYPE,",
				"          SR_OWNER_NAME,",
				"          SALES_ORDER_STATUS,",
				"          WAREHOUSE_CODE,",
				"          LINE_CATEGORY_CODE",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> UnselectDummy2",
				"UniqueRowsall2 select(mapColumn(",
				"          ORDER_NUMBER,",
				"          Concat_RTV_RECEIPT_DATE,",
				"          Concat_RTV_SHIP_DATE,",
				"          PO_NUMBER,",
				"          REPAIR_LINE_ID,",
				"          REPAIR_NUMBER,",
				"          {ITEM$SV$PART_NUMBER}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> unselectingDummy3",
				"innerJoin1 select(mapColumn(",
				"          each(match(/* All input columns */true()),",
				"               /* Input name */$$ = $$)",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> RenamingRights1",
				"ReqCols3, ReqCols2 exists(ReqCols3@{Repair Number} == ReqCols2@{Repair Number}",
				"     && ReqCols3@{Repair Line Id} == ReqCols2@{Repair Line Id},",
				"     negate:true,",
				"     broadcast: 'auto')~> LeftAnti1",
				"ReqCols2, ReqCols3 exists(ReqCols2@{Repair Number} == ReqCols3@{Repair Number}",
				"     && ReqCols2@{Repair Line Id} == ReqCols3@{Repair Line Id},",
				"     negate:true,",
				"     broadcast: 'auto')~> RightAnti1",
				"LeftAnti1, RightAnti1 join(ORDER_NUMBER == {Parent RMA Number},",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> innerJoin2",
				"innerJoin2 select(mapColumn(",
				"          each(match(/* All input columns */true()),",
				"               /* Input name */$$ = $$)",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> RenamingRights2",
				"LeftAnti1, RightAnti1 exists(ORDER_NUMBER == {Parent RMA Number},",
				"     negate:true,",
				"     broadcast: 'auto')~> LeftAnti2",
				"RightAnti1, LeftAnti1 exists({Parent RMA Number} == ORDER_NUMBER,",
				"     negate:true,",
				"     broadcast: 'auto')~> RightAnti2",
				"LeftAnti2, RightAnti2 join(ORDER_NUMBER == {OM Order Number},",
				"     joinType:'outer',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> FullOuterJoin",
				"FullOuterJoin select(mapColumn(",
				"          each(match(/* All input columns */true()),",
				"               /* Input name */$$ = $$)",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> RenamingRights3",
				"RenamingRights2, RenamingRights1, RenamingRights3 union(byName: true)~> UnioningAllJoins",
				"UnioningAllJoins derive({Vendor Turnaround Time} = iif(isNull({Shipped from Vendor Date}),\"\",toString(toDate(toString({Shipped from Vendor Date},'yyyy-MM-dd')) - toDate(toString({Arrived at Vendor Date},'yyyy-MM-dd')))),",
				"          {Vendor Age} = iif(isNull({Shipped from Vendor Date}),toDate(toString(currentDate(),'yyyy-MM-dd')) - toDate(toString({Arrived at Vendor Date},'yyyy-MM-dd')),toDate(toString({Shipped from Vendor Date},'yyyy-MM-dd')) - toDate(toString({Arrived at Vendor Date},'yyyy-MM-dd'))),",
				"          {Vendor Name} = iif(isNull({Nmr Supplier}),{Vendor Name},{Nmr Supplier})) ~> FormulaBeforeInfinity",
				"selectBeforeMultiRow sort(asc({Repair Number}, false),",
				"     desc({3PL RTV Ship Date}, false)) ~> sortBeforeMultiRow1",
				"sortBeforeMultiRow1 window(over({Parent RMA Number}),",
				"     asc({Parent RMA Number}, true),",
				"     {3PL RTV Ship Date2} = lag({3PL RTV Ship Date}, 1, 0)) ~> MultiRow1",
				"FormulaBeforeInfinity select(mapColumn(",
				"          {3PL.RMA} = ORDER_NUMBER,",
				"          {Repair Line Id},",
				"          {Repair Number},",
				"          REPAIR_LINE_ID,",
				"          REPAIR_NUMBER,",
				"          {Warehouse Code},",
				"          {Unit Selling Price},",
				"          {Total Estimate Amount},",
				"          {Total Actual Amount},",
				"          {Times Returned},",
				"          {Time In Repair},",
				"          {Time In Open Status},",
				"          {Time In Hold Status},",
				"          Subinventory,",
				"          {Shipped Quantity},",
				"          {Ship To State},",
				"          {Ship To City},",
				"          {Ship To Address1},",
				"          {AWR Ship Date} = {Ship Date},",
				"          {Service Request Number},",
				"          {Salesforce Rma},",
				"          {Sr Status},",
				"          {Sr Severity},",
				"          {Sr Operating Unit Name},",
				"          {Sr Item Serial Number},",
				"          {Sr Group Name},",
				"          {Repair Type Reference},",
				"          {Repair Type},",
				"          {Repair Status},",
				"          {Repair Reason},",
				"          {Repair Quantity},",
				"          {Repair Priority},",
				"          {Repair Owner Name},",
				"          {Repair Order Task},",
				"          {Repair Order Promised Date},",
				"          {Repair Order Project},",
				"          {Repair Order Creation Date},",
				"          {Repair Order Closed Date},",
				"          {Repair Item Uom},",
				"          {Repair Item Serial Number},",
				"          {Repair Currency Code},",
				"          {Repair$Vendor Name},",
				"          {Repair$Tail Number},",
				"          {Repair$Tat Adj Reason},",
				"          {Repair$Service Affiliation},",
				"          {Repair$Ssl},",
				"          {Repair$Returning Platform},",
				"          {Repair$Program},",
				"          {Repair$Metric Completion Date},",
				"          {Repair$Ecd},",
				"          {Repair$Cust Rl Trx Context Val},",
				"          {Repair$Cust Rl Original Failur},",
				"          {Repair$Actual Start Date},",
				"          {Repair$Actual Repair Price},",
				"          {Repair$Actual Complete Date},",
				"          {Received Quantity},",
				"          {Receive Date},",
				"          {Price List},",
				"          Locator,",
				"          {Item Revision},",
				"          {Item Lot Number},",
				"          {Item Instance Status},",
				"          {Item Instance Number},",
				"          {Item Description},",
				"          {Repair Item Number} = {Item Number},",
				"          {Item$Organization Id},",
				"          {Item$Inventory Item Id},",
				"          {Inventory Organization Name},",
				"          {Internal Order Flag},",
				"          {Instance Warranty End Date},",
				"          {Incident Type},",
				"          {Estimate Approval Status},",
				"          {Customer Type},",
				"          {Customer Product Id},",
				"          {Customer Name},",
				"          {Contract Warranty End Date},",
				"          {Contract Number},",
				"          {Avg Addl Funds},",
				"          {Warranty Status},",
				"          {Product Line Business Area},",
				"          {Project Number},",
				"          {Product Line},",
				"          {Itemcat$Sv$Ams},",
				"          {Repair$Actual Complete Date2},",
				"          {Repair$Actual Start Date2},",
				"          report_date,",
				"          {Business Area},",
				"          {AMS Item Name},",
				"          {ITEM$SV$PART_NUMBER},",
				"          {3PL RTV Receipt Date} = Concat_RTV_RECEIPT_DATE,",
				"          {3PL RTV Ship Date} = Concat_RTV_SHIP_DATE,",
				"          PO_NUMBER,",
				"          Name,",
				"          {RTV NMR Number},",
				"          {Viasat NMR Number},",
				"          {Parent NMR} = {Nmr Parent Nmr},",
				"          {Nmr Det Sn},",
				"          {Nmr Sn},",
				"          {Nmr Pn},",
				"          {Nmr Parent Sn},",
				"          {OM Order Number},",
				"          {Order Number},",
				"          {Viasat RMA Number},",
				"          {ViaSat Parent RMA},",
				"          {DRO RMA Order Number},",
				"          {Parent RMA Number},",
				"          NMR_ORIGINATOR,",
				"          {Nmr Det Oper Name},",
				"          {Order Created By},",
				"          {Sr Owner Name},",
				"          {Requisition Number},",
				"          {Requisition Line Number},",
				"          {Po Number},",
				"          {Po Line Number},",
				"          {Vendor Name},",
				"          {Buyer Name},",
				"          Program,",
				"          {RO Line Status},",
				"          {Order Status},",
				"          {PO Closure Status},",
				"          {PO Unit Price},",
				"          {Rma Creation Date},",
				"          {NMR Creation Date},",
				"          {Nmr Det Line Creation Date},",
				"          {Nmr Det Action Taken},",
				"          {Req Create Date},",
				"          {Approval Date},",
				"          {Po Line Creation Date},",
				"          {First Po Approval Date},",
				"          {Arrived at Vendor Date},",
				"          {PO OTD} = {On Time Delivery Date},",
				"          {Shipped from Vendor Date},",
				"          {Received from Vendor Date},",
				"          {Nmr Nmr Date Closed},",
				"          {PO Promised Date} = {Promised Date},",
				"          {Nmr Project No},",
				"          {Task Number},",
				"          {Nmr Pn Desc},",
				"          DESCRIPTION,",
				"          ACTUAL_SHIPMENT_DATE,",
				"          {Line Number},",
				"          {Line Quantity},",
				"          {Line Ship From Org},",
				"          {New Notes},",
				"          {Nmr Det Date Action Taken},",
				"          {Nmr Det Date Closed},",
				"          {Nmr Det Desc Of Def},",
				"          {Nmr Det Dispo},",
				"          {NMR Details},",
				"          {NMR STATUS},",
				"          {Nmr Supplier},",
				"          {Nmr Warranty},",
				"          NMR_DET_REPAIR_ACTION,",
				"          {NMR RMA Line No},",
				"          {NMR New Notes},",
				"          {Om Or Pc},",
				"          {Organization Code},",
				"          {Po Item Description},",
				"          {Po Revision Number},",
				"          {Po Warranty Status},",
				"          {Quantity In Wip},",
				"          {Repair$Tat Adj},",
				"          {RQHDR$VSAT_CUST_PO_NUM},",
				"          {RTV Hold End Date},",
				"          {RTV Hold Start Date},",
				"          {RTV Supplier SN},",
				"          {Vendor Hold Time},",
				"          {Vendor Pn},",
				"          {Vendor Age},",
				"          {Vendor RMA},",
				"          {Salesforce Num},",
				"          {NMR DATE CLOSED_DETCLOSED},",
				"          {Requisition Created By},",
				"          {DRO Po Number},",
				"          {PO Note},",
				"          {Po Approved Date},",
				"          {Failure Site},",
				"          {Failure Date},",
				"          {Report Symptom},",
				"          Preparer,",
				"          {Cancelled Quantity},",
				"          {Failure Cause Code},",
				"          {Left_Right_PO Number},",
				"          {Line Cancelled Flag},",
				"          {Org Avg Item Cost},",
				"          {Po Line Num},",
				"          {Vendor Turnaround Time}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> selectBeforeMultiRow",
				"MultiRow1 derive({3PL RTV Ship Date} = iif(isNull({3PL RTV Ship Date}),{3PL RTV Ship Date2}, {3PL RTV Ship Date})) ~> ConditionForMultiRow1",
				"ConditionForMultiRow1 window(over({Parent RMA Number}),",
				"     asc({Parent RMA Number}, true),",
				"     {3PL RTV Receipt Date2} = lag({3PL RTV Receipt Date}, 1, 0)) ~> MultiRow2",
				"MultiRow2 derive({3PL RTV Receipt Date} = iif(isNull({3PL RTV Receipt Date}),{3PL RTV Receipt Date2}, {3PL RTV Receipt Date})) ~> derivedColumn1",
				"derivedColumn1 sort(asc({Parent RMA Number}, false),",
				"     desc({Req Create Date}, false),",
				"     desc({Po Line Creation Date}, false)) ~> sort1",
				"sort1 window(over({Nmr Pn},",
				"          {Nmr Sn},",
				"          {Parent RMA Number},",
				"          {Repair Number}),",
				"     asc({Parent RMA Number}, false),",
				"     asc({Repair Number}, true),",
				"     Rank = rowNumber()) ~> FirstRows",
				"FirstRows filter(Rank==1) ~> filteringRanEquals1",
				"filteringRanEquals1 aggregate(groupBy(dum = sha2(256,byNames(split($UniqueRowsForReports,',')))),",
				"     each(match(true()), $$ = first($$))) ~> FinalUniqueRowsForReport1",
				"FinalUniqueRowsForReport1 select(mapColumn(",
				"          RMA = {3PL.RMA},",
				"          {Repair Line Id},",
				"          {Repair Number},",
				"          REPAIR_LINE_ID,",
				"          REPAIR_NUMBER,",
				"          {Warehouse Code},",
				"          {Unit Selling Price},",
				"          {Total Estimate Amount},",
				"          {Total Actual Amount},",
				"          {Times Returned},",
				"          {Time In Repair},",
				"          {Time In Open Status},",
				"          {Time In Hold Status},",
				"          Subinventory,",
				"          {Shipped Quantity},",
				"          {Ship To State},",
				"          {Ship To City},",
				"          {Ship To Address1},",
				"          {AWR Ship Date},",
				"          {Service Request Number},",
				"          {Salesforce Rma},",
				"          {Sr Status},",
				"          {Sr Severity},",
				"          {Sr Operating Unit Name},",
				"          {Sr Item Serial Number},",
				"          {Sr Group Name},",
				"          {Repair Type Reference},",
				"          {Repair Type},",
				"          {Repair Status},",
				"          {Repair Reason},",
				"          {Repair Quantity},",
				"          {Repair Priority},",
				"          {Repair Owner Name},",
				"          {Repair Order Task},",
				"          {Repair Order Promised Date},",
				"          {Repair Order Project},",
				"          {Repair Order Creation Date},",
				"          {Repair Order Closed Date},",
				"          {Repair Item Uom},",
				"          {Repair Item Serial Number},",
				"          {Repair Currency Code},",
				"          {Repair$Vendor Name},",
				"          {Repair$Tail Number},",
				"          {Repair$Tat Adj Reason},",
				"          {Repair$Service Affiliation},",
				"          {Repair$Ssl},",
				"          {Repair$Returning Platform},",
				"          {Repair$Program},",
				"          {Repair$Metric Completion Date},",
				"          {Repair$Ecd},",
				"          {Repair$Cust Rl Trx Context Val},",
				"          {Repair$Cust Rl Original Failur},",
				"          {Repair$Actual Start Date},",
				"          {Repair$Actual Repair Price},",
				"          {Repair$Actual Complete Date},",
				"          {Received Quantity},",
				"          {Receive Date},",
				"          {Price List},",
				"          Locator,",
				"          {Item Revision},",
				"          {Item Lot Number},",
				"          {Item Instance Status},",
				"          {Item Instance Number},",
				"          {Item Description},",
				"          {Repair Item Number},",
				"          {Item$Organization Id},",
				"          {Item$Inventory Item Id},",
				"          {Inventory Organization Name},",
				"          {Internal Order Flag},",
				"          {Instance Warranty End Date},",
				"          {Incident Type},",
				"          {Estimate Approval Status},",
				"          {Customer Type},",
				"          {Customer Product Id},",
				"          {Customer Name},",
				"          {Contract Warranty End Date},",
				"          {Contract Number},",
				"          {Avg Addl Funds},",
				"          {Warranty Status},",
				"          {Product Line Business Area},",
				"          {Project Number},",
				"          {Product Line},",
				"          {Itemcat$Sv$Ams},",
				"          {Repair$Actual Complete Date2},",
				"          {Repair$Actual Start Date2},",
				"          report_date,",
				"          {Business Area},",
				"          {AMS Item Name},",
				"          {ITEM$SV$PART_NUMBER},",
				"          {3PL RTV Receipt Date},",
				"          {3PL RTV Ship Date},",
				"          PO_NUMBER,",
				"          Name,",
				"          {RTV NMR Number},",
				"          {Viasat NMR Number},",
				"          {Parent NMR},",
				"          {Nmr Det Sn},",
				"          {Nmr Sn},",
				"          {Nmr Pn},",
				"          {Nmr Parent Sn},",
				"          {OM Order Number},",
				"          {Order Number},",
				"          {Viasat RMA Number},",
				"          {ViaSat Parent RMA},",
				"          {DRO RMA Order Number},",
				"          {Parent RMA Number},",
				"          NMR_ORIGINATOR,",
				"          {Nmr Det Oper Name},",
				"          {Order Created By},",
				"          {Sr Owner Name},",
				"          {Requisition Number},",
				"          {Requisition Line Number},",
				"          {Po Number},",
				"          {Po Line Number},",
				"          {Vendor Name},",
				"          {Buyer Name},",
				"          Program,",
				"          {RO Line Status},",
				"          {Order Status},",
				"          {PO Closure Status},",
				"          {PO Unit Price},",
				"          {Rma Creation Date},",
				"          {NMR Creation Date},",
				"          {Nmr Det Line Creation Date},",
				"          {Nmr Det Action Taken},",
				"          {Req Create Date},",
				"          {Approval Date},",
				"          {Po Line Creation Date},",
				"          {First Po Approval Date},",
				"          {Arrived at Vendor Date},",
				"          {PO OTD},",
				"          {Shipped from Vendor Date},",
				"          {Received from Vendor Date},",
				"          {Nmr Nmr Date Closed},",
				"          {PO Promised Date},",
				"          {Nmr Project No},",
				"          {Task Number},",
				"          {Nmr Pn Desc},",
				"          DESCRIPTION,",
				"          ACTUAL_SHIPMENT_DATE,",
				"          {Line Number},",
				"          {Line Quantity},",
				"          {Line Ship From Org},",
				"          {New Notes},",
				"          {Nmr Det Date Action Taken},",
				"          {Nmr Det Date Closed},",
				"          {Nmr Det Desc Of Def},",
				"          {Nmr Det Dispo},",
				"          {NMR Details},",
				"          {NMR STATUS},",
				"          {Nmr Supplier},",
				"          {Nmr Warranty},",
				"          NMR_DET_REPAIR_ACTION,",
				"          {NMR RMA Line No},",
				"          {NMR New Notes},",
				"          {Om Or Pc},",
				"          {Organization Code},",
				"          {Po Item Description},",
				"          {Po Revision Number},",
				"          {Po Warranty Status},",
				"          {Quantity In Wip},",
				"          {Repair$Tat Adj},",
				"          {RQHDR$VSAT_CUST_PO_NUM},",
				"          {RTV Hold End Date},",
				"          {RTV Hold Start Date},",
				"          {RTV Supplier SN},",
				"          {Vendor Hold Time},",
				"          {Vendor Pn},",
				"          {Vendor Age},",
				"          {Vendor RMA},",
				"          {Salesforce Num},",
				"          {NMR DATE CLOSED_DETCLOSED},",
				"          {Requisition Created By},",
				"          {DRO Po Number},",
				"          {PO Note},",
				"          {Po Approved Date},",
				"          {Failure Site},",
				"          {Failure Date},",
				"          {Report Symptom},",
				"          Preparer,",
				"          {Cancelled Quantity},",
				"          {Failure Cause Code},",
				"          {Left_Right_PO Number},",
				"          {Line Cancelled Flag},",
				"          {Org Avg Item Cost},",
				"          {Po Line Num},",
				"          {Vendor Turnaround Time}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> RemoveDum",
				"selectBeforeMultiRow sort(asc({Repair Number}, false),",
				"     desc({3PL RTV Ship Date}, false)) ~> sort2",
				"sort2 window(over({Parent RMA Number}),",
				"     asc({Parent RMA Number}, true),",
				"     {3PL RTV Ship Date2} = lag({3PL RTV Ship Date}, 1, 0)) ~> window1",
				"window1 derive({3PL RTV Ship Date} = iif(isNull({3PL RTV Ship Date}),{3PL RTV Ship Date2}, {3PL RTV Ship Date})) ~> derivedColumn2",
				"derivedColumn2 window(over({Parent RMA Number}),",
				"     asc({Parent RMA Number}, true),",
				"     {3PL RTV Receipt Date2} = lag({3PL RTV Receipt Date}, 1, 0)) ~> window2",
				"window2 derive({3PL RTV Receipt Date} = iif(isNull({3PL RTV Receipt Date}),{3PL RTV Receipt Date2}, {3PL RTV Receipt Date})) ~> derivedColumn3",
				"derivedColumn3 sort(asc({Parent RMA Number}, false),",
				"     desc({Req Create Date}, false),",
				"     desc({Po Line Creation Date}, true)) ~> sort3",
				"sort3 window(over({Nmr Pn},",
				"          {Nmr Sn},",
				"          {Parent RMA Number},",
				"          {Repair Number}),",
				"     asc({Parent RMA Number}, false),",
				"     asc({Repair Number}, true),",
				"     Rank = rowNumber()) ~> window3",
				"window3 filter(Rank==1) ~> filter5",
				"filter5 aggregate(groupBy(dumm = sha2(256,byNames(split($UniqueRowsForReports,',')))),",
				"     each(match(true()), $$ = first($$))) ~> UniqueRowsforReport2",
				"UniqueRowsforReport2 select(mapColumn(",
				"          RMA = {3PL.RMA},",
				"          {Repair Line Id},",
				"          {Repair Number},",
				"          REPAIR_LINE_ID,",
				"          REPAIR_NUMBER,",
				"          {Warehouse Code},",
				"          {Unit Selling Price},",
				"          {Total Estimate Amount},",
				"          {Total Actual Amount},",
				"          {Times Returned},",
				"          {Time In Repair},",
				"          {Time In Open Status},",
				"          {Time In Hold Status},",
				"          Subinventory,",
				"          {Shipped Quantity},",
				"          {Ship To State},",
				"          {Ship To City},",
				"          {Ship To Address1},",
				"          {AWR Ship Date},",
				"          {Service Request Number},",
				"          {Salesforce Rma},",
				"          {Sr Status},",
				"          {Sr Severity},",
				"          {Sr Operating Unit Name},",
				"          {Sr Item Serial Number},",
				"          {Sr Group Name},",
				"          {Repair Type Reference},",
				"          {Repair Type},",
				"          {Repair Status},",
				"          {Repair Reason},",
				"          {Repair Quantity},",
				"          {Repair Priority},",
				"          {Repair Owner Name},",
				"          {Repair Order Task},",
				"          {Repair Order Promised Date},",
				"          {Repair Order Project},",
				"          {Repair Order Creation Date},",
				"          {Repair Order Closed Date},",
				"          {Repair Item Uom},",
				"          {Repair Item Serial Number},",
				"          {Repair Currency Code},",
				"          {Repair$Vendor Name},",
				"          {Repair$Tail Number},",
				"          {Repair$Tat Adj Reason},",
				"          {Repair$Service Affiliation},",
				"          {Repair$Ssl},",
				"          {Repair$Returning Platform},",
				"          {Repair$Program},",
				"          {Repair$Metric Completion Date},",
				"          {Repair$Ecd},",
				"          {Repair$Cust Rl Trx Context Val},",
				"          {Repair$Cust Rl Original Failur},",
				"          {Repair$Actual Start Date},",
				"          {Repair$Actual Repair Price},",
				"          {Repair$Actual Complete Date},",
				"          {Received Quantity},",
				"          {Receive Date},",
				"          {Price List},",
				"          Locator,",
				"          {Item Revision},",
				"          {Item Lot Number},",
				"          {Item Instance Status},",
				"          {Item Instance Number},",
				"          {Item Description},",
				"          {Repair Item Number},",
				"          {Item$Organization Id},",
				"          {Item$Inventory Item Id},",
				"          {Inventory Organization Name},",
				"          {Internal Order Flag},",
				"          {Instance Warranty End Date},",
				"          {Incident Type},",
				"          {Estimate Approval Status},",
				"          {Customer Type},",
				"          {Customer Product Id},",
				"          {Customer Name},",
				"          {Contract Warranty End Date},",
				"          {Contract Number},",
				"          {Avg Addl Funds},",
				"          {Warranty Status},",
				"          {Product Line Business Area},",
				"          {Project Number},",
				"          {Product Line},",
				"          {Itemcat$Sv$Ams},",
				"          {Repair$Actual Complete Date2},",
				"          {Repair$Actual Start Date2},",
				"          report_date,",
				"          {Business Area},",
				"          {AMS Item Name},",
				"          {ITEM$SV$PART_NUMBER},",
				"          {3PL RTV Receipt Date},",
				"          {3PL RTV Ship Date},",
				"          PO_NUMBER,",
				"          Name,",
				"          {RTV NMR Number},",
				"          {Viasat NMR Number},",
				"          {Parent NMR},",
				"          {Nmr Det Sn},",
				"          {Nmr Sn},",
				"          {Nmr Pn},",
				"          {Nmr Parent Sn},",
				"          {OM Order Number},",
				"          {Order Number},",
				"          {Viasat RMA Number},",
				"          {ViaSat Parent RMA},",
				"          {DRO RMA Order Number},",
				"          {Parent RMA Number},",
				"          NMR_ORIGINATOR,",
				"          {Nmr Det Oper Name},",
				"          {Order Created By},",
				"          {Sr Owner Name},",
				"          {Requisition Number},",
				"          {Requisition Line Number},",
				"          {Po Number},",
				"          {Po Line Number},",
				"          {Vendor Name},",
				"          {Buyer Name},",
				"          Program,",
				"          {RO Line Status},",
				"          {Order Status},",
				"          {PO Closure Status},",
				"          {PO Unit Price},",
				"          {Rma Creation Date},",
				"          {NMR Creation Date},",
				"          {Nmr Det Line Creation Date},",
				"          {Nmr Det Action Taken},",
				"          {Req Create Date},",
				"          {Approval Date},",
				"          {Po Line Creation Date},",
				"          {First Po Approval Date},",
				"          {Arrived at Vendor Date},",
				"          {PO OTD},",
				"          {Shipped from Vendor Date},",
				"          {Received from Vendor Date},",
				"          {Nmr Nmr Date Closed},",
				"          {PO Promised Date},",
				"          {Nmr Project No},",
				"          {Task Number},",
				"          {Nmr Pn Desc},",
				"          DESCRIPTION,",
				"          ACTUAL_SHIPMENT_DATE,",
				"          {Line Number},",
				"          {Line Quantity},",
				"          {Line Ship From Org},",
				"          {New Notes},",
				"          {Nmr Det Date Action Taken},",
				"          {Nmr Det Date Closed},",
				"          {Nmr Det Desc Of Def},",
				"          {Nmr Det Dispo},",
				"          {NMR Details},",
				"          {NMR STATUS},",
				"          {Nmr Supplier},",
				"          {Nmr Warranty},",
				"          NMR_DET_REPAIR_ACTION,",
				"          {NMR RMA Line No},",
				"          {NMR New Notes},",
				"          {Om Or Pc},",
				"          {Organization Code},",
				"          {Po Item Description},",
				"          {Po Revision Number},",
				"          {Po Warranty Status},",
				"          {Quantity In Wip},",
				"          {Repair$Tat Adj},",
				"          {RQHDR$VSAT_CUST_PO_NUM},",
				"          {RTV Hold End Date},",
				"          {RTV Hold Start Date},",
				"          {RTV Supplier SN},",
				"          {Vendor Hold Time},",
				"          {Vendor Pn},",
				"          {Vendor Age},",
				"          {Vendor RMA},",
				"          {Salesforce Num},",
				"          {NMR DATE CLOSED_DETCLOSED},",
				"          {Requisition Created By},",
				"          {DRO Po Number},",
				"          {PO Note},",
				"          {Po Approved Date},",
				"          {Failure Site},",
				"          {Failure Date},",
				"          {Report Symptom},",
				"          Preparer,",
				"          {Cancelled Quantity},",
				"          {Failure Cause Code},",
				"          {Left_Right_PO Number},",
				"          {Line Cancelled Flag},",
				"          {Org Avg Item Cost},",
				"          {Po Line Num},",
				"          {Vendor Turnaround Time}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> RemoveDumm",
				"RemoveDumm sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     partitionFileNames:['RTV 3PLL Spreadsheet.xlsx'],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     partitionBy('hash', 1),",
				"     preCommands: [],",
				"     postCommands: []) ~> sink1",
				"RemoveDum sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     partitionFileNames:['AMS RMA Data.xlsx'],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     preCommands: [],",
				"     postCommands: []) ~> sink2"
			]
		}
	}
}