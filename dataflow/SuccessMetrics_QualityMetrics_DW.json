{
	"name": "SuccessMetrics_QualityMetrics_DW",
	"properties": {
		"folder": {
			"name": "SuccessMetrics_QualityMetrics_DW"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "ds_csv_input",
						"type": "DatasetReference"
					},
					"name": "MissingReceivedDate"
				},
				{
					"dataset": {
						"referenceName": "ds_csv_input",
						"type": "DatasetReference"
					},
					"name": "OOWPrice"
				},
				{
					"dataset": {
						"referenceName": "ds_csv_input",
						"type": "DatasetReference"
					},
					"name": "OverallExceptions"
				},
				{
					"dataset": {
						"referenceName": "ds_csv_input",
						"type": "DatasetReference"
					},
					"name": "ServiceCodes"
				},
				{
					"dataset": {
						"referenceName": "ds_csv_input",
						"type": "DatasetReference"
					},
					"name": "MissingJN"
				},
				{
					"dataset": {
						"referenceName": "ds_csv_input",
						"type": "DatasetReference"
					},
					"name": "RepairStatusReason"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "ds_csv_output",
						"type": "DatasetReference"
					},
					"name": "sink1"
				},
				{
					"dataset": {
						"referenceName": "ds_csv_output",
						"type": "DatasetReference"
					},
					"name": "sink2"
				},
				{
					"dataset": {
						"referenceName": "ds_csv_output",
						"type": "DatasetReference"
					},
					"name": "sink3"
				},
				{
					"dataset": {
						"referenceName": "ds_csv_output",
						"type": "DatasetReference"
					},
					"name": "sink4"
				},
				{
					"dataset": {
						"referenceName": "ds_csv_output",
						"type": "DatasetReference"
					},
					"name": "sink5"
				},
				{
					"dataset": {
						"referenceName": "ds_csv_output",
						"type": "DatasetReference"
					},
					"name": "sink6"
				}
			],
			"transformations": [
				{
					"name": "DateTimeNow1"
				},
				{
					"name": "DateTimeNow2"
				},
				{
					"name": "DateTimeNow3"
				},
				{
					"name": "DateTimeNow4"
				},
				{
					"name": "DateTimeNow5"
				},
				{
					"name": "DateTimeNow6"
				},
				{
					"name": "derivedColumn1"
				},
				{
					"name": "derivedColumn2"
				},
				{
					"name": "derivedColumn3"
				},
				{
					"name": "derivedColumn4"
				},
				{
					"name": "derivedColumn5"
				},
				{
					"name": "derivedColumn6"
				}
			],
			"scriptLines": [
				"source(output(",
				"          {Customer Name} as string,",
				"          {Item$SV$Part Number} as string,",
				"          {Item Description} as string,",
				"          {RMA Order Number} as string,",
				"          {Receive Date} as date,",
				"          {Repair Item Serial Number} as string,",
				"          {Repair Number} as string,",
				"          {Repair Order Closed Date} as date,",
				"          {Repair Order Creation Date} as date,",
				"          {Repair Order Project} as string,",
				"          {Repair Owner Name} as string,",
				"          {Repair Reason} as string,",
				"          {Repair Status} as string,",
				"          {Repair Type} as string,",
				"          {SR Owner Name} as string,",
				"          {Ship Date} as date,",
				"          {Warehouse Code} as short,",
				"          {Product Line} as string,",
				"          {Repair$Actual Complete Date} as date,",
				"          {Repair$Actual Start Date} as date,",
				"          {AMS Item Name} as string,",
				"          {B Area} as string,",
				"          {Date for Report} as date,",
				"          {Exception Name} as string,",
				"          {Report Month} as string,",
				"          report_date as date",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     fileSystem: 'successmetrics-qualitymetric-dw',",
				"     folderPath: 'input',",
				"     fileName: 'AMS_Success_Metrics_Quality_MissingReceivedDate.csv.txt',",
				"     columnDelimiter: ',',",
				"     escapeChar: '\\\\',",
				"     quoteChar: '\\\"',",
				"     columnNamesAsHeader: true) ~> MissingReceivedDate",
				"source(output(",
				"          {Ordered Date} as date,",
				"          {Order Number} as string,",
				"          {Line #} as string,",
				"          {Ship Date} as date,",
				"          Project as string,",
				"          Task as string,",
				"          {Line Category Code} as string,",
				"          {Serial Num} as string,",
				"          {Item Num} as string,",
				"          {Line Open Flag} as string,",
				"          {Order Type} as string,",
				"          {Cust PO Number} as string,",
				"          Customer as string,",
				"          {Item Description} as string,",
				"          {Warranty Status} as string,",
				"          Qty as double,",
				"          Price as double,",
				"          {Addl Funds} as double,",
				"          Org as string,",
				"          {Created By} as string,",
				"          {Line Status} as string,",
				"          {Order Status} as string,",
				"          {Total Price} as double,",
				"          {Product Line} as string,",
				"          {B Area} as string,",
				"          {AMS Name} as string,",
				"          {PROJ$Order Management Project} as string,",
				"          {Ordered Month} as string,",
				"          {Exception Name} as string,",
				"          report_date as date",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     fileSystem: 'successmetrics-qualitymetric-dw',",
				"     folderPath: 'input',",
				"     fileName: 'AMS_Success_Metrics_Quality_OOWPrice.txt',",
				"     columnDelimiter: ',',",
				"     escapeChar: '\\\\',",
				"     quoteChar: '\\\"',",
				"     columnNamesAsHeader: true) ~> OOWPrice",
				"source(output(",
				"          {Exception Name} as string,",
				"          {Exception Month} as string,",
				"          {SR Owner Name} as string,",
				"          {Repair Owner Name} as string,",
				"          Count as integer,",
				"          report_date as date",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     fileSystem: 'successmetrics-qualitymetric-dw',",
				"     folderPath: 'input',",
				"     fileName: 'AMS_Success_Metrics_Quality_OverallException.txt',",
				"     columnDelimiter: ',',",
				"     escapeChar: '\\\\',",
				"     quoteChar: '\\\"',",
				"     columnNamesAsHeader: true) ~> OverallExceptions",
				"source(output(",
				"          {Repair Number} as string,",
				"          {Service Code Name} as string,",
				"          {Customer Name} as string,",
				"          {Item$SV$Part Number} as string,",
				"          {Item Description} as string,",
				"          {RMA Order Number} as string,",
				"          {Receive Date} as date,",
				"          {Repair Item Serial Number} as string,",
				"          {Right_Repair Number} as string,",
				"          {Repair Order Closed Date} as date,",
				"          {Repair Order Creation Date} as date,",
				"          {Repair Order Project} as string,",
				"          {Repair Owner Name} as string,",
				"          {Repair Reason} as string,",
				"          {Repair Status} as string,",
				"          {Repair Type} as string,",
				"          {SR Owner Name} as string,",
				"          {Ship Date} as date,",
				"          {Warehouse Code} as string,",
				"          {Product Line} as string,",
				"          {Repair$Actual Complete Date} as date,",
				"          {Repair$Actual Start Date} as date,",
				"          {AMS Item Name} as string,",
				"          {B Area} as string,",
				"          {Closed Month} as string,",
				"          {Exception Name} as string,",
				"          Exclusions as string,",
				"          report_date as date",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     fileSystem: 'successmetrics-qualitymetric-dw',",
				"     folderPath: 'input',",
				"     fileName: 'AMS_Success_Metrics_Quality_ServiceCodes.txt',",
				"     columnDelimiter: ',',",
				"     escapeChar: '\\\\',",
				"     quoteChar: '\\\"',",
				"     columnNamesAsHeader: true) ~> ServiceCodes",
				"source(output(",
				"          {Customer Name} as string,",
				"          {Item$SV$Part Number} as string,",
				"          {Item Description} as string,",
				"          {RMA Order Number} as string,",
				"          {Receive Date} as date,",
				"          {Repair Item Serial Number} as string,",
				"          {Repair Number} as string,",
				"          {Repair Order Closed Date} as date,",
				"          {Repair Order Creation Date} as date,",
				"          {Repair Order Project} as string,",
				"          {Repair Owner Name} as string,",
				"          {Repair Reason} as string,",
				"          {Repair Status} as string,",
				"          {Repair Type} as string,",
				"          {SR Owner Name} as string,",
				"          {Ship Date} as date,",
				"          {Warehouse Code} as short,",
				"          {Product Line} as string,",
				"          {Repair$Actual Complete Date} as date,",
				"          {Repair$Actual Start Date} as date,",
				"          {AMS Item Name} as string,",
				"          {B Area} as string,",
				"          {Created Month} as string,",
				"          {Exception Name} as string,",
				"          report_date as date",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     fileSystem: 'successmetrics-qualitymetric-dw',",
				"     folderPath: 'input',",
				"     fileName: 'AMS_Success_Metrics_Quality_MissingJN.txt',",
				"     columnDelimiter: ',',",
				"     escapeChar: '\\\\',",
				"     quoteChar: '\\\"',",
				"     columnNamesAsHeader: true) ~> MissingJN",
				"source(output(",
				"          {Customer Name} as string,",
				"          {Item$SV$Part Number} as string,",
				"          {Item Description} as string,",
				"          {RMA Order Number} as string,",
				"          {Receive Date} as date,",
				"          {Repair Item Serial Number} as string,",
				"          {Repair Number} as string,",
				"          {Repair Order Closed Date} as date,",
				"          {Repair Order Creation Date} as date,",
				"          {Repair Order Project} as string,",
				"          {Repair Owner Name} as string,",
				"          {Repair Reason} as string,",
				"          {Repair Status} as string,",
				"          {Repair Type} as string,",
				"          {SR Owner Name} as string,",
				"          {Ship Date} as date,",
				"          {Warehouse Code} as string,",
				"          {Product Line} as string,",
				"          {Repair$Actual Complete Date} as date,",
				"          {Repair$Actual Start Date} as date,",
				"          {AMS Item Name} as string,",
				"          {B Area} as string,",
				"          {Closed Month} as string,",
				"          {Exception Name} as string,",
				"          report_date as date",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     fileSystem: 'successmetrics-qualitymetric-dw',",
				"     folderPath: 'input',",
				"     fileName: 'AMS_Success_Metrics_Quality_RepairStatusReason.txt',",
				"     columnDelimiter: ',',",
				"     escapeChar: '\\\\',",
				"     quoteChar: '\\\"',",
				"     columnNamesAsHeader: true) ~> RepairStatusReason",
				"MissingReceivedDate derive(DateTimeNow = toString(currentDate())) ~> DateTimeNow1",
				"OOWPrice derive(DateTimeNow = toString(currentDate())) ~> DateTimeNow2",
				"OverallExceptions derive(DateTimeNow = toString(currentDate())) ~> DateTimeNow3",
				"ServiceCodes derive(DateTimeNow = toString(currentDate())) ~> DateTimeNow4",
				"MissingJN derive(DateTimeNow = toString(currentDate())) ~> DateTimeNow5",
				"RepairStatusReason derive(DateTimeNow = toString(currentDate())) ~> DateTimeNow6",
				"DateTimeNow1 derive(filepath = concat('SuccessMetrics_QualtyMetrics_DW/output/','AMS_Success_Metrics_Quality_MissingReceivedDate - ',DateTimeNow,'.csv')) ~> derivedColumn1",
				"DateTimeNow2 derive(filepath = concat('SuccessMetrics_QualtyMetrics_DW/output/','AMS_Success_Metrics_Quality_OOWPrice - ',DateTimeNow,'.csv')) ~> derivedColumn2",
				"DateTimeNow3 derive(filepath = concat('SuccessMetrics_QualtyMetrics_DW/output/','AMS_Success_Metrics_Quality_OverallExceptions - ',DateTimeNow,'.csv')) ~> derivedColumn3",
				"DateTimeNow4 derive(filepath = concat('SuccessMetrics_QualtyMetrics_DW/output/','AMS_Success_Metrics_Quality_ServiceCodes - ',DateTimeNow,'.csv')) ~> derivedColumn4",
				"DateTimeNow5 derive(filepath = concat('SuccessMetrics_QualtyMetrics_DW/output/','AMS_Success_Metrics_Quality_MissingJN - ',DateTimeNow,'.csv')) ~> derivedColumn5",
				"DateTimeNow6 derive(filepath = concat('SuccessMetrics_QualtyMetrics_DW/output/','AMS_Success_Metrics_Quality_RepairStatusReason - ',DateTimeNow,'.csv')) ~> derivedColumn6",
				"derivedColumn1 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     rowUrlColumn:'filepath',",
				"     umask: 0022,",
				"     preCommands: [],",
				"     postCommands: [],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     mapColumn(",
				"          {Customer Name},",
				"          {Item$SV$Part Number},",
				"          {Item Description},",
				"          {RMA Order Number},",
				"          {Receive Date},",
				"          {Repair Item Serial Number},",
				"          {Repair Number},",
				"          {Repair Order Closed Date},",
				"          {Repair Order Creation Date},",
				"          {Repair Order Project},",
				"          {Repair Owner Name},",
				"          {Repair Reason},",
				"          {Repair Status},",
				"          {Repair Type},",
				"          {SR Owner Name},",
				"          {Ship Date},",
				"          {Warehouse Code},",
				"          {Product Line},",
				"          {Repair$Actual Complete Date},",
				"          {Repair$Actual Start Date},",
				"          {AMS Item Name},",
				"          {B Area},",
				"          {Date for Report},",
				"          {Exception Name},",
				"          {Report Month},",
				"          report_date,",
				"          DateTimeNow",
				"     )) ~> sink1",
				"derivedColumn2 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     rowUrlColumn:'filepath',",
				"     umask: 0022,",
				"     preCommands: [],",
				"     postCommands: [],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     mapColumn(",
				"          {Ordered Date},",
				"          {Order Number},",
				"          {Line #},",
				"          {Ship Date},",
				"          Project,",
				"          Task,",
				"          {Line Category Code},",
				"          {Serial Num},",
				"          {Item Num},",
				"          {Line Open Flag},",
				"          {Order Type},",
				"          {Cust PO Number},",
				"          Customer,",
				"          {Item Description},",
				"          {Warranty Status},",
				"          Qty,",
				"          Price,",
				"          {Addl Funds},",
				"          Org,",
				"          {Created By},",
				"          {Line Status},",
				"          {Order Status},",
				"          {Total Price},",
				"          {Product Line},",
				"          {B Area},",
				"          {AMS Name},",
				"          {PROJ$Order Management Project},",
				"          {Ordered Month},",
				"          {Exception Name},",
				"          report_date,",
				"          DateTimeNow",
				"     )) ~> sink2",
				"derivedColumn3 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     rowUrlColumn:'filepath',",
				"     umask: 0022,",
				"     preCommands: [],",
				"     postCommands: [],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     mapColumn(",
				"          {Exception Name},",
				"          {Exception Month},",
				"          {SR Owner Name},",
				"          {Repair Owner Name},",
				"          Count,",
				"          report_date,",
				"          DateTimeNow",
				"     )) ~> sink3",
				"derivedColumn4 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     rowUrlColumn:'filepath',",
				"     umask: 0022,",
				"     preCommands: [],",
				"     postCommands: [],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     mapColumn(",
				"          {Repair Number},",
				"          {Service Code Name},",
				"          {Customer Name},",
				"          {Item$SV$Part Number},",
				"          {Item Description},",
				"          {RMA Order Number},",
				"          {Receive Date},",
				"          {Repair Item Serial Number},",
				"          {Right_Repair Number},",
				"          {Repair Order Closed Date},",
				"          {Repair Order Creation Date},",
				"          {Repair Order Project},",
				"          {Repair Owner Name},",
				"          {Repair Reason},",
				"          {Repair Status},",
				"          {Repair Type},",
				"          {SR Owner Name},",
				"          {Ship Date},",
				"          {Warehouse Code},",
				"          {Product Line},",
				"          {Repair$Actual Complete Date},",
				"          {Repair$Actual Start Date},",
				"          {AMS Item Name},",
				"          {B Area},",
				"          {Closed Month},",
				"          {Exception Name},",
				"          Exclusions,",
				"          report_date,",
				"          DateTimeNow",
				"     )) ~> sink4",
				"derivedColumn5 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     rowUrlColumn:'filepath',",
				"     umask: 0022,",
				"     preCommands: [],",
				"     postCommands: [],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     mapColumn(",
				"          {Customer Name},",
				"          {Item$SV$Part Number},",
				"          {Item Description},",
				"          {RMA Order Number},",
				"          {Receive Date},",
				"          {Repair Item Serial Number},",
				"          {Repair Number},",
				"          {Repair Order Closed Date},",
				"          {Repair Order Creation Date},",
				"          {Repair Order Project},",
				"          {Repair Owner Name},",
				"          {Repair Reason},",
				"          {Repair Status},",
				"          {Repair Type},",
				"          {SR Owner Name},",
				"          {Ship Date},",
				"          {Warehouse Code},",
				"          {Product Line},",
				"          {Repair$Actual Complete Date},",
				"          {Repair$Actual Start Date},",
				"          {AMS Item Name},",
				"          {B Area},",
				"          {Created Month},",
				"          {Exception Name},",
				"          report_date,",
				"          DateTimeNow",
				"     )) ~> sink5",
				"derivedColumn6 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     rowUrlColumn:'filepath',",
				"     umask: 0022,",
				"     preCommands: [],",
				"     postCommands: [],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     mapColumn(",
				"          {Customer Name},",
				"          {Item$SV$Part Number},",
				"          {Item Description},",
				"          {RMA Order Number},",
				"          {Receive Date},",
				"          {Repair Item Serial Number},",
				"          {Repair Number},",
				"          {Repair Order Closed Date},",
				"          {Repair Order Creation Date},",
				"          {Repair Order Project},",
				"          {Repair Owner Name},",
				"          {Repair Reason},",
				"          {Repair Status},",
				"          {Repair Type},",
				"          {SR Owner Name},",
				"          {Ship Date},",
				"          {Warehouse Code},",
				"          {Product Line},",
				"          {Repair$Actual Complete Date},",
				"          {Repair$Actual Start Date},",
				"          {AMS Item Name},",
				"          {B Area},",
				"          {Closed Month},",
				"          {Exception Name},",
				"          report_date,",
				"          DateTimeNow",
				"     )) ~> sink6"
			]
		}
	}
}