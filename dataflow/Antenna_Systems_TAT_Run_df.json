{
	"name": "Antenna_Systems_TAT_Run_df",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "ds_csv_input",
						"type": "DatasetReference"
					},
					"name": "inputcsv1antennaP2output1"
				},
				{
					"dataset": {
						"referenceName": "ds_csv_input",
						"type": "DatasetReference"
					},
					"name": "inputcsv2datedimensions"
				},
				{
					"dataset": {
						"referenceName": "ds_csv_input",
						"type": "DatasetReference"
					},
					"name": "inputcsv3antennaP2output2"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "ds_csv_output",
						"type": "DatasetReference"
					},
					"name": "antennasystemsp2output3"
				},
				{
					"dataset": {
						"referenceName": "ds_csv_output",
						"type": "DatasetReference"
					},
					"name": "antennasystemsp2output4"
				}
			],
			"transformations": [
				{
					"name": "derclumn1csv1"
				},
				{
					"name": "derclumn2csv1"
				},
				{
					"name": "select1csv1"
				},
				{
					"name": "select1csv2"
				},
				{
					"name": "join1csv1"
				},
				{
					"name": "filter1csv1"
				},
				{
					"name": "filter2csv1"
				},
				{
					"name": "aggrcsv1"
				},
				{
					"name": "select3csv1"
				},
				{
					"name": "derclumn1csv3"
				},
				{
					"name": "derclumn2csv3"
				},
				{
					"name": "split1"
				},
				{
					"name": "select4csv1"
				},
				{
					"name": "union1csv1"
				},
				{
					"name": "csv3split"
				},
				{
					"name": "select1csv3"
				},
				{
					"name": "join1csv3"
				},
				{
					"name": "select2csv3"
				},
				{
					"name": "filter1csv3"
				},
				{
					"name": "filter2csv3"
				},
				{
					"name": "aggregate2"
				},
				{
					"name": "select3csv3"
				},
				{
					"name": "union1csv3"
				},
				{
					"name": "select4csv3"
				},
				{
					"name": "select2csv1"
				},
				{
					"name": "join2csv1"
				},
				{
					"name": "select5csv1"
				},
				{
					"name": "select6csv1"
				},
				{
					"name": "derivedClumn3csv1"
				},
				{
					"name": "derivedClumn4csv1"
				},
				{
					"name": "derivedClumn5csv1"
				},
				{
					"name": "select7csv1"
				},
				{
					"name": "join3csv1"
				},
				{
					"name": "select8csv1"
				},
				{
					"name": "filter4csv1"
				},
				{
					"name": "filter5csv1"
				},
				{
					"name": "aggregate3"
				},
				{
					"name": "split2"
				},
				{
					"name": "union1"
				},
				{
					"name": "derivedClumn6csv1"
				},
				{
					"name": "derivedClumn7csv1"
				},
				{
					"name": "derivedClumn8csv1"
				},
				{
					"name": "derivedClumn9csv1"
				},
				{
					"name": "select9csv1"
				},
				{
					"name": "join4csv1"
				},
				{
					"name": "select10csv1"
				},
				{
					"name": "filter7csv1"
				},
				{
					"name": "filter8csv1"
				},
				{
					"name": "aggregate4"
				},
				{
					"name": "split3"
				},
				{
					"name": "union2"
				},
				{
					"name": "select11csv1"
				}
			],
			"scriptLines": [
				"source(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> inputcsv1antennaP2output1",
				"source(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> inputcsv2datedimensions",
				"source(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> inputcsv3antennaP2output2",
				"split1@split1inputcsv1 derive(DateBetweenDRO = {Actual Start Date}) ~> derclumn1csv1",
				"derclumn1csv1 derive(DateBetweenDRO = iif(DateBetweenDRO <= {DRO TAT SHIP DATE}, addDays((DateBetweenDRO),1),DateBetweenDRO)) ~> derclumn2csv1",
				"derclumn2csv1 select(mapColumn(",
				"          {Actual Shipment Date},",
				"          {AMS Item Name},",
				"          {Approval Date},",
				"          {Arrived at Vendor Date},",
				"          {Avg Addl Funds},",
				"          {Business Area},",
				"          {Buyer Name},",
				"          {Closure Status},",
				"          {Concat_NMR Details},",
				"          {Contract Number},",
				"          {Contract Warranty End Date},",
				"          {Customer Name},",
				"          {Customer Po Number},",
				"          {DRO Po Number},",
				"          {DRO TAT SHIP DATE},",
				"          {Failure Cause Code},",
				"          {Failure Date},",
				"          {Failure Site},",
				"          {Item Description},",
				"          {Item Number},",
				"          {Item Revision},",
				"          {Line Creation Date},",
				"          {Line Number},",
				"          {Line Quantity},",
				"          {Line Status},",
				"          Notes,",
				"          {NMR Creation Date},",
				"          {Nmr Customer},",
				"          {NMR DATE CLOSED_DETCLOSED},",
				"          {Nmr Det Action Taken},",
				"          {Nmr Det Date Action Taken},",
				"          {Nmr Det Date Closed},",
				"          {Nmr Det Desc Of Def},",
				"          {Nmr Det Dispo},",
				"          {Nmr Det Line Creation Date},",
				"          {Nmr Det Oper Name},",
				"          {NMR Det Repair Action},",
				"          {Nmr Det Sn},",
				"          {Nmr Nmr Date Closed},",
				"          {NMR Number},",
				"          {NMR Originator},",
				"          {Nmr Parent Nmr},",
				"          {Nmr Parent Sn},",
				"          {Nmr Pgm},",
				"          {Nmr Pn},",
				"          {Nmr Pn Desc},",
				"          {Nmr Po Receipt Date},",
				"          {NMR RMA Line No},",
				"          {Nmr Sn},",
				"          {Nmr Warranty},",
				"          {Om Or Pc},",
				"          {Order Date},",
				"          {Order Type Name},",
				"          {Organization Code},",
				"          {Po Approved Date},",
				"          {PO Closed Date},",
				"          {Po Item Description},",
				"          {Po Line Creation Date},",
				"          {Po Line Number},",
				"          {Po Line Type},",
				"          {Po Revision Number},",
				"          {PO Unit Price},",
				"          {Po Warranty Status},",
				"          Preparer,",
				"          {Price List},",
				"          {Product Line},",
				"          {Promised Date},",
				"          {Quantity Shipped},",
				"          {DRO Receive Date},",
				"          {Received from Vendor Date},",
				"          {Repair Item Serial Number},",
				"          {Repair Line Id},",
				"          {Repair Number},",
				"          {Repair Order Closed Date},",
				"          {Repair Order Creation Date},",
				"          {Repair Order Project},",
				"          {Repair Order Promised Date},",
				"          {Repair Order Task},",
				"          {Repair Owner Name},",
				"          {Repair Quantity},",
				"          {Repair Reason},",
				"          {Repair Status},",
				"          {Repair Type},",
				"          {Repair Type Reference},",
				"          {Complete Date},",
				"          {Repair$Actual Repair Price},",
				"          {Actual Start Date},",
				"          {Repair$Metric Completion Date},",
				"          {Repair$Tat Adj},",
				"          {Repair$Tat Adj Reason},",
				"          {Repair$Vendor Name},",
				"          {Report Symptom},",
				"          {Req Create Date},",
				"          {Requested Date},",
				"          {Requisition Approval Date},",
				"          {Requisition Created By},",
				"          {Requisition Line Number},",
				"          {Requisition Number},",
				"          {Rma Creation Date},",
				"          {RMA Nbr/Order Nbr},",
				"          {RTV Hold End Date},",
				"          {RTV Hold Start Date},",
				"          {RTV PO Number},",
				"          {RTV Supplier SN},",
				"          {Salesforce Num},",
				"          {Scheduled Ship Date},",
				"          {Service Request Number},",
				"          {Ship Date},",
				"          {Ship From Location},",
				"          {Ship To Address1},",
				"          {Ship To City},",
				"          {Ship To Country},",
				"          {Ship To Customer Name},",
				"          {Ship To Location},",
				"          {Ship To State},",
				"          {Shipped from Vendor Date},",
				"          {Shipped Quantity},",
				"          {Sold To Customer Name},",
				"          {Sr Group Name},",
				"          {Sr Item Serial Number},",
				"          {Sr Owner Name},",
				"          {Sr Status},",
				"          {Time In Hold Status},",
				"          {Time In Open Status},",
				"          {Time In Repair},",
				"          {Times Returned},",
				"          {Total Actual Amount},",
				"          {Total Estimate Amount},",
				"          {Unit Selling Price},",
				"          {Vendor Hold Time},",
				"          {Vendor Pn},",
				"          {Vendor Repair Time},",
				"          {Vendor RMA},",
				"          {ViaSat NMR},",
				"          {ViaSat Parent RMA},",
				"          {ViaSat RMA},",
				"          {Warehouse Code},",
				"          {Warranty Status},",
				"          {RMA Received Date},",
				"          {Nmr Det Def Desc},",
				"          {Right_NMR Det Repair Action},",
				"          {Task Number2},",
				"          {Unit Selling Price OM},",
				"          {3PL RMA},",
				"          {RTV Ship Date},",
				"          {RTV Receipt Date},",
				"          {Cancelled Quantity},",
				"          {Line Cancelled Flag},",
				"          {Org Avg Item Cost},",
				"          DateBetweenDRO",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select1csv1",
				"inputcsv2datedimensions select(mapColumn(",
				"          Date,",
				"          MonthYear,",
				"          YearMonth,",
				"          LastDayOfMonth,",
				"          FiscalYearQuarter,",
				"          FiscalYear,",
				"          IsBusinessDay,",
				"          WeekEndingDate_Sunday",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select1csv2",
				"select1csv1, select1csv2 join(DateBetweenDRO == Date,",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join1csv1",
				"select2csv1 filter(IsBusinessDay >= 1) ~> filter1csv1",
				"filter1csv1 filter(dayOfWeek(DateBetweenDRO) != 1 && dayOfWeek(DateBetweenDRO) != 7) ~> filter2csv1",
				"filter2csv1 aggregate(groupBy({Actual Shipment Date},",
				"          {Actual Start Date},",
				"          {AMS Item Name},",
				"          {Approval Date},",
				"          {Arrived at Vendor Date},",
				"          {Avg Addl Funds},",
				"          {Business Area},",
				"          {Buyer Name},",
				"          {Closure Status},",
				"          {Complete Date},",
				"          {Concat_NMR Details},",
				"          {Contract Number},",
				"          {Contract Warranty End Date},",
				"          {Customer Name},",
				"          {Customer Po Number},",
				"          {DRO Po Number},",
				"          {DRO Receive Date},",
				"          {Failure Cause Code},",
				"          {Failure Date},",
				"          {Failure Site},",
				"          {Item Description},",
				"          {Item Number},",
				"          {Item Revision},",
				"          {Line Creation Date},",
				"          {Line Number},",
				"          {Line Quantity},",
				"          {Line Status},",
				"          {NMR Creation Date},",
				"          {Nmr Customer},",
				"          {NMR DATE CLOSED_DETCLOSED},",
				"          {Nmr Det Action Taken},",
				"          {Nmr Det Date Action Taken},",
				"          {Nmr Det Date Closed},",
				"          {Nmr Det Desc Of Def},",
				"          {Nmr Det Dispo},",
				"          {Nmr Det Line Creation Date},",
				"          {Nmr Det Oper Name},",
				"          {NMR Det Repair Action},",
				"          {Nmr Det Sn},",
				"          {Nmr Nmr Date Closed},",
				"          {NMR Number},",
				"          {NMR Originator},",
				"          {Nmr Parent Nmr},",
				"          {Nmr Parent Sn},",
				"          {Nmr Pgm},",
				"          {Repair$Vendor Name},",
				"          {Report Symptom},",
				"          {Req Create Date},",
				"          {Nmr Pn},",
				"          {Nmr Pn Desc},",
				"          {Nmr Po Receipt Date},",
				"          {NMR RMA Line No},",
				"          {Nmr Sn},",
				"          {Nmr Warranty},",
				"          Notes,",
				"          {Om Or Pc},",
				"          {Order Date},",
				"          {Order Type Name},",
				"          {Organization Code},",
				"          {Po Approved Date},",
				"          {Po Item Description},",
				"          {Po Line Creation Date},",
				"          {Po Line Number},",
				"          {Po Line Type},",
				"          {Po Revision Number},",
				"          {PO Unit Price},",
				"          {Po Warranty Status},",
				"          Preparer,",
				"          {Price List},",
				"          {Product Line},",
				"          {Promised Date},",
				"          {Quantity Shipped},",
				"          {Received from Vendor Date},",
				"          {Repair Item Serial Number},",
				"          {Repair Line Id},",
				"          {Repair Number},",
				"          {Repair Order Closed Date},",
				"          {Repair Order Creation Date},",
				"          {Repair Order Project},",
				"          {Repair Order Promised Date},",
				"          {Repair Order Task},",
				"          {Repair Owner Name},",
				"          {Repair Quantity},",
				"          {Repair Reason},",
				"          {Repair Status},",
				"          {Repair Type},",
				"          {Repair Type Reference},",
				"          {Repair$Actual Repair Price},",
				"          {Repair$Metric Completion Date},",
				"          {Repair$Tat Adj},",
				"          {Repair$Tat Adj Reason},",
				"          {RTV Ship Date},",
				"          {Requested Date},",
				"          {Requisition Approval Date},",
				"          {Requisition Created By},",
				"          {Requisition Line Number},",
				"          {Requisition Number},",
				"          {Rma Creation Date},",
				"          {RMA Nbr/Order Nbr},",
				"          {RTV Hold End Date},",
				"          {RTV Hold Start Date},",
				"          {RTV PO Number},",
				"          {RTV Supplier SN},",
				"          {Salesforce Num},",
				"          {Scheduled Ship Date},",
				"          {Service Request Number},",
				"          {Ship Date},",
				"          {Ship From Location},",
				"          {Ship To Address1},",
				"          {Ship To City},",
				"          {Ship To Country},",
				"          {Ship To Customer Name},",
				"          {Ship To Location},",
				"          {Ship To State},",
				"          {Shipped from Vendor Date},",
				"          {3PL RMA},",
				"          {RTV Receipt Date},",
				"          {Shipped Quantity},",
				"          {Sold To Customer Name},",
				"          {Sr Group Name},",
				"          {Sr Item Serial Number},",
				"          {Sr Owner Name},",
				"          {Sr Status},",
				"          {Time In Hold Status},",
				"          {Time In Open Status},",
				"          {Time In Repair},",
				"          {Times Returned},",
				"          {Total Actual Amount},",
				"          {Total Estimate Amount},",
				"          {Unit Selling Price},",
				"          {Vendor Hold Time},",
				"          {Vendor Pn},",
				"          {Vendor Repair Time},",
				"          {Vendor RMA},",
				"          {ViaSat NMR},",
				"          {ViaSat Parent RMA},",
				"          {ViaSat RMA},",
				"          {Warehouse Code},",
				"          {Warranty Status},",
				"          {PO Closed Date},",
				"          {Nmr Det Def Desc}),",
				"     Count = count({DRO TAT SHIP DATE})) ~> aggrcsv1",
				"aggrcsv1 select(mapColumn(",
				"          {Actual Shipment Date},",
				"          {Actual Start Date},",
				"          {AMS Item Name},",
				"          {Approval Date},",
				"          {Arrived at Vendor Date},",
				"          {Avg Addl Funds},",
				"          {Business Area},",
				"          {Buyer Name},",
				"          {Closure Status},",
				"          {Complete Date},",
				"          {Concat_NMR Details},",
				"          {Contract Number},",
				"          {Contract Warranty End Date},",
				"          {Customer Name},",
				"          {Customer Po Number},",
				"          {DRO Po Number},",
				"          {DRO Receive Date},",
				"          {Failure Cause Code},",
				"          {Failure Date},",
				"          {Failure Site},",
				"          {Item Description},",
				"          {Item Number},",
				"          {Item Revision},",
				"          {Line Creation Date},",
				"          {Line Number},",
				"          {Line Quantity},",
				"          {Line Status},",
				"          {NMR Creation Date},",
				"          {Nmr Customer},",
				"          {NMR DATE CLOSED_DETCLOSED},",
				"          {Nmr Det Action Taken},",
				"          {Nmr Det Date Action Taken},",
				"          {Nmr Det Date Closed},",
				"          {Nmr Det Desc Of Def},",
				"          {Nmr Det Dispo},",
				"          {Nmr Det Line Creation Date},",
				"          {Nmr Det Oper Name},",
				"          {NMR Det Repair Action},",
				"          {Nmr Det Sn},",
				"          {Nmr Nmr Date Closed},",
				"          {NMR Number},",
				"          {NMR Originator},",
				"          {Nmr Parent Nmr},",
				"          {Nmr Parent Sn},",
				"          {Nmr Pgm},",
				"          {Repair$Vendor Name},",
				"          {Report Symptom},",
				"          {Req Create Date},",
				"          {Nmr Pn},",
				"          {Nmr Pn Desc},",
				"          {Nmr Po Receipt Date},",
				"          {NMR RMA Line No},",
				"          {Nmr Sn},",
				"          {Nmr Warranty},",
				"          Notes,",
				"          {Om Or Pc},",
				"          {Order Date},",
				"          {Order Type Name},",
				"          {Organization Code},",
				"          {Po Approved Date},",
				"          {Po Item Description},",
				"          {Po Line Creation Date},",
				"          {Po Line Number},",
				"          {Po Line Type},",
				"          {Po Revision Number},",
				"          {PO Unit Price},",
				"          {Po Warranty Status},",
				"          Preparer,",
				"          {Price List},",
				"          {Product Line},",
				"          {Promised Date},",
				"          {Quantity Shipped},",
				"          {Received from Vendor Date},",
				"          {Repair Item Serial Number},",
				"          {Repair Line Id},",
				"          {Repair Number},",
				"          {Repair Order Closed Date},",
				"          {Repair Order Creation Date},",
				"          {Repair Order Project},",
				"          {Repair Order Promised Date},",
				"          {Repair Order Task},",
				"          {Repair Owner Name},",
				"          {Repair Quantity},",
				"          {Repair Reason},",
				"          {Repair Status},",
				"          {Repair Type},",
				"          {Repair Type Reference},",
				"          {Repair$Actual Repair Price},",
				"          {Repair$Metric Completion Date},",
				"          {Repair$Tat Adj},",
				"          {Repair$Tat Adj Reason},",
				"          {RTV Ship Date},",
				"          {Requested Date},",
				"          {Requisition Approval Date},",
				"          {Requisition Created By},",
				"          {Requisition Line Number},",
				"          {Requisition Number},",
				"          {Rma Creation Date},",
				"          {RMA Nbr/Order Nbr},",
				"          {RTV Hold End Date},",
				"          {RTV Hold Start Date},",
				"          {RTV PO Number},",
				"          {RTV Supplier SN},",
				"          {Salesforce Num},",
				"          {Scheduled Ship Date},",
				"          {Service Request Number},",
				"          {Ship Date},",
				"          {Ship From Location},",
				"          {Ship To Address1},",
				"          {Ship To City},",
				"          {Ship To Country},",
				"          {Ship To Customer Name},",
				"          {Ship To Location},",
				"          {Ship To State},",
				"          {Shipped from Vendor Date},",
				"          {3PL RMA},",
				"          {RTV Receipt Date},",
				"          {Shipped Quantity},",
				"          {Sold To Customer Name},",
				"          {Sr Group Name},",
				"          {Sr Item Serial Number},",
				"          {Sr Owner Name},",
				"          {Sr Status},",
				"          {Time In Hold Status},",
				"          {Time In Open Status},",
				"          {Time In Repair},",
				"          {Times Returned},",
				"          {Total Actual Amount},",
				"          {Total Estimate Amount},",
				"          {Unit Selling Price},",
				"          {Vendor Hold Time},",
				"          {Vendor Pn},",
				"          {Vendor Repair Time},",
				"          {Vendor RMA},",
				"          {ViaSat NMR},",
				"          {ViaSat Parent RMA},",
				"          {ViaSat RMA},",
				"          {Warehouse Code},",
				"          {Warranty Status},",
				"          {PO Closed Date},",
				"          {Nmr Det Def Desc},",
				"          {Age Bus Days (Start Date)} = Count",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select3csv1",
				"csv3split@split1input3 derive(DateBetweenDRO = toDate({DRO Receive Date})) ~> derclumn1csv3",
				"derclumn1csv3 derive(DateBetweenDRO = iif(DateBetweenDRO <= {DRO TAT SHIP DATE}, addDays((DateBetweenDRO),1),DateBetweenDRO)) ~> derclumn2csv3",
				"inputcsv1antennaP2output1 split(!(isNull({Actual Start Date})),",
				"     disjoint: false) ~> split1@(split1inputcsv1, split2inputcsv1)",
				"union1csv1 select(mapColumn(",
				"          {Actual Shipment Date},",
				"          {Actual Start Date},",
				"          {AMS Item Name},",
				"          {Approval Date},",
				"          {Arrived at Vendor Date},",
				"          {Avg Addl Funds},",
				"          {Business Area},",
				"          {Buyer Name},",
				"          {Closure Status},",
				"          {Complete Date},",
				"          {Concat_NMR Details},",
				"          {Contract Number},",
				"          {Contract Warranty End Date},",
				"          {Customer Name},",
				"          {Customer Po Number},",
				"          {DRO Po Number},",
				"          {DRO Receive Date},",
				"          {Failure Cause Code},",
				"          {Failure Date},",
				"          {Failure Site},",
				"          {Item Description},",
				"          {Item Number},",
				"          {Item Revision},",
				"          {Line Creation Date},",
				"          {Line Number},",
				"          {Line Quantity},",
				"          {Line Status},",
				"          {NMR Creation Date},",
				"          {Nmr Customer},",
				"          {NMR DATE CLOSED_DETCLOSED},",
				"          {Nmr Det Action Taken},",
				"          {Nmr Det Date Action Taken},",
				"          {Nmr Det Date Closed},",
				"          {Nmr Det Desc Of Def},",
				"          {Nmr Det Dispo},",
				"          {Nmr Det Line Creation Date},",
				"          {Nmr Det Oper Name},",
				"          {NMR Det Repair Action},",
				"          {Nmr Det Sn},",
				"          {Nmr Nmr Date Closed},",
				"          {NMR Number},",
				"          {NMR Originator},",
				"          {Nmr Parent Nmr},",
				"          {Nmr Parent Sn},",
				"          {Nmr Pgm},",
				"          {Repair$Vendor Name},",
				"          {Report Symptom},",
				"          {Req Create Date},",
				"          {Nmr Pn},",
				"          {Nmr Pn Desc},",
				"          {Nmr Po Receipt Date},",
				"          {NMR RMA Line No},",
				"          {Nmr Sn},",
				"          {Nmr Warranty},",
				"          Notes,",
				"          {Om Or Pc},",
				"          {Order Date},",
				"          {Order Type Name},",
				"          {Organization Code},",
				"          {Po Approved Date},",
				"          {Po Item Description},",
				"          {Po Line Creation Date},",
				"          {Po Line Number},",
				"          {Po Line Type},",
				"          {Po Revision Number},",
				"          {PO Unit Price},",
				"          {Po Warranty Status},",
				"          Preparer,",
				"          {Price List},",
				"          {Product Line},",
				"          {Promised Date},",
				"          {Quantity Shipped},",
				"          {Received from Vendor Date},",
				"          {Repair Item Serial Number},",
				"          {Repair Line Id},",
				"          {Repair Number},",
				"          {Repair Order Closed Date},",
				"          {Repair Order Creation Date},",
				"          {Repair Order Project},",
				"          {Repair Order Promised Date},",
				"          {Repair Order Task},",
				"          {Repair Owner Name},",
				"          {Repair Quantity},",
				"          {Repair Reason},",
				"          {Repair Status},",
				"          {Repair Type},",
				"          {Repair Type Reference},",
				"          {Repair$Actual Repair Price},",
				"          {Repair$Metric Completion Date},",
				"          {Repair$Tat Adj},",
				"          {Repair$Tat Adj Reason},",
				"          {RTV Ship Date},",
				"          {Requested Date},",
				"          {Requisition Approval Date},",
				"          {Requisition Created By},",
				"          {Requisition Line Number},",
				"          {Requisition Number},",
				"          {Rma Creation Date},",
				"          {RMA Nbr/Order Nbr},",
				"          {RTV Hold End Date},",
				"          {RTV Hold Start Date},",
				"          {RTV PO Number},",
				"          {RTV Supplier SN},",
				"          {Salesforce Num},",
				"          {Scheduled Ship Date},",
				"          {Service Request Number},",
				"          {Ship Date},",
				"          {Ship From Location},",
				"          {Ship To Address1},",
				"          {Ship To City},",
				"          {Ship To Country},",
				"          {Ship To Customer Name},",
				"          {Ship To Location},",
				"          {Ship To State},",
				"          {Shipped from Vendor Date},",
				"          {3PL RMA},",
				"          {RTV Receipt Date},",
				"          {Shipped Quantity},",
				"          {Sold To Customer Name},",
				"          {Sr Group Name},",
				"          {Sr Item Serial Number},",
				"          {Sr Owner Name},",
				"          {Sr Status},",
				"          {Time In Hold Status},",
				"          {Time In Open Status},",
				"          {Time In Repair},",
				"          {Times Returned},",
				"          {Total Actual Amount},",
				"          {Total Estimate Amount},",
				"          {Unit Selling Price},",
				"          {Vendor Hold Time},",
				"          {Vendor Pn},",
				"          {Vendor Repair Time},",
				"          {Vendor RMA},",
				"          {ViaSat NMR},",
				"          {ViaSat Parent RMA},",
				"          {ViaSat RMA},",
				"          {Warehouse Code},",
				"          {Warranty Status},",
				"          {PO Closed Date},",
				"          {Nmr Det Def Desc},",
				"          {DRO TAT SHIP DATE},",
				"          {RMA Received Date},",
				"          {Right_NMR Det Repair Action},",
				"          {Task Number2},",
				"          {Unit Selling Price OM},",
				"          {Cancelled Quantity},",
				"          {Line Cancelled Flag},",
				"          {Org Avg Item Cost},",
				"          {Repo Load Dttm},",
				"          {Age Bus Days (Start Date)}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select4csv1",
				"select3csv1, split1@split2inputcsv1 union(byName: true)~> union1csv1",
				"inputcsv3antennaP2output2 split(!(isNull({DRO Receive Date})),",
				"     disjoint: false) ~> csv3split@(split1input3, split2input3)",
				"derclumn2csv3 select(mapColumn(",
				"          {Actual Shipment Date},",
				"          {AMS Item Name},",
				"          {Approval Date},",
				"          {Arrived at Vendor Date},",
				"          {Avg Addl Funds},",
				"          {Business Area},",
				"          {Buyer Name},",
				"          {Closure Status},",
				"          {Concat_NMR Details},",
				"          {Contract Number},",
				"          {Contract Warranty End Date},",
				"          {Customer Name},",
				"          {Customer Po Number},",
				"          {DRO Po Number},",
				"          {DRO TAT SHIP DATE},",
				"          {Failure Cause Code},",
				"          {Failure Date},",
				"          {Failure Site},",
				"          {Item Description},",
				"          {Item Number},",
				"          {Item Revision},",
				"          {Line Creation Date},",
				"          {Line Number},",
				"          {Line Quantity},",
				"          {Line Status},",
				"          Notes,",
				"          {NMR Creation Date},",
				"          {Nmr Customer},",
				"          {NMR DATE CLOSED_DETCLOSED},",
				"          {Nmr Det Action Taken},",
				"          {Nmr Det Date Action Taken},",
				"          {Nmr Det Date Closed},",
				"          {Nmr Det Desc Of Def},",
				"          {Nmr Det Dispo},",
				"          {Nmr Det Line Creation Date},",
				"          {Nmr Det Oper Name},",
				"          {NMR Det Repair Action},",
				"          {Nmr Det Sn},",
				"          {Nmr Nmr Date Closed},",
				"          {NMR Number},",
				"          {NMR Originator},",
				"          {Nmr Parent Nmr},",
				"          {Nmr Parent Sn},",
				"          {Nmr Pgm},",
				"          {Nmr Pn},",
				"          {Nmr Pn Desc},",
				"          {Nmr Po Receipt Date},",
				"          {NMR RMA Line No},",
				"          {Nmr Sn},",
				"          {Nmr Warranty},",
				"          {Om Or Pc},",
				"          {Order Date},",
				"          {Order Type Name},",
				"          {Organization Code},",
				"          {Po Approved Date},",
				"          {PO Closed Date},",
				"          {Po Item Description},",
				"          {Po Line Creation Date},",
				"          {Po Line Number},",
				"          {Po Line Type},",
				"          {Po Revision Number},",
				"          {PO Unit Price},",
				"          {Po Warranty Status},",
				"          Preparer,",
				"          {Price List},",
				"          {Product Line},",
				"          {Promised Date},",
				"          {Quantity Shipped},",
				"          {DRO Receive Date},",
				"          {Received from Vendor Date},",
				"          {Repair Item Serial Number},",
				"          {Repair Line Id},",
				"          {Repair Number},",
				"          {Repair Order Closed Date},",
				"          {Repair Order Creation Date},",
				"          {Repair Order Project},",
				"          {Repair Order Promised Date},",
				"          {Repair Order Task},",
				"          {Repair Owner Name},",
				"          {Repair Quantity},",
				"          {Repair Reason},",
				"          {Repair Status},",
				"          {Repair Type},",
				"          {Repair Type Reference},",
				"          {Complete Date},",
				"          {Repair$Actual Repair Price},",
				"          {Actual Start Date},",
				"          {Repair$Metric Completion Date},",
				"          {Repair$Tat Adj},",
				"          {Repair$Tat Adj Reason},",
				"          {Repair$Vendor Name},",
				"          {Report Symptom},",
				"          {Req Create Date},",
				"          {Requested Date},",
				"          {Requisition Approval Date},",
				"          {Requisition Created By},",
				"          {Requisition Line Number},",
				"          {Requisition Number},",
				"          {Rma Creation Date},",
				"          {RMA Nbr/Order Nbr},",
				"          {RTV Hold End Date},",
				"          {RTV Hold Start Date},",
				"          {RTV PO Number},",
				"          {RTV Supplier SN},",
				"          {Salesforce Num},",
				"          {Scheduled Ship Date},",
				"          {Service Request Number},",
				"          {Ship Date},",
				"          {Ship From Location},",
				"          {Ship To Address1},",
				"          {Ship To City},",
				"          {Ship To Country},",
				"          {Ship To Customer Name},",
				"          {Ship To Location},",
				"          {Ship To State},",
				"          {Shipped from Vendor Date},",
				"          {Shipped Quantity},",
				"          {Sold To Customer Name},",
				"          {Sr Group Name},",
				"          {Sr Item Serial Number},",
				"          {Sr Owner Name},",
				"          {Sr Status},",
				"          {Time In Hold Status},",
				"          {Time In Open Status},",
				"          {Time In Repair},",
				"          {Times Returned},",
				"          {Total Actual Amount},",
				"          {Total Estimate Amount},",
				"          {Unit Selling Price},",
				"          {Vendor Hold Time},",
				"          {Vendor Pn},",
				"          {Vendor Repair Time},",
				"          {Vendor RMA},",
				"          {ViaSat NMR},",
				"          {ViaSat Parent RMA},",
				"          {ViaSat RMA},",
				"          {Warehouse Code},",
				"          {Warranty Status},",
				"          {RMA Received Date},",
				"          {Nmr Det Def Desc},",
				"          {Right_NMR Det Repair Action},",
				"          {Task Number2},",
				"          {Unit Selling Price OM},",
				"          {3PL RMA},",
				"          {RTV Ship Date},",
				"          {RTV Receipt Date},",
				"          {Cancelled Quantity},",
				"          {Line$Acceptance Point},",
				"          {Line Cancelled Flag},",
				"          {Org Avg Item Cost},",
				"          {Repo Load Dttm},",
				"          DateBetweenDRO",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select1csv3",
				"select1csv3, select1csv2 join(DateBetweenDRO == Date,",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join1csv3",
				"join1csv3 select(mapColumn(",
				"          {Actual Shipment Date},",
				"          {AMS Item Name},",
				"          {Approval Date},",
				"          {Arrived at Vendor Date},",
				"          {Avg Addl Funds},",
				"          {Business Area},",
				"          {Buyer Name},",
				"          {Closure Status},",
				"          {Concat_NMR Details},",
				"          {Contract Number},",
				"          {Contract Warranty End Date},",
				"          {Customer Name},",
				"          {Customer Po Number},",
				"          {DRO Po Number},",
				"          {DRO TAT SHIP DATE},",
				"          {Failure Cause Code},",
				"          {Failure Date},",
				"          {Failure Site},",
				"          {Item Description},",
				"          {Item Number},",
				"          {Item Revision},",
				"          {Line Creation Date},",
				"          {Line Number},",
				"          {Line Quantity},",
				"          {Line Status},",
				"          Notes,",
				"          {NMR Creation Date},",
				"          {Nmr Customer},",
				"          {NMR DATE CLOSED_DETCLOSED},",
				"          {Nmr Det Action Taken},",
				"          {Nmr Det Date Action Taken},",
				"          {Nmr Det Date Closed},",
				"          {Nmr Det Desc Of Def},",
				"          {Nmr Det Dispo},",
				"          {Nmr Det Line Creation Date},",
				"          {Nmr Det Oper Name},",
				"          {NMR Det Repair Action},",
				"          {Nmr Det Sn},",
				"          {Nmr Nmr Date Closed},",
				"          {NMR Number},",
				"          {NMR Originator},",
				"          {Nmr Parent Nmr},",
				"          {Nmr Parent Sn},",
				"          {Nmr Pgm},",
				"          {Nmr Pn},",
				"          {Nmr Pn Desc},",
				"          {Nmr Po Receipt Date},",
				"          {NMR RMA Line No},",
				"          {Nmr Sn},",
				"          {Nmr Warranty},",
				"          {Om Or Pc},",
				"          {Order Date},",
				"          {Order Type Name},",
				"          {Organization Code},",
				"          {Po Approved Date},",
				"          {PO Closed Date},",
				"          {Po Item Description},",
				"          {Po Line Creation Date},",
				"          {Po Line Number},",
				"          {Po Line Type},",
				"          {Po Revision Number},",
				"          {PO Unit Price},",
				"          {Po Warranty Status},",
				"          Preparer,",
				"          {Price List},",
				"          {Product Line},",
				"          {Promised Date},",
				"          {Quantity Shipped},",
				"          {DRO Receive Date},",
				"          {Received from Vendor Date},",
				"          {Repair Item Serial Number},",
				"          {Repair Line Id},",
				"          {Repair Number},",
				"          {Repair Order Closed Date},",
				"          {Repair Order Creation Date},",
				"          {Repair Order Project},",
				"          {Repair Order Promised Date},",
				"          {Repair Order Task},",
				"          {Repair Owner Name},",
				"          {Repair Quantity},",
				"          {Repair Reason},",
				"          {Repair Status},",
				"          {Repair Type},",
				"          {Repair Type Reference},",
				"          {Complete Date},",
				"          {Repair$Actual Repair Price},",
				"          {Actual Start Date},",
				"          {Repair$Metric Completion Date},",
				"          {Repair$Tat Adj},",
				"          {Repair$Tat Adj Reason},",
				"          {Repair$Vendor Name},",
				"          {Report Symptom},",
				"          {Req Create Date},",
				"          {Requested Date},",
				"          {Requisition Approval Date},",
				"          {Requisition Created By},",
				"          {Requisition Line Number},",
				"          {Requisition Number},",
				"          {Rma Creation Date},",
				"          {RMA Nbr/Order Nbr},",
				"          {RTV Hold End Date},",
				"          {RTV Hold Start Date},",
				"          {RTV PO Number},",
				"          {RTV Supplier SN},",
				"          {Salesforce Num},",
				"          {Scheduled Ship Date},",
				"          {Service Request Number},",
				"          {Ship Date},",
				"          {Ship From Location},",
				"          {Ship To Address1},",
				"          {Ship To City},",
				"          {Ship To Country},",
				"          {Ship To Customer Name},",
				"          {Ship To Location},",
				"          {Ship To State},",
				"          {Shipped from Vendor Date},",
				"          {Shipped Quantity},",
				"          {Sold To Customer Name},",
				"          {Sr Group Name},",
				"          {Sr Item Serial Number},",
				"          {Sr Owner Name},",
				"          {Sr Status},",
				"          {Time In Hold Status},",
				"          {Time In Open Status},",
				"          {Time In Repair},",
				"          {Times Returned},",
				"          {Total Actual Amount},",
				"          {Total Estimate Amount},",
				"          {Unit Selling Price},",
				"          {Vendor Hold Time},",
				"          {Vendor Pn},",
				"          {Vendor Repair Time},",
				"          {Vendor RMA},",
				"          {ViaSat NMR},",
				"          {ViaSat Parent RMA},",
				"          {ViaSat RMA},",
				"          {Warehouse Code},",
				"          {Warranty Status},",
				"          {RMA Received Date},",
				"          {Nmr Det Def Desc},",
				"          {Right_NMR Det Repair Action},",
				"          {Task Number2},",
				"          {Unit Selling Price OM},",
				"          {3PL RMA},",
				"          {RTV Ship Date},",
				"          {RTV Receipt Date},",
				"          {Cancelled Quantity},",
				"          {Line$Acceptance Point},",
				"          {Line Cancelled Flag},",
				"          {Org Avg Item Cost},",
				"          {Repo Load Dttm},",
				"          DateBetweenDRO,",
				"          Date,",
				"          MonthYear,",
				"          YearMonth,",
				"          LastDayOfMonth,",
				"          FiscalYearQuarter,",
				"          FiscalYear,",
				"          IsBusinessDay,",
				"          WeekEndingDate_Sunday",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select2csv3",
				"select2csv3 filter(IsBusinessDay>=1) ~> filter1csv3",
				"filter1csv3 filter(dayOfWeek(DateBetweenDRO) != 1 && dayOfWeek(DateBetweenDRO) != 7) ~> filter2csv3",
				"filter2csv3 aggregate(groupBy({Actual Shipment Date},",
				"          {Actual Start Date},",
				"          {AMS Item Name},",
				"          {Approval Date},",
				"          {Arrived at Vendor Date},",
				"          {Avg Addl Funds},",
				"          {Business Area},",
				"          {Buyer Name},",
				"          {Closure Status},",
				"          {Complete Date},",
				"          {Concat_NMR Details},",
				"          {Contract Number},",
				"          {Contract Warranty End Date},",
				"          {Customer Name},",
				"          {Customer Po Number},",
				"          {DRO Po Number},",
				"          {DRO Receive Date},",
				"          {Failure Cause Code},",
				"          {Failure Date},",
				"          {Failure Site},",
				"          {Item Description},",
				"          {Item Number},",
				"          {Item Revision},",
				"          {Line Creation Date},",
				"          {Line Number},",
				"          {Line Quantity},",
				"          {Line Status},",
				"          {NMR Creation Date},",
				"          {Nmr Customer},",
				"          {NMR DATE CLOSED_DETCLOSED},",
				"          {Nmr Det Action Taken},",
				"          {Nmr Det Date Action Taken},",
				"          {Nmr Det Date Closed},",
				"          {Nmr Det Desc Of Def},",
				"          {Nmr Det Dispo},",
				"          {Nmr Det Line Creation Date},",
				"          {Nmr Det Oper Name},",
				"          {NMR Det Repair Action},",
				"          {Nmr Det Sn},",
				"          {Nmr Nmr Date Closed},",
				"          {NMR Number},",
				"          {NMR Originator},",
				"          {Nmr Parent Nmr},",
				"          {Nmr Parent Sn},",
				"          {Nmr Pgm},",
				"          {Nmr Pn},",
				"          {Nmr Pn Desc},",
				"          {Nmr Po Receipt Date},",
				"          {NMR RMA Line No},",
				"          {Nmr Sn},",
				"          {Nmr Warranty},",
				"          Notes,",
				"          {Om Or Pc},",
				"          {Order Date},",
				"          {Order Type Name},",
				"          {Organization Code},",
				"          {Po Approved Date},",
				"          {Po Item Description},",
				"          {Po Line Creation Date},",
				"          {Po Line Number},",
				"          {Po Line Type},",
				"          {Po Revision Number},",
				"          {PO Unit Price},",
				"          {Po Warranty Status},",
				"          Preparer,",
				"          {Price List},",
				"          {Product Line},",
				"          {Promised Date},",
				"          {Quantity Shipped},",
				"          {Received from Vendor Date},",
				"          {Repair Item Serial Number},",
				"          {Repair Line Id},",
				"          {Repair Number},",
				"          {Repair Order Closed Date},",
				"          {Repair Order Creation Date},",
				"          {Repair Order Project},",
				"          {Repair Order Promised Date},",
				"          {Repair Order Task},",
				"          {Repair Owner Name},",
				"          {Repair Quantity},",
				"          {Repair Reason},",
				"          {Repair Status},",
				"          {Repair Type},",
				"          {Repair Type Reference},",
				"          {Repair$Actual Repair Price},",
				"          {Repair$Metric Completion Date},",
				"          {Repair$Tat Adj},",
				"          {Repair$Tat Adj Reason},",
				"          {Repair$Vendor Name},",
				"          {Report Symptom},",
				"          {Req Create Date},",
				"          {Requested Date},",
				"          {Requisition Approval Date},",
				"          {Requisition Created By},",
				"          {Requisition Line Number},",
				"          {Requisition Number},",
				"          {Rma Creation Date},",
				"          {RMA Nbr/Order Nbr},",
				"          {RTV Hold End Date},",
				"          {RTV Hold Start Date},",
				"          {RTV PO Number},",
				"          {RTV Supplier SN},",
				"          {Salesforce Num},",
				"          {Scheduled Ship Date},",
				"          {Service Request Number},",
				"          {Ship Date},",
				"          {Ship From Location},",
				"          {Ship To Address1},",
				"          {Ship To City},",
				"          {Ship To Country},",
				"          {Ship To Customer Name},",
				"          {Ship To Location},",
				"          {Ship To State},",
				"          {Shipped from Vendor Date},",
				"          {Shipped Quantity},",
				"          {Sold To Customer Name},",
				"          {Sr Group Name},",
				"          {Sr Item Serial Number},",
				"          {Sr Owner Name},",
				"          {Sr Status},",
				"          {Time In Hold Status},",
				"          {Time In Open Status},",
				"          {Time In Repair},",
				"          {Times Returned},",
				"          {Total Actual Amount},",
				"          {Total Estimate Amount},",
				"          {Unit Selling Price},",
				"          {Vendor Hold Time},",
				"          {Vendor Pn},",
				"          {Vendor Repair Time},",
				"          {Vendor RMA},",
				"          {ViaSat NMR},",
				"          {ViaSat Parent RMA},",
				"          {ViaSat RMA},",
				"          {Warehouse Code},",
				"          {Warranty Status},",
				"          {PO Closed Date},",
				"          {Nmr Det Def Desc},",
				"          {3PL RMA},",
				"          {RTV Ship Date},",
				"          {RTV Receipt Date}),",
				"     Count = count({DRO TAT SHIP DATE})) ~> aggregate2",
				"aggregate2 select(mapColumn(",
				"          {Actual Shipment Date},",
				"          {Actual Start Date},",
				"          {AMS Item Name},",
				"          {Approval Date},",
				"          {Arrived at Vendor Date},",
				"          {Avg Addl Funds},",
				"          {Business Area},",
				"          {Buyer Name},",
				"          {Closure Status},",
				"          {Complete Date},",
				"          {Concat_NMR Details},",
				"          {Contract Number},",
				"          {Contract Warranty End Date},",
				"          {Customer Name},",
				"          {Customer Po Number},",
				"          {DRO Po Number},",
				"          {DRO Receive Date},",
				"          {Failure Cause Code},",
				"          {Failure Date},",
				"          {Failure Site},",
				"          {Item Description},",
				"          {Item Number},",
				"          {Item Revision},",
				"          {Line Creation Date},",
				"          {Line Number},",
				"          {Line Quantity},",
				"          {Line Status},",
				"          {NMR Creation Date},",
				"          {Nmr Customer},",
				"          {NMR DATE CLOSED_DETCLOSED},",
				"          {Nmr Det Action Taken},",
				"          {Nmr Det Date Action Taken},",
				"          {Nmr Det Date Closed},",
				"          {Nmr Det Desc Of Def},",
				"          {Nmr Det Dispo},",
				"          {Nmr Det Line Creation Date},",
				"          {Nmr Det Oper Name},",
				"          {NMR Det Repair Action},",
				"          {Nmr Det Sn},",
				"          {Nmr Nmr Date Closed},",
				"          {NMR Number},",
				"          {NMR Originator},",
				"          {Nmr Parent Nmr},",
				"          {Nmr Parent Sn},",
				"          {Nmr Pgm},",
				"          {Nmr Pn},",
				"          {Nmr Pn Desc},",
				"          {Nmr Po Receipt Date},",
				"          {NMR RMA Line No},",
				"          {Nmr Sn},",
				"          {Nmr Warranty},",
				"          Notes,",
				"          {Om Or Pc},",
				"          {Order Date},",
				"          {Order Type Name},",
				"          {Organization Code},",
				"          {Po Approved Date},",
				"          {Po Item Description},",
				"          {Po Line Creation Date},",
				"          {Po Line Number},",
				"          {Po Line Type},",
				"          {Po Revision Number},",
				"          {PO Unit Price},",
				"          {Po Warranty Status},",
				"          Preparer,",
				"          {Price List},",
				"          {Product Line},",
				"          {Promised Date},",
				"          {Quantity Shipped},",
				"          {Received from Vendor Date},",
				"          {Repair Item Serial Number},",
				"          {Repair Line Id},",
				"          {Repair Number},",
				"          {Repair Order Closed Date},",
				"          {Repair Order Creation Date},",
				"          {Repair Order Project},",
				"          {Repair Order Promised Date},",
				"          {Repair Order Task},",
				"          {Repair Owner Name},",
				"          {Repair Quantity},",
				"          {Repair Reason},",
				"          {Repair Status},",
				"          {Repair Type},",
				"          {Repair Type Reference},",
				"          {Repair$Actual Repair Price},",
				"          {Repair$Metric Completion Date},",
				"          {Repair$Tat Adj},",
				"          {Repair$Tat Adj Reason},",
				"          {Repair$Vendor Name},",
				"          {Report Symptom},",
				"          {Req Create Date},",
				"          {Requested Date},",
				"          {Requisition Approval Date},",
				"          {Requisition Created By},",
				"          {Requisition Line Number},",
				"          {Requisition Number},",
				"          {Rma Creation Date},",
				"          {RMA Nbr/Order Nbr},",
				"          {RTV Hold End Date},",
				"          {RTV Hold Start Date},",
				"          {RTV PO Number},",
				"          {RTV Supplier SN},",
				"          {Salesforce Num},",
				"          {Scheduled Ship Date},",
				"          {Service Request Number},",
				"          {Ship Date},",
				"          {Ship From Location},",
				"          {Ship To Address1},",
				"          {Ship To City},",
				"          {Ship To Country},",
				"          {Ship To Customer Name},",
				"          {Ship To Location},",
				"          {Ship To State},",
				"          {Shipped from Vendor Date},",
				"          {Shipped Quantity},",
				"          {Sold To Customer Name},",
				"          {Sr Group Name},",
				"          {Sr Item Serial Number},",
				"          {Sr Owner Name},",
				"          {Sr Status},",
				"          {Time In Hold Status},",
				"          {Time In Open Status},",
				"          {Time In Repair},",
				"          {Times Returned},",
				"          {Total Actual Amount},",
				"          {Total Estimate Amount},",
				"          {Unit Selling Price},",
				"          {Vendor Hold Time},",
				"          {Vendor Pn},",
				"          {Vendor Repair Time},",
				"          {Vendor RMA},",
				"          {ViaSat NMR},",
				"          {ViaSat Parent RMA},",
				"          {ViaSat RMA},",
				"          {Warehouse Code},",
				"          {Warranty Status},",
				"          {PO Closed Date},",
				"          {Nmr Det Def Desc},",
				"          {3PL RMA},",
				"          {RTV Ship Date},",
				"          {RTV Receipt Date},",
				"          {Age Bus Days (Rcvd Date)} = Count",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select3csv3",
				"select3csv3, csv3split@split2input3 union(byName: true)~> union1csv3",
				"union1csv3 select(mapColumn(",
				"          {Actual Shipment Date},",
				"          {Actual Start Date},",
				"          {AMS Item Name},",
				"          {Approval Date},",
				"          {Arrived at Vendor Date},",
				"          {Avg Addl Funds},",
				"          {Business Area},",
				"          {Buyer Name},",
				"          {Closure Status},",
				"          {Complete Date},",
				"          {Concat_NMR Details},",
				"          {Contract Number},",
				"          {Contract Warranty End Date},",
				"          {Customer Name},",
				"          {Customer Po Number},",
				"          {DRO Po Number},",
				"          {DRO Receive Date},",
				"          {Failure Cause Code},",
				"          {Failure Date},",
				"          {Failure Site},",
				"          {Item Description},",
				"          {Item Number},",
				"          {Item Revision},",
				"          {Line Creation Date},",
				"          {Line Number},",
				"          {Line Quantity},",
				"          {Line Status},",
				"          {NMR Creation Date},",
				"          {Nmr Customer},",
				"          {NMR DATE CLOSED_DETCLOSED},",
				"          {Nmr Det Action Taken},",
				"          {Nmr Det Date Action Taken},",
				"          {Nmr Det Date Closed},",
				"          {Nmr Det Desc Of Def},",
				"          {Nmr Det Dispo},",
				"          {Nmr Det Line Creation Date},",
				"          {Nmr Det Oper Name},",
				"          {NMR Det Repair Action},",
				"          {Nmr Det Sn},",
				"          {Nmr Nmr Date Closed},",
				"          {NMR Number},",
				"          {NMR Originator},",
				"          {Nmr Parent Nmr},",
				"          {Nmr Parent Sn},",
				"          {Nmr Pgm},",
				"          {Nmr Pn},",
				"          {Nmr Pn Desc},",
				"          {Nmr Po Receipt Date},",
				"          {NMR RMA Line No},",
				"          {Nmr Sn},",
				"          {Nmr Warranty},",
				"          Notes,",
				"          {Om Or Pc},",
				"          {Order Date},",
				"          {Order Type Name},",
				"          {Organization Code},",
				"          {Po Approved Date},",
				"          {Po Item Description},",
				"          {Po Line Creation Date},",
				"          {Po Line Number},",
				"          {Po Line Type},",
				"          {Po Revision Number},",
				"          {PO Unit Price},",
				"          {Po Warranty Status},",
				"          Preparer,",
				"          {Price List},",
				"          {Product Line},",
				"          {Promised Date},",
				"          {Quantity Shipped},",
				"          {Received from Vendor Date},",
				"          {Repair Item Serial Number},",
				"          {Repair Line Id},",
				"          {Repair Number},",
				"          {Repair Order Closed Date},",
				"          {Repair Order Creation Date},",
				"          {Repair Order Project},",
				"          {Repair Order Promised Date},",
				"          {Repair Order Task},",
				"          {Repair Owner Name},",
				"          {Repair Quantity},",
				"          {Repair Reason},",
				"          {Repair Status},",
				"          {Repair Type},",
				"          {Repair Type Reference},",
				"          {Repair$Actual Repair Price},",
				"          {Repair$Metric Completion Date},",
				"          {Repair$Tat Adj},",
				"          {Repair$Tat Adj Reason},",
				"          {Repair$Vendor Name},",
				"          {Report Symptom},",
				"          {Req Create Date},",
				"          {Requested Date},",
				"          {Requisition Approval Date},",
				"          {Requisition Created By},",
				"          {Requisition Line Number},",
				"          {Requisition Number},",
				"          {Rma Creation Date},",
				"          {RMA Nbr/Order Nbr},",
				"          {RTV Hold End Date},",
				"          {RTV Hold Start Date},",
				"          {RTV PO Number},",
				"          {RTV Supplier SN},",
				"          {Salesforce Num},",
				"          {Scheduled Ship Date},",
				"          {Service Request Number},",
				"          {Ship Date},",
				"          {Ship From Location},",
				"          {Ship To Address1},",
				"          {Ship To City},",
				"          {Ship To Country},",
				"          {Ship To Customer Name},",
				"          {Ship To Location},",
				"          {Ship To State},",
				"          {Shipped from Vendor Date},",
				"          {Shipped Quantity},",
				"          {Sold To Customer Name},",
				"          {Sr Group Name},",
				"          {Sr Item Serial Number},",
				"          {Sr Owner Name},",
				"          {Sr Status},",
				"          {Time In Hold Status},",
				"          {Time In Open Status},",
				"          {Time In Repair},",
				"          {Times Returned},",
				"          {Total Actual Amount},",
				"          {Total Estimate Amount},",
				"          {Unit Selling Price},",
				"          {Vendor Hold Time},",
				"          {Vendor Pn},",
				"          {Vendor Repair Time},",
				"          {Vendor RMA},",
				"          {ViaSat NMR},",
				"          {ViaSat Parent RMA},",
				"          {ViaSat RMA},",
				"          {Warehouse Code},",
				"          {Warranty Status},",
				"          {PO Closed Date},",
				"          {Nmr Det Def Desc},",
				"          {3PL RMA},",
				"          {RTV Ship Date},",
				"          {RTV Receipt Date},",
				"          {Age Bus Days (Rcvd Date)},",
				"          {DRO TAT SHIP DATE},",
				"          {RMA Received Date},",
				"          {Right_NMR Det Repair Action},",
				"          {Task Number2},",
				"          {Unit Selling Price OM},",
				"          {Cancelled Quantity},",
				"          {Line Cancelled Flag},",
				"          {Org Avg Item Cost}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select4csv3",
				"join1csv1 select(mapColumn(",
				"          {Actual Shipment Date},",
				"          {AMS Item Name},",
				"          {Approval Date},",
				"          {Arrived at Vendor Date},",
				"          {Avg Addl Funds},",
				"          {Business Area},",
				"          {Buyer Name},",
				"          {Closure Status},",
				"          {Concat_NMR Details},",
				"          {Contract Number},",
				"          {Contract Warranty End Date},",
				"          {Customer Name},",
				"          {Customer Po Number},",
				"          {DRO Po Number},",
				"          {DRO TAT SHIP DATE},",
				"          {Failure Cause Code},",
				"          {Failure Date},",
				"          {Failure Site},",
				"          {Item Description},",
				"          {Item Number},",
				"          {Item Revision},",
				"          {Line Creation Date},",
				"          {Line Number},",
				"          {Line Quantity},",
				"          {Line Status},",
				"          Notes,",
				"          {NMR Creation Date},",
				"          {Nmr Customer},",
				"          {NMR DATE CLOSED_DETCLOSED},",
				"          {Nmr Det Action Taken},",
				"          {Nmr Det Date Action Taken},",
				"          {Nmr Det Date Closed},",
				"          {Nmr Det Desc Of Def},",
				"          {Nmr Det Dispo},",
				"          {Nmr Det Line Creation Date},",
				"          {Nmr Det Oper Name},",
				"          {NMR Det Repair Action},",
				"          {Nmr Det Sn},",
				"          {Nmr Nmr Date Closed},",
				"          {NMR Number},",
				"          {NMR Originator},",
				"          {Nmr Parent Nmr},",
				"          {Nmr Parent Sn},",
				"          {Nmr Pgm},",
				"          {Nmr Pn},",
				"          {Nmr Pn Desc},",
				"          {Nmr Po Receipt Date},",
				"          {NMR RMA Line No},",
				"          {Nmr Sn},",
				"          {Nmr Warranty},",
				"          {Om Or Pc},",
				"          {Order Date},",
				"          {Order Type Name},",
				"          {Organization Code},",
				"          {Po Approved Date},",
				"          {PO Closed Date},",
				"          {Po Item Description},",
				"          {Po Line Creation Date},",
				"          {Po Line Number},",
				"          {Po Line Type},",
				"          {Po Revision Number},",
				"          {PO Unit Price},",
				"          {Po Warranty Status},",
				"          Preparer,",
				"          {Price List},",
				"          {Product Line},",
				"          {Promised Date},",
				"          {Quantity Shipped},",
				"          {DRO Receive Date},",
				"          {Received from Vendor Date},",
				"          {Repair Item Serial Number},",
				"          {Repair Line Id},",
				"          {Repair Number},",
				"          {Repair Order Closed Date},",
				"          {Repair Order Creation Date},",
				"          {Repair Order Project},",
				"          {Repair Order Promised Date},",
				"          {Repair Order Task},",
				"          {Repair Owner Name},",
				"          {Repair Quantity},",
				"          {Repair Reason},",
				"          {Repair Status},",
				"          {Repair Type},",
				"          {Repair Type Reference},",
				"          {Complete Date},",
				"          {Repair$Actual Repair Price},",
				"          {Actual Start Date},",
				"          {Repair$Metric Completion Date},",
				"          {Repair$Tat Adj},",
				"          {Repair$Tat Adj Reason},",
				"          {Repair$Vendor Name},",
				"          {Report Symptom},",
				"          {Req Create Date},",
				"          {Requested Date},",
				"          {Requisition Approval Date},",
				"          {Requisition Created By},",
				"          {Requisition Line Number},",
				"          {Requisition Number},",
				"          {Rma Creation Date},",
				"          {RMA Nbr/Order Nbr},",
				"          {RTV Hold End Date},",
				"          {RTV Hold Start Date},",
				"          {RTV PO Number},",
				"          {RTV Supplier SN},",
				"          {Salesforce Num},",
				"          {Scheduled Ship Date},",
				"          {Service Request Number},",
				"          {Ship Date},",
				"          {Ship From Location},",
				"          {Ship To Address1},",
				"          {Ship To City},",
				"          {Ship To Country},",
				"          {Ship To Customer Name},",
				"          {Ship To Location},",
				"          {Ship To State},",
				"          {Shipped from Vendor Date},",
				"          {Shipped Quantity},",
				"          {Sold To Customer Name},",
				"          {Sr Group Name},",
				"          {Sr Item Serial Number},",
				"          {Sr Owner Name},",
				"          {Sr Status},",
				"          {Time In Hold Status},",
				"          {Time In Open Status},",
				"          {Time In Repair},",
				"          {Times Returned},",
				"          {Total Actual Amount},",
				"          {Total Estimate Amount},",
				"          {Unit Selling Price},",
				"          {Vendor Hold Time},",
				"          {Vendor Pn},",
				"          {Vendor Repair Time},",
				"          {Vendor RMA},",
				"          {ViaSat NMR},",
				"          {ViaSat Parent RMA},",
				"          {ViaSat RMA},",
				"          {Warehouse Code},",
				"          {Warranty Status},",
				"          {RMA Received Date},",
				"          {Nmr Det Def Desc},",
				"          {Right_NMR Det Repair Action},",
				"          {Task Number2},",
				"          {Unit Selling Price OM},",
				"          {3PL RMA},",
				"          {RTV Ship Date},",
				"          {RTV Receipt Date},",
				"          {Cancelled Quantity},",
				"          {Line Cancelled Flag},",
				"          {Org Avg Item Cost},",
				"          DateBetweenDRO,",
				"          Date,",
				"          MonthYear,",
				"          YearMonth,",
				"          LastDayOfMonth,",
				"          FiscalYearQuarter,",
				"          FiscalYear,",
				"          IsBusinessDay,",
				"          WeekEndingDate_Sunday",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select2csv1",
				"select4csv1, select4csv3 join(select4csv1@{RMA Nbr/Order Nbr} == select4csv3@{RMA Nbr/Order Nbr}",
				"     && select4csv1@{NMR Number} == select4csv3@{NMR Number},",
				"     joinType:'outer',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join2csv1",
				"join2csv1 select(mapColumn(",
				"          {Actual Shipment Date} = select4csv1@{Actual Shipment Date},",
				"          {Actual Start Date} = select4csv1@{Actual Start Date},",
				"          {AMS Item Name} = select4csv1@{AMS Item Name},",
				"          {Approval Date} = select4csv1@{Approval Date},",
				"          {Arrived at Vendor Date} = select4csv1@{Arrived at Vendor Date},",
				"          {Avg Addl Funds} = select4csv1@{Avg Addl Funds},",
				"          {Business Area} = select4csv1@{Business Area},",
				"          {Buyer Name} = select4csv1@{Buyer Name},",
				"          {Closure Status} = select4csv1@{Closure Status},",
				"          {Complete Date} = select4csv1@{Complete Date},",
				"          {Concat_NMR Details} = select4csv1@{Concat_NMR Details},",
				"          {Contract Number} = select4csv1@{Contract Number},",
				"          {Contract Warranty End Date} = select4csv1@{Contract Warranty End Date},",
				"          {Customer Name} = select4csv1@{Customer Name},",
				"          {Customer Po Number} = select4csv1@{Customer Po Number},",
				"          {DRO Po Number} = select4csv1@{DRO Po Number},",
				"          {DRO Receive Date} = select4csv1@{DRO Receive Date},",
				"          {Failure Cause Code} = select4csv1@{Failure Cause Code},",
				"          {Failure Date} = select4csv1@{Failure Date},",
				"          {Failure Site} = select4csv1@{Failure Site},",
				"          {Item Description} = select4csv1@{Item Description},",
				"          {Item Number} = select4csv1@{Item Number},",
				"          {Item Revision} = select4csv1@{Item Revision},",
				"          {Line Creation Date} = select4csv1@{Line Creation Date},",
				"          {Line Number} = select4csv1@{Line Number},",
				"          {Line Quantity} = select4csv1@{Line Quantity},",
				"          {Line Status} = select4csv1@{Line Status},",
				"          {NMR Creation Date} = select4csv1@{NMR Creation Date},",
				"          {Nmr Customer} = select4csv1@{Nmr Customer},",
				"          {NMR DATE CLOSED_DETCLOSED} = select4csv1@{NMR DATE CLOSED_DETCLOSED},",
				"          {Nmr Det Action Taken} = select4csv1@{Nmr Det Action Taken},",
				"          {Nmr Det Date Action Taken} = select4csv1@{Nmr Det Date Action Taken},",
				"          {Nmr Det Date Closed} = select4csv1@{Nmr Det Date Closed},",
				"          {Nmr Det Desc Of Def} = select4csv1@{Nmr Det Desc Of Def},",
				"          {Nmr Det Dispo} = select4csv1@{Nmr Det Dispo},",
				"          {Nmr Det Line Creation Date} = select4csv1@{Nmr Det Line Creation Date},",
				"          {Nmr Det Oper Name} = select4csv1@{Nmr Det Oper Name},",
				"          {NMR Det Repair Action} = select4csv1@{NMR Det Repair Action},",
				"          {Nmr Det Sn} = select4csv1@{Nmr Det Sn},",
				"          {Nmr Nmr Date Closed} = select4csv1@{Nmr Nmr Date Closed},",
				"          {NMR Number} = select4csv1@{NMR Number},",
				"          {NMR Originator} = select4csv1@{NMR Originator},",
				"          {Nmr Parent Nmr} = select4csv1@{Nmr Parent Nmr},",
				"          {Nmr Parent Sn} = select4csv1@{Nmr Parent Sn},",
				"          {Nmr Pgm} = select4csv1@{Nmr Pgm},",
				"          {Repair$Vendor Name} = select4csv1@{Repair$Vendor Name},",
				"          {Report Symptom} = select4csv1@{Report Symptom},",
				"          {Req Create Date} = select4csv1@{Req Create Date},",
				"          {Nmr Pn} = select4csv1@{Nmr Pn},",
				"          {Nmr Pn Desc} = select4csv1@{Nmr Pn Desc},",
				"          {Nmr Po Receipt Date} = select4csv1@{Nmr Po Receipt Date},",
				"          {NMR RMA Line No} = select4csv1@{NMR RMA Line No},",
				"          {Nmr Sn} = select4csv1@{Nmr Sn},",
				"          {Nmr Warranty} = select4csv1@{Nmr Warranty},",
				"          Notes = select4csv1@Notes,",
				"          {Om Or Pc} = select4csv1@{Om Or Pc},",
				"          {Order Date} = select4csv1@{Order Date},",
				"          {Order Type Name} = select4csv1@{Order Type Name},",
				"          {Organization Code} = select4csv1@{Organization Code},",
				"          {Po Approved Date} = select4csv1@{Po Approved Date},",
				"          {Po Item Description} = select4csv1@{Po Item Description},",
				"          {Po Line Creation Date} = select4csv1@{Po Line Creation Date},",
				"          {Po Line Number} = select4csv1@{Po Line Number},",
				"          {Po Line Type} = select4csv1@{Po Line Type},",
				"          {Po Revision Number} = select4csv1@{Po Revision Number},",
				"          {PO Unit Price} = select4csv1@{PO Unit Price},",
				"          {Po Warranty Status} = select4csv1@{Po Warranty Status},",
				"          Preparer = select4csv1@Preparer,",
				"          {Price List} = select4csv1@{Price List},",
				"          {Product Line} = select4csv1@{Product Line},",
				"          {Promised Date} = select4csv1@{Promised Date},",
				"          {Quantity Shipped} = select4csv1@{Quantity Shipped},",
				"          {Received from Vendor Date} = select4csv1@{Received from Vendor Date},",
				"          {Repair Item Serial Number} = select4csv1@{Repair Item Serial Number},",
				"          {Repair Line Id} = select4csv1@{Repair Line Id},",
				"          {Repair Number} = select4csv1@{Repair Number},",
				"          {Repair Order Closed Date} = select4csv1@{Repair Order Closed Date},",
				"          {Repair Order Creation Date} = select4csv1@{Repair Order Creation Date},",
				"          {Repair Order Project} = select4csv1@{Repair Order Project},",
				"          {Repair Order Promised Date} = select4csv1@{Repair Order Promised Date},",
				"          {Repair Order Task} = select4csv1@{Repair Order Task},",
				"          {Repair Owner Name} = select4csv1@{Repair Owner Name},",
				"          {Repair Quantity} = select4csv1@{Repair Quantity},",
				"          {Repair Reason} = select4csv1@{Repair Reason},",
				"          {Repair Status} = select4csv1@{Repair Status},",
				"          {Repair Type} = select4csv1@{Repair Type},",
				"          {Repair Type Reference} = select4csv1@{Repair Type Reference},",
				"          {Repair$Actual Repair Price} = select4csv1@{Repair$Actual Repair Price},",
				"          {Repair$Metric Completion Date} = select4csv1@{Repair$Metric Completion Date},",
				"          {Repair$Tat Adj} = select4csv1@{Repair$Tat Adj},",
				"          {Repair$Tat Adj Reason} = select4csv1@{Repair$Tat Adj Reason},",
				"          {RTV Ship Date} = select4csv1@{RTV Ship Date},",
				"          {Requested Date} = select4csv1@{Requested Date},",
				"          {Requisition Approval Date} = select4csv1@{Requisition Approval Date},",
				"          {Requisition Created By} = select4csv1@{Requisition Created By},",
				"          {Requisition Line Number} = select4csv1@{Requisition Line Number},",
				"          {Requisition Number} = select4csv1@{Requisition Number},",
				"          {Rma Creation Date} = select4csv1@{Rma Creation Date},",
				"          {RMA Nbr/Order Nbr} = select4csv1@{RMA Nbr/Order Nbr},",
				"          {RTV Hold End Date} = select4csv1@{RTV Hold End Date},",
				"          {RTV Hold Start Date} = select4csv1@{RTV Hold Start Date},",
				"          {RTV PO Number} = select4csv1@{RTV PO Number},",
				"          {RTV Supplier SN} = select4csv1@{RTV Supplier SN},",
				"          {Salesforce Num} = select4csv1@{Salesforce Num},",
				"          {Scheduled Ship Date} = select4csv1@{Scheduled Ship Date},",
				"          {Service Request Number} = select4csv1@{Service Request Number},",
				"          {Ship Date} = select4csv1@{Ship Date},",
				"          {Ship From Location} = select4csv1@{Ship From Location},",
				"          {Ship To Address1} = select4csv1@{Ship To Address1},",
				"          {Ship To City} = select4csv1@{Ship To City},",
				"          {Ship To Country} = select4csv1@{Ship To Country},",
				"          {Ship To Customer Name} = select4csv1@{Ship To Customer Name},",
				"          {Ship To Location} = select4csv1@{Ship To Location},",
				"          {Ship To State} = select4csv1@{Ship To State},",
				"          {Shipped from Vendor Date} = select4csv1@{Shipped from Vendor Date},",
				"          {3PL RMA} = select4csv1@{3PL RMA},",
				"          {RTV Receipt Date} = select4csv1@{RTV Receipt Date},",
				"          {Shipped Quantity} = select4csv1@{Shipped Quantity},",
				"          {Sold To Customer Name} = select4csv1@{Sold To Customer Name},",
				"          {Sr Group Name} = select4csv1@{Sr Group Name},",
				"          {Sr Item Serial Number} = select4csv1@{Sr Item Serial Number},",
				"          {Sr Owner Name} = select4csv1@{Sr Owner Name},",
				"          {Sr Status} = select4csv1@{Sr Status},",
				"          {Time In Hold Status} = select4csv1@{Time In Hold Status},",
				"          {Time In Open Status} = select4csv1@{Time In Open Status},",
				"          {Time In Repair} = select4csv1@{Time In Repair},",
				"          {Times Returned} = select4csv1@{Times Returned},",
				"          {Total Actual Amount} = select4csv1@{Total Actual Amount},",
				"          {Total Estimate Amount} = select4csv1@{Total Estimate Amount},",
				"          {Unit Selling Price} = select4csv1@{Unit Selling Price},",
				"          {Vendor Hold Time} = select4csv1@{Vendor Hold Time},",
				"          {Vendor Pn} = select4csv1@{Vendor Pn},",
				"          {Vendor Repair Time} = select4csv1@{Vendor Repair Time},",
				"          {Vendor RMA} = select4csv1@{Vendor RMA},",
				"          {ViaSat NMR} = select4csv1@{ViaSat NMR},",
				"          {ViaSat Parent RMA} = select4csv1@{ViaSat Parent RMA},",
				"          {ViaSat RMA} = select4csv1@{ViaSat RMA},",
				"          {Warehouse Code} = select4csv1@{Warehouse Code},",
				"          {Warranty Status} = select4csv1@{Warranty Status},",
				"          {PO Closed Date} = select4csv1@{PO Closed Date},",
				"          {Nmr Det Def Desc} = select4csv1@{Nmr Det Def Desc},",
				"          {DRO TAT SHIP DATE} = {select4csv1@DRO TAT SHIP DATE},",
				"          {RMA Received Date} = {select4csv1@RMA Received Date},",
				"          {Left_Right_NMR Det Repair Action} = {select4csv1@Right_NMR Det Repair Action},",
				"          {Task Number2} = {select4csv1@Task Number2},",
				"          {Unit Selling Price OM} = {select4csv1@Unit Selling Price OM},",
				"          {Cancelled Quantity} = {select4csv1@Cancelled Quantity},",
				"          {Line Cancelled Flag} = {select4csv1@Line Cancelled Flag},",
				"          {Org Avg Item Cost} = {select4csv1@Org Avg Item Cost},",
				"          {Age Bus Days (Start Date)},",
				"          {Right_Actual Shipment Date} = select4csv3@{Actual Shipment Date},",
				"          {Right_Actual Start Date} = select4csv3@{Actual Start Date},",
				"          {Right_AMS Item Name} = select4csv3@{AMS Item Name},",
				"          {Right_Approval Date} = select4csv3@{Approval Date},",
				"          {Right_Arrived at Vendor Date} = select4csv3@{Arrived at Vendor Date},",
				"          {Right_Avg Addl Funds} = select4csv3@{Avg Addl Funds},",
				"          {Right_Business Area} = select4csv3@{Business Area},",
				"          {Right_Buyer Name} = select4csv3@{Buyer Name},",
				"          {Right_Closure Status} = select4csv3@{Closure Status},",
				"          {Right_Complete Date} = select4csv3@{Complete Date},",
				"          {Right_Concat_NMR Details} = select4csv3@{Concat_NMR Details},",
				"          {Right_Contract Number} = select4csv3@{Contract Number},",
				"          {Right_Contract Warranty End Date} = select4csv3@{Contract Warranty End Date},",
				"          {Right_Customer Name} = select4csv3@{Customer Name},",
				"          {Right_Customer Po Number} = select4csv3@{Customer Po Number},",
				"          {Right_DRO Po Number} = select4csv3@{DRO Po Number},",
				"          {Right_DRO Receive Date} = select4csv3@{DRO Receive Date},",
				"          {Right_Failure Cause Code} = select4csv3@{Failure Cause Code},",
				"          {Right_Failure Date} = select4csv3@{Failure Date},",
				"          {Right_Failure Site} = select4csv3@{Failure Site},",
				"          {Right_Item Description} = select4csv3@{Item Description},",
				"          {Right_Item Number} = select4csv3@{Item Number},",
				"          {Right_Item Revision} = select4csv3@{Item Revision},",
				"          {Right_Line Creation Date} = select4csv3@{Line Creation Date},",
				"          {Right_Line Number} = select4csv3@{Line Number},",
				"          {Right_Line Quantity} = select4csv3@{Line Quantity},",
				"          {Right_Line Status} = select4csv3@{Line Status},",
				"          {Right_NMR Creation Date} = select4csv3@{NMR Creation Date},",
				"          {Right_Nmr Customer} = select4csv3@{Nmr Customer},",
				"          {Right_NMR DATE CLOSED_DETCLOSED} = select4csv3@{NMR DATE CLOSED_DETCLOSED},",
				"          {Right_Nmr Det Action Taken} = select4csv3@{Nmr Det Action Taken},",
				"          {Right_Nmr Det Date Action Taken} = select4csv3@{Nmr Det Date Action Taken},",
				"          {Right_Nmr Det Date Closed} = select4csv3@{Nmr Det Date Closed},",
				"          {Right_Nmr Det Desc Of Def} = select4csv3@{Nmr Det Desc Of Def},",
				"          {Right_Nmr Det Dispo} = select4csv3@{Nmr Det Dispo},",
				"          {Right_Nmr Det Line Creation Date} = select4csv3@{Nmr Det Line Creation Date},",
				"          {Right_Nmr Det Oper Name} = select4csv3@{Nmr Det Oper Name},",
				"          {Right_NMR Det Repair Action} = select4csv3@{NMR Det Repair Action},",
				"          {Right_Nmr Det Sn} = select4csv3@{Nmr Det Sn},",
				"          {Right_Nmr Nmr Date Closed} = select4csv3@{Nmr Nmr Date Closed},",
				"          {Right_NMR Number} = select4csv3@{NMR Number},",
				"          {Right_NMR Originator} = select4csv3@{NMR Originator},",
				"          {Right_Nmr Parent Nmr} = select4csv3@{Nmr Parent Nmr},",
				"          {Right_Nmr Parent Sn} = select4csv3@{Nmr Parent Sn},",
				"          {Right_Nmr Pgm} = select4csv3@{Nmr Pgm},",
				"          {Right_Nmr Pn} = select4csv3@{Nmr Pn},",
				"          {Right_Nmr Pn Desc} = select4csv3@{Nmr Pn Desc},",
				"          {Right_Nmr Po Receipt Date} = select4csv3@{Nmr Po Receipt Date},",
				"          {Right_NMR RMA Line No} = select4csv3@{NMR RMA Line No},",
				"          {Right_Nmr Sn} = select4csv3@{Nmr Sn},",
				"          {Right_Nmr Warranty} = select4csv3@{Nmr Warranty},",
				"          Right_Notes = select4csv3@Notes,",
				"          {Right_Om Or Pc} = select4csv3@{Om Or Pc},",
				"          {Right_Order Date} = select4csv3@{Order Date},",
				"          {Right_Order Type Name} = select4csv3@{Order Type Name},",
				"          {Right_Organization Code} = select4csv3@{Organization Code},",
				"          {Right_Po Approved Date} = select4csv3@{Po Approved Date},",
				"          {Right_Po Item Description} = select4csv3@{Po Item Description},",
				"          {Right_Po Line Creation Date} = select4csv3@{Po Line Creation Date},",
				"          {Right_Po Line Number} = select4csv3@{Po Line Number},",
				"          {Right_Po Line Type} = select4csv3@{Po Line Type},",
				"          {Right_Po Revision Number} = select4csv3@{Po Revision Number},",
				"          {Right_PO Unit Price} = select4csv3@{PO Unit Price},",
				"          {Right_Po Warranty Status} = select4csv3@{Po Warranty Status},",
				"          Right_Preparer = select4csv3@Preparer,",
				"          {Right_Price List} = select4csv3@{Price List},",
				"          {Right_Product Line} = select4csv3@{Product Line},",
				"          {Right_Promised Date} = select4csv3@{Promised Date},",
				"          {Right_Quantity Shipped} = select4csv3@{Quantity Shipped},",
				"          {Right_Received from Vendor Date} = select4csv3@{Received from Vendor Date},",
				"          {Right_Repair Item Serial Number} = select4csv3@{Repair Item Serial Number},",
				"          {Right_Repair Line Id} = select4csv3@{Repair Line Id},",
				"          {Right_Repair Number} = select4csv3@{Repair Number},",
				"          {Right_Repair Order Closed Date} = select4csv3@{Repair Order Closed Date},",
				"          {Right_Repair Order Creation Date} = select4csv3@{Repair Order Creation Date},",
				"          {Right_Repair Order Project} = select4csv3@{Repair Order Project},",
				"          {Right_Repair Order Promised Date} = select4csv3@{Repair Order Promised Date},",
				"          {Right_Repair Order Task} = select4csv3@{Repair Order Task},",
				"          {Right_Repair Owner Name} = select4csv3@{Repair Owner Name},",
				"          {Right_Repair Quantity} = select4csv3@{Repair Quantity},",
				"          {Right_Repair Reason} = select4csv3@{Repair Reason},",
				"          {Right_Repair Status} = select4csv3@{Repair Status},",
				"          {Right_Repair Type} = select4csv3@{Repair Type},",
				"          {Right_Repair Type Reference} = select4csv3@{Repair Type Reference},",
				"          {Right_Repair$Actual Repair Price} = select4csv3@{Repair$Actual Repair Price},",
				"          {Right_Repair$Metric Completion Date} = select4csv3@{Repair$Metric Completion Date},",
				"          {Right_Repair$Tat Adj} = select4csv3@{Repair$Tat Adj},",
				"          {Right_Repair$Tat Adj Reason} = select4csv3@{Repair$Tat Adj Reason},",
				"          {Right_Repair$Vendor Name} = select4csv3@{Repair$Vendor Name},",
				"          {Right_Report Symptom} = select4csv3@{Report Symptom},",
				"          {Right_Req Create Date} = select4csv3@{Req Create Date},",
				"          {Right_Requested Date} = select4csv3@{Requested Date},",
				"          {Right_Requisition Approval Date} = select4csv3@{Requisition Approval Date},",
				"          {Right_Requisition Created By} = select4csv3@{Requisition Created By},",
				"          {Right_Requisition Line Number} = select4csv3@{Requisition Line Number},",
				"          {Right_Requisition Number} = select4csv3@{Requisition Number},",
				"          {Right_Rma Creation Date} = select4csv3@{Rma Creation Date},",
				"          {Right_RMA Nbr/Order Nbr} = select4csv3@{RMA Nbr/Order Nbr},",
				"          {Right_RTV Hold End Date} = select4csv3@{RTV Hold End Date},",
				"          {Right_RTV Hold Start Date} = select4csv3@{RTV Hold Start Date},",
				"          {Right_RTV PO Number} = select4csv3@{RTV PO Number},",
				"          {Right_RTV Supplier SN} = select4csv3@{RTV Supplier SN},",
				"          {Right_Salesforce Num} = select4csv3@{Salesforce Num},",
				"          {Right_Scheduled Ship Date} = select4csv3@{Scheduled Ship Date},",
				"          {Right_Service Request Number} = select4csv3@{Service Request Number},",
				"          {Right_Ship Date} = select4csv3@{Ship Date},",
				"          {Right_Ship From Location} = select4csv3@{Ship From Location},",
				"          {Right_Ship To Address1} = select4csv3@{Ship To Address1},",
				"          {Right_Ship To City} = select4csv3@{Ship To City},",
				"          {Right_Ship To Country} = select4csv3@{Ship To Country},",
				"          {Right_Ship To Customer Name} = select4csv3@{Ship To Customer Name},",
				"          {Right_Ship To Location} = select4csv3@{Ship To Location},",
				"          {Right_Ship To State} = select4csv3@{Ship To State},",
				"          {Right_Shipped from Vendor Date} = select4csv3@{Shipped from Vendor Date},",
				"          {Right_Shipped Quantity} = select4csv3@{Shipped Quantity},",
				"          {Right_Sold To Customer Name} = select4csv3@{Sold To Customer Name},",
				"          {Right_Sr Group Name} = select4csv3@{Sr Group Name},",
				"          {Right_Sr Item Serial Number} = select4csv3@{Sr Item Serial Number},",
				"          {Right_Sr Owner Name} = select4csv3@{Sr Owner Name},",
				"          {Right_Sr Status} = select4csv3@{Sr Status},",
				"          {Right_Time In Hold Status} = select4csv3@{Time In Hold Status},",
				"          {Right_Time In Open Status} = select4csv3@{Time In Open Status},",
				"          {Right_Time In Repair} = select4csv3@{Time In Repair},",
				"          {Right_Times Returned} = select4csv3@{Times Returned},",
				"          {Right_Total Actual Amount} = select4csv3@{Total Actual Amount},",
				"          {Right_Total Estimate Amount} = select4csv3@{Total Estimate Amount},",
				"          {Right_Unit Selling Price} = select4csv3@{Unit Selling Price},",
				"          {Right_Vendor Hold Time} = select4csv3@{Vendor Hold Time},",
				"          {Right_Vendor Pn} = select4csv3@{Vendor Pn},",
				"          {Right_Vendor Repair Time} = select4csv3@{Vendor Repair Time},",
				"          {Right_Vendor RMA} = select4csv3@{Vendor RMA},",
				"          {Right_ViaSat NMR} = select4csv3@{ViaSat NMR},",
				"          {Right_ViaSat Parent RMA} = select4csv3@{ViaSat Parent RMA},",
				"          {Right_ViaSat RMA} = select4csv3@{ViaSat RMA},",
				"          {Right_Warehouse Code} = select4csv3@{Warehouse Code},",
				"          {Right_Warranty Status} = select4csv3@{Warranty Status},",
				"          {Right_PO Closed Date} = select4csv3@{PO Closed Date},",
				"          {Right_Nmr Det Def Desc} = select4csv3@{Nmr Det Def Desc},",
				"          {Right_3PL RMA} = select4csv3@{3PL RMA},",
				"          {Right_RTV Ship Date} = select4csv3@{RTV Ship Date},",
				"          {Right_RTV Receipt Date} = select4csv3@{RTV Receipt Date},",
				"          {Age Bus Days (Rcvd Date)},",
				"          {Right_DRO TAT SHIP DATE} = {DRO TAT SHIP DATE},",
				"          {Right_RMA Received Date} = {RMA Received Date},",
				"          {Right_Right_NMR Det Repair Action} = {Right_NMR Det Repair Action},",
				"          {Right_Task Number2} = {Task Number2},",
				"          {Right_Unit Selling Price OM} = {Unit Selling Price OM},",
				"          {Right_Cancelled Quantity} = {Cancelled Quantity},",
				"          {Right_Line Cancelled Flag} = {Line Cancelled Flag},",
				"          {Right_Org Avg Item Cost} = {Org Avg Item Cost}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select5csv1",
				"select5csv1 select(mapColumn(",
				"          {Actual Shipment Date},",
				"          {Right_Org Avg Item Cost},",
				"          {Right_Cancelled Quantity},",
				"          {Right_Line Cancelled Flag},",
				"          {Right_Unit Selling Price OM},",
				"          {Right_RTV Receipt Date},",
				"          {Right_RTV Ship Date},",
				"          {Right_3PL RMA},",
				"          {Right_Task Number2},",
				"          {Actual Start Date},",
				"          {AMS Item Name},",
				"          {Approval Date},",
				"          {Arrived at Vendor Date},",
				"          {Avg Addl Funds},",
				"          {Business Area},",
				"          {Buyer Name},",
				"          {Closure Status},",
				"          {Complete Date},",
				"          {Concat_NMR Details},",
				"          {Contract Number},",
				"          {Contract Warranty End Date},",
				"          {Customer Name},",
				"          {Customer Po Number},",
				"          {DRO Po Number},",
				"          {DRO Receive Date},",
				"          {Failure Cause Code},",
				"          {Failure Date},",
				"          {Failure Site},",
				"          {Item Description},",
				"          {Item Number},",
				"          {Item Revision},",
				"          {Line Creation Date},",
				"          {Line Number},",
				"          {Line Quantity},",
				"          {Line Status},",
				"          {NMR Creation Date},",
				"          {Nmr Customer},",
				"          {NMR DATE CLOSED_DETCLOSED},",
				"          {Nmr Det Action Taken},",
				"          {Nmr Det Date Action Taken},",
				"          {Nmr Det Date Closed},",
				"          {Nmr Det Desc Of Def},",
				"          {Nmr Det Dispo},",
				"          {Nmr Det Line Creation Date},",
				"          {Nmr Det Oper Name},",
				"          {NMR Det Repair Action},",
				"          {Nmr Det Sn},",
				"          {Nmr Nmr Date Closed},",
				"          {NMR Number},",
				"          {NMR Originator},",
				"          {Nmr Parent Nmr},",
				"          {Nmr Parent Sn},",
				"          {Nmr Pgm},",
				"          {Repair$Vendor Name},",
				"          {Report Symptom},",
				"          {Req Create Date},",
				"          {Nmr Pn},",
				"          {Nmr Pn Desc},",
				"          {Nmr Po Receipt Date},",
				"          {NMR RMA Line No},",
				"          {Nmr Sn},",
				"          {Nmr Warranty},",
				"          Notes,",
				"          {Om Or Pc},",
				"          {Order Date},",
				"          {Order Type Name},",
				"          {Organization Code},",
				"          {Po Approved Date},",
				"          {Po Item Description},",
				"          {Po Line Creation Date},",
				"          {Po Line Number},",
				"          {Po Line Type},",
				"          {Po Revision Number},",
				"          {PO Unit Price},",
				"          {Po Warranty Status},",
				"          Preparer,",
				"          {Price List},",
				"          {Product Line},",
				"          {Promised Date},",
				"          {Quantity Shipped},",
				"          {Received from Vendor Date},",
				"          {Repair Item Serial Number},",
				"          {Repair Line Id},",
				"          {Repair Number},",
				"          {Repair Order Closed Date},",
				"          {Repair Order Creation Date},",
				"          {Repair Order Project},",
				"          {Repair Order Promised Date},",
				"          {Repair Order Task},",
				"          {Repair Owner Name},",
				"          {Repair Quantity},",
				"          {Repair Reason},",
				"          {Repair Status},",
				"          {Repair Type},",
				"          {Repair Type Reference},",
				"          {Repair$Actual Repair Price},",
				"          {Repair$Metric Completion Date},",
				"          {Repair$Tat Adj},",
				"          {Repair$Tat Adj Reason},",
				"          {RTV Ship Date},",
				"          {Requested Date},",
				"          {Requisition Approval Date},",
				"          {Requisition Created By},",
				"          {Requisition Line Number},",
				"          {Requisition Number},",
				"          {Rma Creation Date},",
				"          {RMA Nbr/Order Nbr},",
				"          {RTV Hold End Date},",
				"          {RTV Hold Start Date},",
				"          {RTV PO Number},",
				"          {RTV Supplier SN},",
				"          {Salesforce Num},",
				"          {Scheduled Ship Date},",
				"          {Service Request Number},",
				"          {Ship Date},",
				"          {Ship From Location},",
				"          {Ship To Address1},",
				"          {Ship To City},",
				"          {Ship To Country},",
				"          {Ship To Customer Name},",
				"          {Ship To Location},",
				"          {Ship To State},",
				"          {Shipped from Vendor Date},",
				"          {3PL RMA},",
				"          {RTV Receipt Date},",
				"          {Shipped Quantity},",
				"          {Sold To Customer Name},",
				"          {Sr Group Name},",
				"          {Sr Item Serial Number},",
				"          {Sr Owner Name},",
				"          {Sr Status},",
				"          {Time In Hold Status},",
				"          {Time In Open Status},",
				"          {Time In Repair},",
				"          {Times Returned},",
				"          {Total Actual Amount},",
				"          {Total Estimate Amount},",
				"          {Unit Selling Price},",
				"          {Vendor Hold Time},",
				"          {Vendor Pn},",
				"          {Vendor Repair Time},",
				"          {Vendor RMA},",
				"          {ViaSat NMR},",
				"          {ViaSat Parent RMA},",
				"          {ViaSat RMA},",
				"          {Warehouse Code},",
				"          {Warranty Status},",
				"          {PO Closed Date},",
				"          {Nmr Det Def Desc},",
				"          {DRO TAT SHIP DATE},",
				"          {RMA Received Date},",
				"          {Left_Right_NMR Det Repair Action},",
				"          {Task Number2},",
				"          {Unit Selling Price OM},",
				"          {Cancelled Quantity},",
				"          {Line Cancelled Flag},",
				"          {Org Avg Item Cost},",
				"          {Age Bus Days (Start Date)},",
				"          {Age Bus Days (Rcvd Date)},",
				"          {Right_RMA Received Date},",
				"          {Right_Nmr Det Def Desc},",
				"          {Right_Right_NMR Det Repair Action}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select6csv1",
				"split2@spilt3inputcsv1 derive({VENDOR TAT SHIP DATE} = iifNull({Received from Vendor Date},currentDate(),{Received from Vendor Date})) ~> derivedClumn3csv1",
				"derivedClumn3csv1 derive(DateBetweenVendor = toDate({Arrived at Vendor Date})) ~> derivedClumn4csv1",
				"derivedClumn4csv1 derive(DateBetweenVendor = iif(DateBetweenVendor <= {VENDOR TAT SHIP DATE}, addDays((DateBetweenVendor),1), DateBetweenVendor)) ~> derivedClumn5csv1",
				"derivedClumn5csv1 select(mapColumn(",
				"          {Actual Shipment Date},",
				"          {Right_Org Avg Item Cost},",
				"          {Right_Cancelled Quantity},",
				"          {Right_Line Cancelled Flag},",
				"          {Right_Unit Selling Price OM},",
				"          {Right_RTV Receipt Date},",
				"          {Right_RTV Ship Date},",
				"          {Right_3PL RMA},",
				"          {Right_Task Number2},",
				"          {Actual Start Date},",
				"          {AMS Item Name},",
				"          {Approval Date},",
				"          {Arrived at Vendor Date},",
				"          {Avg Addl Funds},",
				"          {Business Area},",
				"          {Buyer Name},",
				"          {Closure Status},",
				"          {Complete Date},",
				"          {Concat_NMR Details},",
				"          {Contract Number},",
				"          {Contract Warranty End Date},",
				"          {Customer Name},",
				"          {Customer Po Number},",
				"          {DRO Po Number},",
				"          {DRO Receive Date},",
				"          {Failure Cause Code},",
				"          {Failure Date},",
				"          {Failure Site},",
				"          {Item Description},",
				"          {Item Number},",
				"          {Item Revision},",
				"          {Line Creation Date},",
				"          {Line Number},",
				"          {Line Quantity},",
				"          {Line Status},",
				"          {NMR Creation Date},",
				"          {Nmr Customer},",
				"          {NMR DATE CLOSED_DETCLOSED},",
				"          {Nmr Det Action Taken},",
				"          {Nmr Det Date Action Taken},",
				"          {Nmr Det Date Closed},",
				"          {Nmr Det Desc Of Def},",
				"          {Nmr Det Dispo},",
				"          {Nmr Det Line Creation Date},",
				"          {Nmr Det Oper Name},",
				"          {NMR Det Repair Action},",
				"          {Nmr Det Sn},",
				"          {Nmr Nmr Date Closed},",
				"          {NMR Number},",
				"          {NMR Originator},",
				"          {Nmr Parent Nmr},",
				"          {Nmr Parent Sn},",
				"          {Nmr Pgm},",
				"          {Repair$Vendor Name},",
				"          {Report Symptom},",
				"          {Req Create Date},",
				"          {Nmr Pn},",
				"          {Nmr Pn Desc},",
				"          {Nmr Po Receipt Date},",
				"          {NMR RMA Line No},",
				"          {Nmr Sn},",
				"          {Nmr Warranty},",
				"          Notes,",
				"          {Om Or Pc},",
				"          {Order Date},",
				"          {Order Type Name},",
				"          {Organization Code},",
				"          {Po Approved Date},",
				"          {Po Item Description},",
				"          {Po Line Creation Date},",
				"          {Po Line Number},",
				"          {Po Line Type},",
				"          {Po Revision Number},",
				"          {PO Unit Price},",
				"          {Po Warranty Status},",
				"          Preparer,",
				"          {Price List},",
				"          {Product Line},",
				"          {Promised Date},",
				"          {Quantity Shipped},",
				"          {Received from Vendor Date},",
				"          {Repair Item Serial Number},",
				"          {Repair Line Id},",
				"          {Repair Number},",
				"          {Repair Order Closed Date},",
				"          {Repair Order Creation Date},",
				"          {Repair Order Project},",
				"          {Repair Order Promised Date},",
				"          {Repair Order Task},",
				"          {Repair Owner Name},",
				"          {Repair Quantity},",
				"          {Repair Reason},",
				"          {Repair Status},",
				"          {Repair Type},",
				"          {Repair Type Reference},",
				"          {Repair$Actual Repair Price},",
				"          {Repair$Metric Completion Date},",
				"          {Repair$Tat Adj},",
				"          {Repair$Tat Adj Reason},",
				"          {RTV Ship Date},",
				"          {Requested Date},",
				"          {Requisition Approval Date},",
				"          {Requisition Created By},",
				"          {Requisition Line Number},",
				"          {Requisition Number},",
				"          {Rma Creation Date},",
				"          {RMA Nbr/Order Nbr},",
				"          {RTV Hold End Date},",
				"          {RTV Hold Start Date},",
				"          {RTV PO Number},",
				"          {RTV Supplier SN},",
				"          {Salesforce Num},",
				"          {Scheduled Ship Date},",
				"          {Service Request Number},",
				"          {Ship Date},",
				"          {Ship From Location},",
				"          {Ship To Address1},",
				"          {Ship To City},",
				"          {Ship To Country},",
				"          {Ship To Customer Name},",
				"          {Ship To Location},",
				"          {Ship To State},",
				"          {Shipped from Vendor Date},",
				"          {3PL RMA},",
				"          {RTV Receipt Date},",
				"          {Shipped Quantity},",
				"          {Sold To Customer Name},",
				"          {Sr Group Name},",
				"          {Sr Item Serial Number},",
				"          {Sr Owner Name},",
				"          {Sr Status},",
				"          {Time In Hold Status},",
				"          {Time In Open Status},",
				"          {Time In Repair},",
				"          {Times Returned},",
				"          {Total Actual Amount},",
				"          {Total Estimate Amount},",
				"          {Unit Selling Price},",
				"          {Vendor Hold Time},",
				"          {Vendor Pn},",
				"          {Vendor Repair Time},",
				"          {Vendor RMA},",
				"          {ViaSat NMR},",
				"          {ViaSat Parent RMA},",
				"          {ViaSat RMA},",
				"          {Warehouse Code},",
				"          {Warranty Status},",
				"          {PO Closed Date},",
				"          {Nmr Det Def Desc},",
				"          {DRO TAT SHIP DATE},",
				"          {RMA Received Date},",
				"          {Left_Right_NMR Det Repair Action},",
				"          {Task Number2},",
				"          {Unit Selling Price OM},",
				"          {Cancelled Quantity},",
				"          {Line Cancelled Flag},",
				"          {Org Avg Item Cost},",
				"          {Age Bus Days (Start Date)},",
				"          {Age Bus Days (Rcvd Date)},",
				"          {Right_RMA Received Date},",
				"          {Right_Nmr Det Def Desc},",
				"          {Right_Right_NMR Det Repair Action},",
				"          {VENDOR TAT SHIP DATE},",
				"          DateBetweenVendor",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select7csv1",
				"select7csv1, select1csv2 join(DateBetweenVendor == Date,",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join3csv1",
				"join3csv1 select(mapColumn(",
				"          {Actual Shipment Date},",
				"          {Right_Org Avg Item Cost},",
				"          {Right_Cancelled Quantity},",
				"          {Right_Line Cancelled Flag},",
				"          {Right_Unit Selling Price OM},",
				"          {Right_RTV Receipt Date},",
				"          {Right_RTV Ship Date},",
				"          {Right_3PL RMA},",
				"          {Right_Task Number2},",
				"          {Actual Start Date},",
				"          {AMS Item Name},",
				"          {Approval Date},",
				"          {Arrived at Vendor Date},",
				"          {Avg Addl Funds},",
				"          {Business Area},",
				"          {Buyer Name},",
				"          {Closure Status},",
				"          {Complete Date},",
				"          {Concat_NMR Details},",
				"          {Contract Number},",
				"          {Contract Warranty End Date},",
				"          {Customer Name},",
				"          {Customer Po Number},",
				"          {DRO Po Number},",
				"          {DRO Receive Date},",
				"          {Failure Cause Code},",
				"          {Failure Date},",
				"          {Failure Site},",
				"          {Item Description},",
				"          {Item Number},",
				"          {Item Revision},",
				"          {Line Creation Date},",
				"          {Line Number},",
				"          {Line Quantity},",
				"          {Line Status},",
				"          {NMR Creation Date},",
				"          {Nmr Customer},",
				"          {NMR DATE CLOSED_DETCLOSED},",
				"          {Nmr Det Action Taken},",
				"          {Nmr Det Date Action Taken},",
				"          {Nmr Det Date Closed},",
				"          {Nmr Det Desc Of Def},",
				"          {Nmr Det Dispo},",
				"          {Nmr Det Line Creation Date},",
				"          {Nmr Det Oper Name},",
				"          {NMR Det Repair Action},",
				"          {Nmr Det Sn},",
				"          {Nmr Nmr Date Closed},",
				"          {NMR Number},",
				"          {NMR Originator},",
				"          {Nmr Parent Nmr},",
				"          {Nmr Parent Sn},",
				"          {Nmr Pgm},",
				"          {Repair$Vendor Name},",
				"          {Report Symptom},",
				"          {Req Create Date},",
				"          {Nmr Pn},",
				"          {Nmr Pn Desc},",
				"          {Nmr Po Receipt Date},",
				"          {NMR RMA Line No},",
				"          {Nmr Sn},",
				"          {Nmr Warranty},",
				"          Notes,",
				"          {Om Or Pc},",
				"          {Order Date},",
				"          {Order Type Name},",
				"          {Organization Code},",
				"          {Po Approved Date},",
				"          {Po Item Description},",
				"          {Po Line Creation Date},",
				"          {Po Line Number},",
				"          {Po Line Type},",
				"          {Po Revision Number},",
				"          {PO Unit Price},",
				"          {Po Warranty Status},",
				"          Preparer,",
				"          {Price List},",
				"          {Product Line},",
				"          {Promised Date},",
				"          {Quantity Shipped},",
				"          {Received from Vendor Date},",
				"          {Repair Item Serial Number},",
				"          {Repair Line Id},",
				"          {Repair Number},",
				"          {Repair Order Closed Date},",
				"          {Repair Order Creation Date},",
				"          {Repair Order Project},",
				"          {Repair Order Promised Date},",
				"          {Repair Order Task},",
				"          {Repair Owner Name},",
				"          {Repair Quantity},",
				"          {Repair Reason},",
				"          {Repair Status},",
				"          {Repair Type},",
				"          {Repair Type Reference},",
				"          {Repair$Actual Repair Price},",
				"          {Repair$Metric Completion Date},",
				"          {Repair$Tat Adj},",
				"          {Repair$Tat Adj Reason},",
				"          {RTV Ship Date},",
				"          {Requested Date},",
				"          {Requisition Approval Date},",
				"          {Requisition Created By},",
				"          {Requisition Line Number},",
				"          {Requisition Number},",
				"          {Rma Creation Date},",
				"          {RMA Nbr/Order Nbr},",
				"          {RTV Hold End Date},",
				"          {RTV Hold Start Date},",
				"          {RTV PO Number},",
				"          {RTV Supplier SN},",
				"          {Salesforce Num},",
				"          {Scheduled Ship Date},",
				"          {Service Request Number},",
				"          {Ship Date},",
				"          {Ship From Location},",
				"          {Ship To Address1},",
				"          {Ship To City},",
				"          {Ship To Country},",
				"          {Ship To Customer Name},",
				"          {Ship To Location},",
				"          {Ship To State},",
				"          {Shipped from Vendor Date},",
				"          {3PL RMA},",
				"          {RTV Receipt Date},",
				"          {Shipped Quantity},",
				"          {Sold To Customer Name},",
				"          {Sr Group Name},",
				"          {Sr Item Serial Number},",
				"          {Sr Owner Name},",
				"          {Sr Status},",
				"          {Time In Hold Status},",
				"          {Time In Open Status},",
				"          {Time In Repair},",
				"          {Times Returned},",
				"          {Total Actual Amount},",
				"          {Total Estimate Amount},",
				"          {Unit Selling Price},",
				"          {Vendor Hold Time},",
				"          {Vendor Pn},",
				"          {Vendor Repair Time},",
				"          {Vendor RMA},",
				"          {ViaSat NMR},",
				"          {ViaSat Parent RMA},",
				"          {ViaSat RMA},",
				"          {Warehouse Code},",
				"          {Warranty Status},",
				"          {PO Closed Date},",
				"          {Nmr Det Def Desc},",
				"          {DRO TAT SHIP DATE},",
				"          {RMA Received Date},",
				"          {Left_Right_NMR Det Repair Action},",
				"          {Task Number2},",
				"          {Unit Selling Price OM},",
				"          {Cancelled Quantity},",
				"          {Line Cancelled Flag},",
				"          {Org Avg Item Cost},",
				"          {Age Bus Days (Start Date)},",
				"          {Age Bus Days (Rcvd Date)},",
				"          {Right_RMA Received Date},",
				"          {Right_Nmr Det Def Desc},",
				"          {Right_Right_NMR Det Repair Action},",
				"          {VENDOR TAT SHIP DATE},",
				"          DateBetweenVendor,",
				"          Right_Date = Date,",
				"          MonthYear,",
				"          YearMonth,",
				"          LastDayOfMonth,",
				"          FiscalYearQuarter,",
				"          FiscalYear,",
				"          Right_IsBusinessDay = IsBusinessDay,",
				"          Right_WeekEndingDate_Sunday = WeekEndingDate_Sunday",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select8csv1",
				"select8csv1 filter(Right_IsBusinessDay >= 1) ~> filter4csv1",
				"filter4csv1 filter(dayOfWeek(DateBetweenVendor) != 1 && dayOfWeek(DateBetweenVendor) != 7) ~> filter5csv1",
				"filter5csv1 aggregate(groupBy({Arrived at Vendor Date},",
				"          {Business Area},",
				"          {Buyer Name},",
				"          {Age Bus Days (Start Date)},",
				"          {Customer Po Number},",
				"          {DRO Receive Date},",
				"          {Item Description},",
				"          {Line Creation Date},",
				"          {NMR Number},",
				"          Notes,",
				"          {Order Type Name},",
				"          {Product Line},",
				"          {Promised Date},",
				"          {Received from Vendor Date},",
				"          {Repair Number},",
				"          {Repair Order Closed Date},",
				"          {Repair Order Creation Date},",
				"          {Repair Order Project},",
				"          {Repair Order Task},",
				"          {Repair Owner Name},",
				"          {Repair Quantity},",
				"          {Repair Reason},",
				"          {Repair Status},",
				"          {Repair Type},",
				"          {Requested Date},",
				"          {Requisition Line Number},",
				"          {Requisition Number},",
				"          {RMA Nbr/Order Nbr},",
				"          {RTV Hold End Date},",
				"          {RTV Hold Start Date},",
				"          {RTV PO Number},",
				"          {RTV Supplier SN},",
				"          {Scheduled Ship Date},",
				"          {Ship From Location},",
				"          {Ship To Country},",
				"          {Ship To Customer Name},",
				"          {Ship To Location},",
				"          {Shipped from Vendor Date},",
				"          {Shipped Quantity},",
				"          {Sr Owner Name},",
				"          {Vendor Hold Time},",
				"          {Vendor Repair Time},",
				"          {Warehouse Code},",
				"          {Warranty Status},",
				"          {Time In Hold Status},",
				"          {Time In Open Status},",
				"          {Time In Repair},",
				"          {DRO TAT SHIP DATE},",
				"          {Age Bus Days (Rcvd Date)},",
				"          {Ship Date},",
				"          {Line Quantity},",
				"          {Nmr Customer},",
				"          {Repair Order Promised Date},",
				"          {Repair$Tat Adj},",
				"          {Repair$Vendor Name},",
				"          {Failure Cause Code},",
				"          {Actual Shipment Date},",
				"          {Actual Start Date},",
				"          {AMS Item Name},",
				"          {Approval Date},",
				"          {Avg Addl Funds},",
				"          {Closure Status},",
				"          {Concat_NMR Details},",
				"          {Contract Number},",
				"          {Contract Warranty End Date},",
				"          {Customer Name},",
				"          {DRO Po Number},",
				"          {Failure Date},",
				"          {Failure Site},",
				"          {Item Number},",
				"          {Line Number},",
				"          {Line Status},",
				"          {NMR Creation Date},",
				"          {NMR DATE CLOSED_DETCLOSED},",
				"          {Nmr Det Action Taken},",
				"          {Nmr Det Date Action Taken},",
				"          {Nmr Det Date Closed},",
				"          {Nmr Det Desc Of Def},",
				"          {Nmr Det Dispo},",
				"          {Nmr Det Line Creation Date},",
				"          {Nmr Det Oper Name},",
				"          {NMR Det Repair Action},",
				"          {Nmr Det Sn},",
				"          {Nmr Nmr Date Closed},",
				"          {NMR Originator},",
				"          {Nmr Parent Nmr},",
				"          {Nmr Parent Sn},",
				"          {Nmr Pgm},",
				"          {Nmr Pn},",
				"          {Nmr Pn Desc},",
				"          {Nmr Po Receipt Date},",
				"          {NMR RMA Line No},",
				"          {Nmr Sn},",
				"          {Nmr Warranty},",
				"          {Om Or Pc},",
				"          {Order Date},",
				"          {Organization Code},",
				"          {Po Approved Date},",
				"          {Po Item Description},",
				"          {Po Line Creation Date},",
				"          {Po Line Number},",
				"          {Po Line Type},",
				"          {Po Revision Number},",
				"          {PO Unit Price},",
				"          {Po Warranty Status},",
				"          Preparer,",
				"          {Price List},",
				"          {Quantity Shipped},",
				"          {Repair Item Serial Number},",
				"          {Repair Line Id},",
				"          {Repair Type Reference},",
				"          {Repair$Actual Repair Price},",
				"          {Repair$Metric Completion Date},",
				"          {Repair$Tat Adj Reason},",
				"          {Report Symptom},",
				"          {Req Create Date},",
				"          {Requisition Approval Date},",
				"          {Requisition Created By},",
				"          {Rma Creation Date},",
				"          {Salesforce Num},",
				"          {Service Request Number},",
				"          {Ship To Address1},",
				"          {Ship To City},",
				"          {Ship To State},",
				"          {Sold To Customer Name},",
				"          {Sr Group Name},",
				"          {Sr Item Serial Number},",
				"          {Sr Status},",
				"          {Times Returned},",
				"          {Total Actual Amount},",
				"          {Total Estimate Amount},",
				"          {Unit Selling Price},",
				"          {Vendor Pn},",
				"          {Vendor RMA},",
				"          {ViaSat NMR},",
				"          {ViaSat Parent RMA},",
				"          {ViaSat RMA},",
				"          {Item Revision},",
				"          {Complete Date},",
				"          {PO Closed Date},",
				"          {Nmr Det Def Desc},",
				"          {3PL RMA},",
				"          {RTV Ship Date},",
				"          {RTV Receipt Date}),",
				"     {VENDOR AGE (Bus Day)} = count({VENDOR TAT SHIP DATE})) ~> aggregate3",
				"select6csv1 split(!(isNull({Arrived at Vendor Date})),",
				"     disjoint: false) ~> split2@(spilt3inputcsv1, spilt4inputcsv1)",
				"aggregate3, split2@spilt4inputcsv1 union(byName: true)~> union1",
				"union1 derive({Repair Order Closed Date} = iifNull({Repair Order Closed Date}, {Actual Shipment Date}, {Repair Order Closed Date})) ~> derivedClumn6csv1",
				"split3@spilt5inputcsv1 derive(CREATERCVDTIME = toString(iifNull({DRO Receive Date}, currentDate(), {DRO Receive Date}))) ~> derivedClumn7csv1",
				"derivedClumn7csv1 derive(DateBetweenCREATERCVD = ({Repair Order Creation Date})) ~> derivedClumn8csv1",
				"derivedClumn8csv1 derive(DateBetweenCREATERCVD = iif(DateBetweenCREATERCVD <= toDate(CREATERCVDTIME), addDays((DateBetweenCREATERCVD),1), DateBetweenCREATERCVD)) ~> derivedClumn9csv1",
				"derivedClumn9csv1 select(mapColumn(",
				"          {Arrived at Vendor Date},",
				"          {Business Area},",
				"          {Buyer Name},",
				"          {Age Bus Days (Start Date)},",
				"          {Customer Po Number},",
				"          {DRO Receive Date},",
				"          {Item Description},",
				"          {Line Creation Date},",
				"          {NMR Number},",
				"          Notes,",
				"          {Order Type Name},",
				"          {Product Line},",
				"          {Promised Date},",
				"          {Received from Vendor Date},",
				"          {Repair Number},",
				"          {Repair Order Closed Date},",
				"          {Repair Order Creation Date},",
				"          {Repair Order Project},",
				"          {Repair Order Task},",
				"          {Repair Owner Name},",
				"          {Repair Quantity},",
				"          {Repair Reason},",
				"          {Repair Status},",
				"          {Repair Type},",
				"          {Requested Date},",
				"          {Requisition Line Number},",
				"          {Requisition Number},",
				"          {RMA Nbr/Order Nbr},",
				"          {RTV Hold End Date},",
				"          {RTV Hold Start Date},",
				"          {RTV PO Number},",
				"          {RTV Supplier SN},",
				"          {Scheduled Ship Date},",
				"          {Ship From Location},",
				"          {Ship To Country},",
				"          {Ship To Customer Name},",
				"          {Ship To Location},",
				"          {Shipped from Vendor Date},",
				"          {Shipped Quantity},",
				"          {Sr Owner Name},",
				"          {Vendor Hold Time},",
				"          {Vendor Repair Time},",
				"          {Warehouse Code},",
				"          {Warranty Status},",
				"          {Time In Hold Status},",
				"          {Time In Open Status},",
				"          {Time In Repair},",
				"          {DRO TAT SHIP DATE},",
				"          {Age Bus Days (Rcvd Date)},",
				"          {Ship Date},",
				"          {Line Quantity},",
				"          {Nmr Customer},",
				"          {Repair Order Promised Date},",
				"          {Repair$Tat Adj},",
				"          {Repair$Vendor Name},",
				"          {Failure Cause Code},",
				"          {Actual Shipment Date},",
				"          {Actual Start Date},",
				"          {AMS Item Name},",
				"          {Approval Date},",
				"          {Avg Addl Funds},",
				"          {Closure Status},",
				"          {Concat_NMR Details},",
				"          {Contract Number},",
				"          {Contract Warranty End Date},",
				"          {Customer Name},",
				"          {DRO Po Number},",
				"          {Failure Date},",
				"          {Failure Site},",
				"          {Item Number},",
				"          {Line Number},",
				"          {Line Status},",
				"          {NMR Creation Date},",
				"          {NMR DATE CLOSED_DETCLOSED},",
				"          {Nmr Det Action Taken},",
				"          {Nmr Det Date Action Taken},",
				"          {Nmr Det Date Closed},",
				"          {Nmr Det Desc Of Def},",
				"          {Nmr Det Dispo},",
				"          {Nmr Det Line Creation Date},",
				"          {Nmr Det Oper Name},",
				"          {NMR Det Repair Action},",
				"          {Nmr Det Sn},",
				"          {Nmr Nmr Date Closed},",
				"          {NMR Originator},",
				"          {Nmr Parent Nmr},",
				"          {Nmr Parent Sn},",
				"          {Nmr Pgm},",
				"          {Nmr Pn},",
				"          {Nmr Pn Desc},",
				"          {Nmr Po Receipt Date},",
				"          {NMR RMA Line No},",
				"          {Nmr Sn},",
				"          {Nmr Warranty},",
				"          {Om Or Pc},",
				"          {Order Date},",
				"          {Organization Code},",
				"          {Po Approved Date},",
				"          {Po Item Description},",
				"          {Po Line Creation Date},",
				"          {Po Line Number},",
				"          {Po Line Type},",
				"          {Po Revision Number},",
				"          {PO Unit Price},",
				"          {Po Warranty Status},",
				"          Preparer,",
				"          {Price List},",
				"          {Quantity Shipped},",
				"          {Repair Item Serial Number},",
				"          {Repair Line Id},",
				"          {Repair Type Reference},",
				"          {Repair$Actual Repair Price},",
				"          {Repair$Metric Completion Date},",
				"          {Repair$Tat Adj Reason},",
				"          {Report Symptom},",
				"          {Req Create Date},",
				"          {Requisition Approval Date},",
				"          {Requisition Created By},",
				"          {Rma Creation Date},",
				"          {Salesforce Num},",
				"          {Service Request Number},",
				"          {Ship To Address1},",
				"          {Ship To City},",
				"          {Ship To State},",
				"          {Sold To Customer Name},",
				"          {Sr Group Name},",
				"          {Sr Item Serial Number},",
				"          {Sr Status},",
				"          {Times Returned},",
				"          {Total Actual Amount},",
				"          {Total Estimate Amount},",
				"          {Unit Selling Price},",
				"          {Vendor Pn},",
				"          {Vendor RMA},",
				"          {ViaSat NMR},",
				"          {ViaSat Parent RMA},",
				"          {ViaSat RMA},",
				"          {Item Revision},",
				"          {Complete Date},",
				"          {PO Closed Date},",
				"          {Nmr Det Def Desc},",
				"          {3PL RMA},",
				"          {RTV Ship Date},",
				"          {RTV Receipt Date},",
				"          {VENDOR AGE (Bus Day)},",
				"          {Right_Org Avg Item Cost},",
				"          {Right_Cancelled Quantity},",
				"          {Right_Line Cancelled Flag},",
				"          {Right_Unit Selling Price OM},",
				"          {Right_RTV Receipt Date},",
				"          {Right_RTV Ship Date},",
				"          {Right_3PL RMA},",
				"          {Right_Task Number2},",
				"          {RMA Received Date},",
				"          {Left_Right_NMR Det Repair Action},",
				"          {Task Number2},",
				"          {Unit Selling Price OM},",
				"          {Cancelled Quantity},",
				"          {Line Cancelled Flag},",
				"          {Org Avg Item Cost},",
				"          {Right_RMA Received Date},",
				"          {Right_Nmr Det Def Desc},",
				"          {Right_Right_NMR Det Repair Action},",
				"          CREATERCVDTIME,",
				"          DateBetweenCREATERCVD",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select9csv1",
				"select9csv1, select1csv2 join(DateBetweenCREATERCVD == Date,",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join4csv1",
				"join4csv1 select(mapColumn(",
				"          {Arrived at Vendor Date},",
				"          {Business Area},",
				"          {Buyer Name},",
				"          {Age Bus Days (Start Date)},",
				"          {Customer Po Number},",
				"          {DRO Receive Date},",
				"          {Item Description},",
				"          {Line Creation Date},",
				"          {NMR Number},",
				"          Notes,",
				"          {Order Type Name},",
				"          {Product Line},",
				"          {Promised Date},",
				"          {Received from Vendor Date},",
				"          {Repair Number},",
				"          {Repair Order Closed Date},",
				"          {Repair Order Creation Date},",
				"          {Repair Order Project},",
				"          {Repair Order Task},",
				"          {Repair Owner Name},",
				"          {Repair Quantity},",
				"          {Repair Reason},",
				"          {Repair Status},",
				"          {Repair Type},",
				"          {Requested Date},",
				"          {Requisition Line Number},",
				"          {Requisition Number},",
				"          {RMA Nbr/Order Nbr},",
				"          {RTV Hold End Date},",
				"          {RTV Hold Start Date},",
				"          {RTV PO Number},",
				"          {RTV Supplier SN},",
				"          {Scheduled Ship Date},",
				"          {Ship From Location},",
				"          {Ship To Country},",
				"          {Ship To Customer Name},",
				"          {Ship To Location},",
				"          {Shipped from Vendor Date},",
				"          {Shipped Quantity},",
				"          {Sr Owner Name},",
				"          {Vendor Hold Time},",
				"          {Vendor Repair Time},",
				"          {Warehouse Code},",
				"          {Warranty Status},",
				"          {Time In Hold Status},",
				"          {Time In Open Status},",
				"          {Time In Repair},",
				"          {DRO TAT SHIP DATE},",
				"          {Age Bus Days (Rcvd Date)},",
				"          {Ship Date},",
				"          {Line Quantity},",
				"          {Nmr Customer},",
				"          {Repair Order Promised Date},",
				"          {Repair$Tat Adj},",
				"          {Repair$Vendor Name},",
				"          {Failure Cause Code},",
				"          {Actual Shipment Date},",
				"          {Actual Start Date},",
				"          {AMS Item Name},",
				"          {Approval Date},",
				"          {Avg Addl Funds},",
				"          {Closure Status},",
				"          {Concat_NMR Details},",
				"          {Contract Number},",
				"          {Contract Warranty End Date},",
				"          {Customer Name},",
				"          {DRO Po Number},",
				"          {Failure Date},",
				"          {Failure Site},",
				"          {Item Number},",
				"          {Line Number},",
				"          {Line Status},",
				"          {NMR Creation Date},",
				"          {NMR DATE CLOSED_DETCLOSED},",
				"          {Nmr Det Action Taken},",
				"          {Nmr Det Date Action Taken},",
				"          {Nmr Det Date Closed},",
				"          {Nmr Det Desc Of Def},",
				"          {Nmr Det Dispo},",
				"          {Nmr Det Line Creation Date},",
				"          {Nmr Det Oper Name},",
				"          {NMR Det Repair Action},",
				"          {Nmr Det Sn},",
				"          {Nmr Nmr Date Closed},",
				"          {NMR Originator},",
				"          {Nmr Parent Nmr},",
				"          {Nmr Parent Sn},",
				"          {Nmr Pgm},",
				"          {Nmr Pn},",
				"          {Nmr Pn Desc},",
				"          {Nmr Po Receipt Date},",
				"          {NMR RMA Line No},",
				"          {Nmr Sn},",
				"          {Nmr Warranty},",
				"          {Om Or Pc},",
				"          {Order Date},",
				"          {Organization Code},",
				"          {Po Approved Date},",
				"          {Po Item Description},",
				"          {Po Line Creation Date},",
				"          {Po Line Number},",
				"          {Po Line Type},",
				"          {Po Revision Number},",
				"          {PO Unit Price},",
				"          {Po Warranty Status},",
				"          Preparer,",
				"          {Price List},",
				"          {Quantity Shipped},",
				"          {Repair Item Serial Number},",
				"          {Repair Line Id},",
				"          {Repair Type Reference},",
				"          {Repair$Actual Repair Price},",
				"          {Repair$Metric Completion Date},",
				"          {Repair$Tat Adj Reason},",
				"          {Report Symptom},",
				"          {Req Create Date},",
				"          {Requisition Approval Date},",
				"          {Requisition Created By},",
				"          {Rma Creation Date},",
				"          {Salesforce Num},",
				"          {Service Request Number},",
				"          {Ship To Address1},",
				"          {Ship To City},",
				"          {Ship To State},",
				"          {Sold To Customer Name},",
				"          {Sr Group Name},",
				"          {Sr Item Serial Number},",
				"          {Sr Status},",
				"          {Times Returned},",
				"          {Total Actual Amount},",
				"          {Total Estimate Amount},",
				"          {Unit Selling Price},",
				"          {Vendor Pn},",
				"          {Vendor RMA},",
				"          {ViaSat NMR},",
				"          {ViaSat Parent RMA},",
				"          {ViaSat RMA},",
				"          {Item Revision},",
				"          {Complete Date},",
				"          {PO Closed Date},",
				"          {Nmr Det Def Desc},",
				"          {3PL RMA},",
				"          {RTV Ship Date},",
				"          {RTV Receipt Date},",
				"          {VENDOR AGE (Bus Day)},",
				"          {Right_Org Avg Item Cost},",
				"          {Right_Cancelled Quantity},",
				"          {Right_Line Cancelled Flag},",
				"          {Right_Unit Selling Price OM},",
				"          {Right_RTV Receipt Date},",
				"          {Right_RTV Ship Date},",
				"          {Right_3PL RMA},",
				"          {Right_Task Number2},",
				"          {RMA Received Date},",
				"          {Left_Right_NMR Det Repair Action},",
				"          {Task Number2},",
				"          {Unit Selling Price OM},",
				"          {Cancelled Quantity},",
				"          {Line Cancelled Flag},",
				"          {Org Avg Item Cost},",
				"          {Right_RMA Received Date},",
				"          {Right_Nmr Det Def Desc},",
				"          {Right_Right_NMR Det Repair Action},",
				"          CREATERCVDTIME,",
				"          DateBetweenCREATERCVD,",
				"          Date,",
				"          MonthYear,",
				"          YearMonth,",
				"          LastDayOfMonth,",
				"          FiscalYearQuarter,",
				"          FiscalYear,",
				"          IsBusinessDay,",
				"          WeekEndingDate_Sunday",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select10csv1",
				"select10csv1 filter(IsBusinessDay >= 1) ~> filter7csv1",
				"filter7csv1 filter(dayOfWeek(DateBetweenCREATERCVD) != 1 && dayOfWeek(DateBetweenCREATERCVD) != 7) ~> filter8csv1",
				"filter8csv1 aggregate(groupBy({3PL RMA},",
				"          {Actual Shipment Date},",
				"          {Actual Start Date},",
				"          {Age Bus Days (Rcvd Date)},",
				"          {Age Bus Days (Start Date)},",
				"          {AMS Item Name},",
				"          {Approval Date},",
				"          {Arrived at Vendor Date},",
				"          {Avg Addl Funds},",
				"          {Business Area},",
				"          {Buyer Name},",
				"          {Closure Status},",
				"          {Complete Date},",
				"          {Concat_NMR Details},",
				"          {Contract Number},",
				"          {Contract Warranty End Date},",
				"          {Customer Name},",
				"          {Customer Po Number},",
				"          {DRO Po Number},",
				"          {DRO Receive Date},",
				"          {DRO TAT SHIP DATE},",
				"          {Failure Cause Code},",
				"          {Failure Date},",
				"          {Failure Site},",
				"          {Item Description},",
				"          {Item Number},",
				"          {Item Revision},",
				"          {Line Creation Date},",
				"          {Line Number},",
				"          {Line Quantity},",
				"          {Line Status},",
				"          {NMR Creation Date},",
				"          {Nmr Customer},",
				"          {NMR DATE CLOSED_DETCLOSED},",
				"          {Nmr Det Action Taken},",
				"          {Nmr Det Date Action Taken},",
				"          {Nmr Det Date Closed},",
				"          {Nmr Det Def Desc},",
				"          {Nmr Det Desc Of Def},",
				"          {Nmr Det Dispo},",
				"          {Nmr Det Line Creation Date},",
				"          {Nmr Det Oper Name},",
				"          {NMR Det Repair Action},",
				"          {Nmr Det Sn},",
				"          {Nmr Nmr Date Closed},",
				"          {NMR Number},",
				"          {NMR Originator},",
				"          {Nmr Parent Nmr},",
				"          {Nmr Parent Sn},",
				"          {Nmr Pgm},",
				"          {Nmr Pn},",
				"          {Nmr Pn Desc},",
				"          {Nmr Po Receipt Date},",
				"          {NMR RMA Line No},",
				"          {Nmr Sn},",
				"          {Nmr Warranty},",
				"          Notes,",
				"          {Om Or Pc},",
				"          {Order Date},",
				"          {Order Type Name},",
				"          {Organization Code},",
				"          {Po Approved Date},",
				"          {PO Closed Date},",
				"          {Po Item Description},",
				"          {Po Line Creation Date},",
				"          {Po Line Number},",
				"          {Po Line Type},",
				"          {Po Revision Number},",
				"          {PO Unit Price},",
				"          {Po Warranty Status},",
				"          Preparer,",
				"          {Price List},",
				"          {Product Line},",
				"          {Promised Date},",
				"          {Quantity Shipped},",
				"          {Received from Vendor Date},",
				"          {Repair Item Serial Number},",
				"          {Repair Line Id},",
				"          {Repair Number},",
				"          {Repair Order Closed Date},",
				"          {Repair Order Creation Date},",
				"          {Repair Order Project},",
				"          {Repair Order Promised Date},",
				"          {Repair Order Task},",
				"          {Repair Owner Name},",
				"          {Repair Quantity},",
				"          {Repair Reason},",
				"          {Repair Status},",
				"          {Repair Type},",
				"          {Repair Type Reference},",
				"          {Repair$Actual Repair Price},",
				"          {Repair$Metric Completion Date},",
				"          {Repair$Tat Adj},",
				"          {Repair$Tat Adj Reason},",
				"          {Repair$Vendor Name},",
				"          {Report Symptom},",
				"          {Req Create Date},",
				"          {Requested Date},",
				"          {Requisition Approval Date},",
				"          {Requisition Created By},",
				"          {Requisition Line Number},",
				"          {Requisition Number},",
				"          {Rma Creation Date},",
				"          {RMA Nbr/Order Nbr},",
				"          {RTV Hold End Date},",
				"          {RTV Hold Start Date},",
				"          {RTV PO Number},",
				"          {RTV Receipt Date},",
				"          {RTV Ship Date},",
				"          {RTV Supplier SN},",
				"          {Salesforce Num},",
				"          {Scheduled Ship Date},",
				"          {Service Request Number},",
				"          {Ship Date},",
				"          {Ship From Location},",
				"          {Ship To Address1},",
				"          {Ship To City},",
				"          {Ship To Country},",
				"          {Ship To Customer Name},",
				"          {Ship To Location},",
				"          {Ship To State},",
				"          {Shipped from Vendor Date},",
				"          {Shipped Quantity},",
				"          {Sold To Customer Name},",
				"          {Sr Group Name},",
				"          {Sr Item Serial Number},",
				"          {Sr Owner Name},",
				"          {Sr Status},",
				"          {Time In Hold Status},",
				"          {Time In Open Status},",
				"          {Time In Repair},",
				"          {Times Returned},",
				"          {Total Actual Amount},",
				"          {Total Estimate Amount},",
				"          {Unit Selling Price},",
				"          {VENDOR AGE (Bus Day)},",
				"          {Vendor Pn},",
				"          {Vendor Repair Time},",
				"          {Vendor RMA},",
				"          {ViaSat NMR},",
				"          {ViaSat Parent RMA},",
				"          {ViaSat RMA},",
				"          {Warehouse Code},",
				"          {Warranty Status}),",
				"     {Incoming Days} = count(CREATERCVDTIME)) ~> aggregate4",
				"derivedClumn6csv1 split(!(isNull({Repair Order Creation Date})),",
				"     disjoint: false) ~> split3@(spilt5inputcsv1, spilt6inputcsv1)",
				"aggregate4, split3@spilt6inputcsv1 union(byName: true)~> union2",
				"union2 select(mapColumn(",
				"          {3PL RMA},",
				"          {Actual Shipment Date},",
				"          {Actual Start Date},",
				"          {Age Bus Days (Rcvd Date)},",
				"          {Age Bus Days (Start Date)},",
				"          {AMS Item Name},",
				"          {Approval Date},",
				"          {Arrived at Vendor Date},",
				"          {Avg Addl Funds},",
				"          {Business Area},",
				"          {Buyer Name},",
				"          {Closure Status},",
				"          {Complete Date},",
				"          {Concat_NMR Details},",
				"          {Contract Number},",
				"          {Contract Warranty End Date},",
				"          {Customer Name},",
				"          {Customer Po Number},",
				"          {DRO Po Number},",
				"          {DRO Receive Date},",
				"          {DRO TAT SHIP DATE},",
				"          {Failure Cause Code},",
				"          {Failure Date},",
				"          {Failure Site},",
				"          {Item Description},",
				"          {Item Number},",
				"          {Item Revision},",
				"          {Line Creation Date},",
				"          {Line Number},",
				"          {Line Quantity},",
				"          {Line Status},",
				"          {NMR Creation Date},",
				"          {Nmr Customer},",
				"          {NMR DATE CLOSED_DETCLOSED},",
				"          {Nmr Det Action Taken},",
				"          {Nmr Det Date Action Taken},",
				"          {Nmr Det Date Closed},",
				"          {Nmr Det Def Desc},",
				"          {Nmr Det Desc Of Def},",
				"          {Nmr Det Dispo},",
				"          {Nmr Det Line Creation Date},",
				"          {Nmr Det Oper Name},",
				"          {NMR Det Repair Action},",
				"          {Nmr Det Sn},",
				"          {Nmr Nmr Date Closed},",
				"          {NMR Number},",
				"          {NMR Originator},",
				"          {Nmr Parent Nmr},",
				"          {Nmr Parent Sn},",
				"          {Nmr Pgm},",
				"          {Nmr Pn},",
				"          {Nmr Pn Desc},",
				"          {Nmr Po Receipt Date},",
				"          {NMR RMA Line No},",
				"          {Nmr Sn},",
				"          {Nmr Warranty},",
				"          Notes,",
				"          {Om Or Pc},",
				"          {Order Date},",
				"          {Order Type Name},",
				"          {Organization Code},",
				"          {Po Approved Date},",
				"          {PO Closed Date},",
				"          {Po Item Description},",
				"          {Po Line Creation Date},",
				"          {Po Line Number},",
				"          {Po Line Type},",
				"          {Po Revision Number},",
				"          {PO Unit Price},",
				"          {Po Warranty Status},",
				"          Preparer,",
				"          {Price List},",
				"          {Product Line},",
				"          {Promised Date},",
				"          {Quantity Shipped},",
				"          {Received from Vendor Date},",
				"          {Repair Item Serial Number},",
				"          {Repair Line Id},",
				"          {Repair Number},",
				"          {Repair Order Closed Date},",
				"          {Repair Order Creation Date},",
				"          {Repair Order Project},",
				"          {Repair Order Promised Date},",
				"          {Repair Order Task},",
				"          {Repair Owner Name},",
				"          {Repair Quantity},",
				"          {Repair Reason},",
				"          {Repair Status},",
				"          {Repair Type},",
				"          {Repair Type Reference},",
				"          {Repair$Actual Repair Price},",
				"          {Repair$Metric Completion Date},",
				"          {Repair$Tat Adj},",
				"          {Repair$Tat Adj Reason},",
				"          {Repair$Vendor Name},",
				"          {Report Symptom},",
				"          {Req Create Date},",
				"          {Requested Date},",
				"          {Requisition Approval Date},",
				"          {Requisition Created By},",
				"          {Requisition Line Number},",
				"          {Requisition Number},",
				"          {Rma Creation Date},",
				"          {RMA Nbr/Order Nbr},",
				"          {RTV Hold End Date},",
				"          {RTV Hold Start Date},",
				"          {RTV PO Number},",
				"          {RTV Receipt Date},",
				"          {RTV Ship Date},",
				"          {RTV Supplier SN},",
				"          {Salesforce Num},",
				"          {Scheduled Ship Date},",
				"          {Service Request Number},",
				"          {Ship Date},",
				"          {Ship From Location},",
				"          {Ship To Address1},",
				"          {Ship To City},",
				"          {Ship To Country},",
				"          {Ship To Customer Name},",
				"          {Ship To Location},",
				"          {Ship To State},",
				"          {Shipped from Vendor Date},",
				"          {Shipped Quantity},",
				"          {Sold To Customer Name},",
				"          {Sr Group Name},",
				"          {Sr Item Serial Number},",
				"          {Sr Owner Name},",
				"          {Sr Status},",
				"          {Time In Hold Status},",
				"          {Time In Open Status},",
				"          {Time In Repair},",
				"          {Times Returned},",
				"          {Total Actual Amount},",
				"          {Total Estimate Amount},",
				"          {Unit Selling Price},",
				"          {VENDOR AGE (Bus Day)},",
				"          {Vendor Pn},",
				"          {Vendor Repair Time},",
				"          {Vendor RMA},",
				"          {ViaSat NMR},",
				"          {ViaSat Parent RMA},",
				"          {ViaSat RMA},",
				"          {Warehouse Code},",
				"          {Warranty Status},",
				"          {Incoming Days},",
				"          {Vendor Hold Time},",
				"          {Right_Org Avg Item Cost},",
				"          {Right_Cancelled Quantity},",
				"          {Right_Line Cancelled Flag},",
				"          {Right_Unit Selling Price OM},",
				"          {Right_RTV Receipt Date},",
				"          {Right_RTV Ship Date},",
				"          {Right_3PL RMA},",
				"          {Right_Task Number2},",
				"          {RMA Received Date},",
				"          {Left_Right_NMR Det Repair Action},",
				"          {Task Number2},",
				"          {Unit Selling Price OM},",
				"          {Cancelled Quantity},",
				"          {Line Cancelled Flag},",
				"          {Org Avg Item Cost},",
				"          {Right_RMA Received Date},",
				"          {Right_Nmr Det Def Desc},",
				"          {Right_Right_NMR Det Repair Action}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select11csv1",
				"select11csv1 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     partitionFileNames:['Antenna_systems TAT Run'],",
				"     umask: 0022,",
				"     preCommands: [],",
				"     postCommands: [],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     partitionBy('hash', 1)) ~> antennasystemsp2output3",
				"select11csv1 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     umask: 0022,",
				"     preCommands: [],",
				"     postCommands: [],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> antennasystemsp2output4"
			]
		}
	}
}