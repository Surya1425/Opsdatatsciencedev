{
	"name": "Antenn_Systems_Excel_Tableau_Push_df",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "ds_csv_input",
						"type": "DatasetReference"
					},
					"name": "CSDG0REPAIRHISTORYVSAT"
				},
				{
					"dataset": {
						"referenceName": "ds_csv_input",
						"type": "DatasetReference"
					},
					"name": "antennasystemsp2output3"
				},
				{
					"dataset": {
						"referenceName": "ds_csv_input",
						"type": "DatasetReference"
					},
					"name": "Datedimension"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "ds_AzSql",
						"type": "DatasetReference"
					},
					"name": "sink1"
				},
				{
					"name": "sink5"
				},
				{
					"name": "sink6"
				},
				{
					"name": "sink7"
				},
				{
					"name": "sink8"
				},
				{
					"name": "sink9"
				},
				{
					"name": "sink10"
				},
				{
					"name": "sink11"
				},
				{
					"name": "sink12"
				}
			],
			"transformations": [
				{
					"name": "select1"
				},
				{
					"name": "formula1"
				},
				{
					"name": "select2"
				},
				{
					"name": "Transpose1"
				},
				{
					"name": "aggregate1"
				},
				{
					"name": "crosstab"
				},
				{
					"name": "derivedColumn2"
				},
				{
					"name": "select7"
				},
				{
					"name": "join2"
				},
				{
					"name": "select8"
				},
				{
					"name": "derivedColumn3"
				},
				{
					"name": "derivedColumn4"
				},
				{
					"name": "select10"
				},
				{
					"name": "sort1"
				},
				{
					"name": "derivedColumn5"
				},
				{
					"name": "aggregate3"
				},
				{
					"name": "derivedColumn6"
				},
				{
					"name": "derivedColumn7"
				},
				{
					"name": "sort2"
				},
				{
					"name": "select11"
				},
				{
					"name": "derivedColumn8"
				},
				{
					"name": "select12"
				},
				{
					"name": "derivedColumn9"
				},
				{
					"name": "select13"
				},
				{
					"name": "derivedColumn10"
				},
				{
					"name": "sort3"
				},
				{
					"name": "derivedColumn11"
				},
				{
					"name": "filter3"
				},
				{
					"name": "select14"
				},
				{
					"name": "join3"
				},
				{
					"name": "filter4"
				},
				{
					"name": "filter5"
				},
				{
					"name": "aggregate4"
				},
				{
					"name": "derivedColumn12"
				},
				{
					"name": "derivedColumn13"
				},
				{
					"name": "window1"
				},
				{
					"name": "derivedColumn14"
				},
				{
					"name": "sort4"
				},
				{
					"name": "window2"
				},
				{
					"name": "derivedColumn15"
				},
				{
					"name": "aggregate5"
				},
				{
					"name": "select15"
				},
				{
					"name": "derivedColumn16"
				},
				{
					"name": "join4"
				},
				{
					"name": "select16"
				},
				{
					"name": "split2"
				},
				{
					"name": "split4"
				},
				{
					"name": "split5"
				},
				{
					"name": "filter15"
				},
				{
					"name": "filter22"
				},
				{
					"name": "select18"
				},
				{
					"name": "join5"
				},
				{
					"name": "filter23"
				},
				{
					"name": "filter24"
				},
				{
					"name": "aggregate6"
				},
				{
					"name": "select19"
				},
				{
					"name": "select20"
				},
				{
					"name": "sort7"
				},
				{
					"name": "select21"
				},
				{
					"name": "filter25"
				},
				{
					"name": "filter26"
				},
				{
					"name": "split9"
				},
				{
					"name": "filter28"
				},
				{
					"name": "split10"
				},
				{
					"name": "filter32"
				},
				{
					"name": "split11"
				},
				{
					"name": "filter34"
				},
				{
					"name": "split12"
				},
				{
					"name": "filter36"
				},
				{
					"name": "filter37"
				},
				{
					"name": "filter38"
				},
				{
					"name": "select22"
				},
				{
					"name": "select23"
				},
				{
					"name": "MapDrifted1",
					"description": "Creates an explicit mapping for each drifted column"
				},
				{
					"name": "derivedColumn17"
				},
				{
					"name": "filter1"
				},
				{
					"name": "flatten1"
				},
				{
					"name": "union1"
				},
				{
					"name": "union2"
				},
				{
					"name": "filter39"
				},
				{
					"name": "union3"
				},
				{
					"name": "filter40"
				},
				{
					"name": "filter41"
				},
				{
					"name": "filter42"
				},
				{
					"name": "union4"
				},
				{
					"name": "filter43"
				},
				{
					"name": "union5"
				},
				{
					"name": "filter44"
				},
				{
					"name": "union6"
				},
				{
					"name": "union7"
				},
				{
					"name": "sort8"
				},
				{
					"name": "derivedColumn18"
				},
				{
					"name": "flatten2"
				},
				{
					"name": "derivedColumn19"
				},
				{
					"name": "flatten3"
				},
				{
					"name": "union9"
				}
			],
			"scriptLines": [
				"source(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> CSDG0REPAIRHISTORYVSAT",
				"source(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> antennasystemsp2output3",
				"source(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> Datedimension",
				"CSDG0REPAIRHISTORYVSAT select(mapColumn(",
				"          EVENT_DATE,",
				"          EVENT_DETAILS,",
				"          REPAIR_LINE_ID,",
				"          REPAIR_NUMBER",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select1",
				"select1 derive({Hold Start Date RO} = toDate(iif(regexMatch(EVENT_DETAILS, 'Updated Status: Hold'),EVENT_DATE,'')),",
				"          {Hold End Date RO} = toDate(iif(regexMatch(EVENT_DETAILS, 'Previous Status: Hold'),EVENT_DATE,''))) ~> formula1",
				"formula1 select(mapColumn(",
				"          REPAIR_LINE_ID,",
				"          REPAIR_NUMBER,",
				"          {Hold Start Date RO},",
				"          {Hold End Date RO}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select2",
				"select2 unpivot(output(",
				"          Name as string,",
				"          Value as date",
				"     ),",
				"     ungroupBy(REPAIR_LINE_ID,",
				"          REPAIR_NUMBER),",
				"     lateral: true,",
				"     ignoreNullPivots: false) ~> Transpose1",
				"Transpose1 aggregate(groupBy(Name,",
				"          REPAIR_LINE_ID,",
				"          REPAIR_NUMBER),",
				"     Max_Value = max(Value)) ~> aggregate1",
				"aggregate1 pivot(groupBy(REPAIR_LINE_ID,",
				"          REPAIR_NUMBER),",
				"     pivotBy(Name),",
				"     {} = first(Max_Value),",
				"     columnNaming: '$N$V',",
				"     lateral: true) ~> crosstab",
				"select23 derive({Hold End Date RO} = iif(isNull({Hold End Date RO}),currentDate(),{Hold End Date RO})) ~> derivedColumn2",
				"antennasystemsp2output3 select(mapColumn(",
				"          each(match(/* All input columns */true()),",
				"               /* Input name */$$ = $$)",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select7",
				"select7, select20 join({Repair Number} == REPAIR_NUMBER",
				"     && {Repair Line Id} == REPAIR_LINE_ID,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join2",
				"join2 select(mapColumn(",
				"          {3PL RMA},",
				"          {Actual Shipment Date},",
				"          {Actual Start Date},",
				"          {Age Bus Days (Rcvd Date)},",
				"          {AGE Bus Days (Start Date)},",
				"          {AMS Item Name},",
				"          {Approval Date},",
				"          {Arrived at Vendor Date},",
				"          {Avg Addl Funds},",
				"          {Business Area},",
				"          {Buyer Name},",
				"          {Closure Status},",
				"          {Complete Date},",
				"          {Concat_NMR Details},",
				"          {Contract Number},",
				"          {Contract Warranty End Date},",
				"          {Incoming Days},",
				"          {Customer Name},",
				"          {Customer Po Number},",
				"          {DRO Po Number},",
				"          {DRO Receive Date},",
				"          {DRO TAT SHIP DATE},",
				"          {Failure Cause Code},",
				"          {Failure Date},",
				"          {Failure Site},",
				"          {Item Description},",
				"          {Item Number},",
				"          {Item Revision},",
				"          {Line Creation Date},",
				"          {Line Number},",
				"          {Line Quantity},",
				"          {Line Status},",
				"          {NMR Creation Date},",
				"          {Nmr Customer},",
				"          {NMR DATE CLOSED_DETCLOSED},",
				"          {Nmr Det Action Taken},",
				"          {Nmr Det Date Action Taken},",
				"          {Nmr Det Date Closed},",
				"          {Nmr Det Def Desc},",
				"          {Nmr Det Desc Of Def},",
				"          {Nmr Det Dispo},",
				"          {Nmr Det Line Creation Date},",
				"          {Nmr Det Oper Name},",
				"          {NMR Det Repair Action},",
				"          {Nmr Det Sn},",
				"          {Nmr Nmr Date Closed},",
				"          {NMR Number},",
				"          {NMR Originator},",
				"          {Nmr Parent Nmr},",
				"          {Nmr Parent Sn},",
				"          {Nmr Pgm},",
				"          {Nmr Pn},",
				"          {Nmr Pn Desc},",
				"          {Nmr Po Receipt Date},",
				"          {NMR RMA Line No},",
				"          {Nmr Sn},",
				"          {Nmr Warranty},",
				"          Notes,",
				"          {Om Or Pc},",
				"          {Order Date},",
				"          {Order Type Name},",
				"          {Organization Code},",
				"          {Po Approved Date},",
				"          {PO Closed Date},",
				"          {Po Item Description},",
				"          {Po Line Creation Date},",
				"          {Po Line Number},",
				"          {Po Line Type},",
				"          {Po Revision Number},",
				"          {PO Unit Price},",
				"          {Po Warranty Status},",
				"          Preparer,",
				"          {Price List},",
				"          {Product Line},",
				"          {Promised Date},",
				"          {Quantity Shipped},",
				"          {Received from Vendor Date},",
				"          {Repair Item Serial Number},",
				"          {Repair Line Id},",
				"          {Repair Number},",
				"          {Repair Order Closed Date},",
				"          {Repair Order Creation Date},",
				"          {Repair Order Project},",
				"          {Repair Order Promised Date},",
				"          {Repair Order Task},",
				"          {Repair Owner Name},",
				"          {Repair Quantity},",
				"          {Repair Reason},",
				"          {Repair Status},",
				"          {Repair Type},",
				"          {Repair Type Reference},",
				"          {Repair$Actual Repair Price},",
				"          {Repair$Metric Completion Date},",
				"          {Repair$Tat Adj},",
				"          {Repair$Tat Adj Reason},",
				"          {Repair$Vendor Name},",
				"          {Report Symptom},",
				"          {Req Create Date},",
				"          {Requested Date},",
				"          {Requisition Approval Date},",
				"          {Requisition Created By},",
				"          {Requisition Line Number},",
				"          {Requisition Number},",
				"          {Rma Creation Date},",
				"          {RMA Nbr/Order Nbr},",
				"          {RTV Hold End Date},",
				"          {RTV Hold Start Date},",
				"          {RTV PO Number},",
				"          {RTV Receipt Date},",
				"          {RTV Ship Date},",
				"          {RTV Supplier SN},",
				"          {Salesforce Num},",
				"          {Scheduled Ship Date},",
				"          {Service Request Number},",
				"          {Ship Date},",
				"          {Ship From Location},",
				"          {Ship To Address1},",
				"          {Ship To City},",
				"          {Ship To Country},",
				"          {Ship To Customer Name},",
				"          {Ship To Location},",
				"          {Ship To State},",
				"          {Shipped from Vendor Date},",
				"          {Shipped Quantity},",
				"          {Sold To Customer Name},",
				"          {Sr Group Name},",
				"          {Sr Item Serial Number},",
				"          {Sr Owner Name},",
				"          {Sr Status},",
				"          {Time In Hold Status},",
				"          {Time In Open Status},",
				"          {Time In Repair},",
				"          {Times Returned},",
				"          {Total Actual Amount},",
				"          {Total Estimate Amount},",
				"          {Unit Selling Price},",
				"          {VENDOR AGE (Bus Day)},",
				"          {Vendor Hold Time},",
				"          {Vendor Pn},",
				"          {Vendor Repair Time},",
				"          {Vendor RMA},",
				"          {ViaSat NMR},",
				"          {ViaSat Parent RMA},",
				"          {ViaSat RMA},",
				"          {Warehouse Code},",
				"          {Warranty Status},",
				"          {RMA Received Date},",
				"          {Right_RMA Received Date},",
				"          {Task Number2},",
				"          {Right_Nmr Det Def Desc},",
				"          {Right_Right_NMR Det Repair Action},",
				"          {Right_Task Number2},",
				"          {Left_Right_NMR Det Repair Action},",
				"          {Unit Selling Price OM},",
				"          {Right_3PL RMA},",
				"          {Right_RTV Ship Date},",
				"          {Right_RTV Receipt Date},",
				"          {Right_Unit Selling Price OM},",
				"          {Cancelled Quantity},",
				"          {Line$Acceptance Point},",
				"          {Line Cancelled Flag},",
				"          {Org Avg Item Cost},",
				"          {Repo Load Dttm},",
				"          {Right_Cancelled Quantity},",
				"          {Right_Line$Acceptance Point},",
				"          {Right_Line Cancelled Flag},",
				"          {Right_Org Avg Item Cost},",
				"          {Right_Repo Load Dttm},",
				"          {Hold End Date RO},",
				"          {Hold Start Date RO},",
				"          {Hold Age}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select8",
				"select8 derive({Age Bus Days (Rcvd Date)} = toInteger(iif(isNull({Hold Age}),toLong({Age Bus Days (Rcvd Date)}),(toLong({Age Bus Days (Rcvd Date)})-{Hold Age}))),",
				"          {VENDOR AGE (Bus Day)} = toInteger({VENDOR AGE (Bus Day)})-toInteger({Vendor Hold Time}),",
				"          {AGE Bus Days (Start Date)} = toInteger(iif(isNull({Hold Age}),toLong({AGE Bus Days (Start Date)}),(toLong({AGE Bus Days (Start Date)})-{Hold Age}))),",
				"          {Repair Quantity} = toDouble(iif(isNull({Repair Quantity}),{Line Quantity},{Repair Quantity})),",
				"          {Customer Name} = iif(!isNull({Customer Name}),{Customer Name},\r",
				"iif(!isNull({Ship To Customer Name}),{Ship To Customer Name},{Customer Name}))) ~> derivedColumn3",
				"derivedColumn3 derive({Age Bus Days (Rcvd Date)} = toInteger(iif(isNull({Repair$Tat Adj}),{Age Bus Days (Rcvd Date)},(toInteger({Age Bus Days (Rcvd Date)}) + toInteger({Repair$Tat Adj})))),",
				"          {AGE Bus Days (Start Date)} = toInteger(iif(isNull({Repair$Tat Adj}),{AGE Bus Days (Start Date)},(toInteger({AGE Bus Days (Start Date)}) + toInteger({Repair$Tat Adj})))),",
				"          {AGE Bus Days (Actual_RCVD Date)} = toInteger(iif(!isNull({AGE Bus Days (Start Date)}),{AGE Bus Days (Start Date)},\r",
				"iif(!isNull({Age Bus Days (Rcvd Date)}),{Age Bus Days (Rcvd Date)},{AGE Bus Days (Start Date)}))),",
				"          {Report Date} = currentDate(),",
				"          {Warranty Status} = iif(regexMatch({Warranty Status},'IN-WARRANTY'),'In Warranty',\r",
				"iif(regexMatch({Warranty Status},'IN WARRANTY'),'In Warranty',\r",
				"iif(regexMatch({Warranty Status},'OUT-WARRANTY'),'Out of Warranty',\r",
				"iif(regexMatch({Warranty Status},'OUT WARRANTY'),'Out of Warranty',{Warranty Status}))))) ~> derivedColumn4",
				"derivedColumn4 select(mapColumn(",
				"          {3PL RMA},",
				"          {Actual Shipment Date},",
				"          {Actual Start Date},",
				"          {Age Bus Days (Rcvd Date)},",
				"          {AGE Bus Days (Start Date)},",
				"          {AMS Item Name},",
				"          {Approval Date},",
				"          {Arrived at Vendor Date},",
				"          {Avg Addl Funds},",
				"          {Business Area},",
				"          {Buyer Name},",
				"          {Closure Status},",
				"          {Complete Date},",
				"          {Concat_NMR Details},",
				"          {Contract Number},",
				"          {Contract Warranty End Date},",
				"          {Incoming Days},",
				"          {Customer Name},",
				"          {Customer Po Number},",
				"          {DRO Po Number},",
				"          {DRO Receive Date},",
				"          {DRO TAT SHIP DATE},",
				"          {Failure Cause Code},",
				"          {Failure Date},",
				"          {Failure Site},",
				"          {Item Description},",
				"          {Item Number},",
				"          {Item Revision},",
				"          {Line Creation Date},",
				"          {Line Number},",
				"          {Line Quantity},",
				"          {Line Status},",
				"          {NMR Creation Date},",
				"          {Nmr Customer},",
				"          {NMR DATE CLOSED_DETCLOSED},",
				"          {Nmr Det Action Taken},",
				"          {Nmr Det Date Action Taken},",
				"          {Nmr Det Date Closed},",
				"          {Nmr Det Def Desc},",
				"          {Nmr Det Desc Of Def},",
				"          {Nmr Det Dispo},",
				"          {Nmr Det Line Creation Date},",
				"          {Nmr Det Oper Name},",
				"          {NMR Det Repair Action},",
				"          {Nmr Det Sn},",
				"          {Nmr Nmr Date Closed},",
				"          {NMR Number},",
				"          {NMR Originator},",
				"          {Nmr Parent Nmr},",
				"          {Nmr Parent Sn},",
				"          {Nmr Pgm},",
				"          {Nmr Pn},",
				"          {Nmr Pn Desc},",
				"          {Nmr Po Receipt Date},",
				"          {NMR RMA Line No},",
				"          {Nmr Sn},",
				"          {Nmr Warranty},",
				"          Notes,",
				"          {Om Or Pc},",
				"          {Order Date},",
				"          {Order Type Name},",
				"          {Organization Code},",
				"          {Po Approved Date},",
				"          {PO Closed Date},",
				"          {Po Item Description},",
				"          {Po Line Creation Date},",
				"          {Po Line Number},",
				"          {Po Line Type},",
				"          {Po Revision Number},",
				"          {PO Unit Price},",
				"          {Po Warranty Status},",
				"          Preparer,",
				"          {Price List},",
				"          {Product Line},",
				"          {Promised Date},",
				"          {Quantity Shipped},",
				"          {Received from Vendor Date},",
				"          {Repair Item Serial Number},",
				"          {Repair Line Id},",
				"          {Repair Number},",
				"          {Repair Order Closed Date},",
				"          {Repair Order Creation Date},",
				"          {Repair Order Project},",
				"          {Repair Order Promised Date},",
				"          {Repair Order Task},",
				"          {Repair Owner Name},",
				"          {Repair Quantity},",
				"          {Repair Reason},",
				"          {Repair Status},",
				"          {Repair Type},",
				"          {Repair Type Reference},",
				"          {Repair$Actual Repair Price},",
				"          {Repair$Metric Completion Date},",
				"          {Repair$Tat Adj},",
				"          {Repair$Tat Adj Reason},",
				"          {Repair$Vendor Name},",
				"          {Report Symptom},",
				"          {Req Create Date},",
				"          {Requested Date},",
				"          {Requisition Approval Date},",
				"          {Requisition Created By},",
				"          {Requisition Line Number},",
				"          {Requisition Number},",
				"          {Rma Creation Date},",
				"          {RMA Nbr/Order Nbr},",
				"          {RTV Hold End Date},",
				"          {RTV Hold Start Date},",
				"          {RTV PO Number},",
				"          {RTV Receipt Date},",
				"          {RTV Ship Date},",
				"          {RTV Supplier SN},",
				"          {Salesforce Num},",
				"          {Scheduled Ship Date},",
				"          {Service Request Number},",
				"          {Ship Date},",
				"          {Ship From Location},",
				"          {Ship To Address1},",
				"          {Ship To City},",
				"          {Ship To Country},",
				"          {Ship To Customer Name},",
				"          {Ship To Location},",
				"          {Ship To State},",
				"          {Shipped from Vendor Date},",
				"          {Shipped Quantity},",
				"          {Sold To Customer Name},",
				"          {Sr Group Name},",
				"          {Sr Item Serial Number},",
				"          {Sr Owner Name},",
				"          {Sr Status},",
				"          {Time In Hold Status},",
				"          {Time In Open Status},",
				"          {Time In Repair},",
				"          {Times Returned},",
				"          {Total Actual Amount},",
				"          {Total Estimate Amount},",
				"          {Unit Selling Price},",
				"          {VENDOR AGE (Bus Day)},",
				"          {Vendor Hold Time},",
				"          {Vendor Pn},",
				"          {Vendor Repair Time},",
				"          {Vendor RMA},",
				"          {ViaSat NMR},",
				"          {ViaSat Parent RMA},",
				"          {ViaSat RMA},",
				"          {Warehouse Code},",
				"          {Warranty Status},",
				"          {RMA Received Date},",
				"          {Right_RMA Received Date},",
				"          {Task Number2},",
				"          {Right_Nmr Det Def Desc},",
				"          {Right_Right_NMR Det Repair Action},",
				"          {Right_Task Number2},",
				"          {Left_Right_NMR Det Repair Action},",
				"          {Unit Selling Price OM},",
				"          {Right_3PL RMA},",
				"          {Right_RTV Ship Date},",
				"          {Right_RTV Receipt Date},",
				"          {Right_Unit Selling Price OM},",
				"          {Cancelled Quantity},",
				"          {Line$Acceptance Point},",
				"          {Line Cancelled Flag},",
				"          {Org Avg Item Cost},",
				"          {Repo Load Dttm},",
				"          {Right_Cancelled Quantity},",
				"          {Right_Line$Acceptance Point},",
				"          {Right_Line Cancelled Flag},",
				"          {Right_Org Avg Item Cost},",
				"          {Right_Repo Load Dttm},",
				"          {Hold End Date RO},",
				"          {Hold Start Date RO},",
				"          {Hold Age},",
				"          {AGE Bus Days (Actual_RCVD Date)},",
				"          {Report Date}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select10",
				"select10 sort(asc({Customer Name}, true),",
				"     desc({Repair Order Closed Date}, true)) ~> sort1",
				"sort1 derive({Repair Order Creation Date} = toString(toDate({Repair Order Creation Date})),",
				"          {Actual Start Date} = toString(toDate({Actual Start Date})),",
				"          {DRO Receive Date} = toString(toDate({DRO Receive Date})),",
				"          {Complete Date} = toString(toDate({Complete Date})),",
				"          {Repair Order Closed Date} = toString(toDate({Repair Order Closed Date})),",
				"          {Arrived at Vendor Date} = toString(toDate({Arrived at Vendor Date})),",
				"          {Received from Vendor Date} = toString(toDate({Received from Vendor Date})),",
				"          {Repair Order Promised Date} = toString(toDate({Repair Order Promised Date}))) ~> derivedColumn5",
				"derivedColumn5 aggregate(groupBy({Actual Shipment Date},",
				"          {Age Bus Days (Rcvd Date)},",
				"          {AGE Bus Days (Start Date)},",
				"          {AMS Item Name},",
				"          {Approval Date},",
				"          {Avg Addl Funds},",
				"          {Business Area},",
				"          {Buyer Name},",
				"          {Closure Status},",
				"          {Complete Date},",
				"          {Concat_NMR Details},",
				"          {Contract Number},",
				"          {Contract Warranty End Date},",
				"          {Customer Po Number},",
				"          {DRO Po Number},",
				"          {DRO TAT SHIP DATE},",
				"          {Failure Cause Code},",
				"          {Failure Date},",
				"          {Failure Site},",
				"          {Item Description},",
				"          {Item Number},",
				"          {Item Revision},",
				"          {Line Creation Date},",
				"          {Line Number},",
				"          {Line Quantity},",
				"          {Line Status},",
				"          {NMR Creation Date},",
				"          {Nmr Customer},",
				"          {NMR DATE CLOSED_DETCLOSED},",
				"          {Nmr Det Action Taken},",
				"          {Nmr Det Date Action Taken},",
				"          {Nmr Det Date Closed},",
				"          {Nmr Det Desc Of Def},",
				"          {Nmr Det Dispo},",
				"          {Nmr Det Line Creation Date},",
				"          {Nmr Det Oper Name},",
				"          {NMR Det Repair Action},",
				"          {Nmr Det Sn},",
				"          {Nmr Nmr Date Closed},",
				"          {NMR Number},",
				"          {NMR Originator},",
				"          {Nmr Parent Nmr},",
				"          {Nmr Parent Sn},",
				"          {Nmr Pgm},",
				"          {Nmr Pn},",
				"          {Nmr Pn Desc},",
				"          {Nmr Po Receipt Date},",
				"          {NMR RMA Line No},",
				"          {Nmr Sn},",
				"          {Nmr Warranty},",
				"          Notes,",
				"          {Om Or Pc},",
				"          {Order Date},",
				"          {Order Type Name},",
				"          {Organization Code},",
				"          {Po Approved Date},",
				"          {Po Item Description},",
				"          {Po Line Creation Date},",
				"          {Po Line Number},",
				"          {Po Line Type},",
				"          {Po Revision Number},",
				"          {PO Unit Price},",
				"          {Po Warranty Status},",
				"          Preparer,",
				"          {Price List},",
				"          {Product Line},",
				"          {Promised Date},",
				"          {Quantity Shipped},",
				"          {Repair Item Serial Number},",
				"          {Repair Line Id},",
				"          {Repair Number},",
				"          {Repair Order Project},",
				"          {Repair Order Task},",
				"          {Repair Owner Name},",
				"          {Repair Quantity},",
				"          {Repair Reason},",
				"          {Repair Status},",
				"          {Repair Type},",
				"          {Repair Type Reference},",
				"          {Repair$Actual Repair Price},",
				"          {Repair$Metric Completion Date},",
				"          {Repair$Tat Adj},",
				"          {Repair$Tat Adj Reason},",
				"          {Repair$Vendor Name},",
				"          {Report Symptom},",
				"          {Req Create Date},",
				"          {Requested Date},",
				"          {Requisition Approval Date},",
				"          {Requisition Created By},",
				"          {Requisition Line Number},",
				"          {Requisition Number},",
				"          {Rma Creation Date},",
				"          {RMA Nbr/Order Nbr},",
				"          {RTV Hold End Date},",
				"          {RTV Hold Start Date},",
				"          {RTV PO Number},",
				"          {RTV Supplier SN},",
				"          {Salesforce Num},",
				"          {Scheduled Ship Date},",
				"          {Service Request Number},",
				"          {Ship Date},",
				"          {Ship From Location},",
				"          {Ship To Address1},",
				"          {Ship To City},",
				"          {Ship To Country},",
				"          {Sold To Customer Name},",
				"          {Ship To Location},",
				"          {Ship To State},",
				"          {Shipped from Vendor Date},",
				"          {Shipped Quantity},",
				"          {Sr Group Name},",
				"          {Sr Item Serial Number},",
				"          {Sr Owner Name},",
				"          {Sr Status},",
				"          {Time In Hold Status},",
				"          {Time In Open Status},",
				"          {Time In Repair},",
				"          {Times Returned},",
				"          {Total Actual Amount},",
				"          {Total Estimate Amount},",
				"          {Unit Selling Price},",
				"          {VENDOR AGE (Bus Day)},",
				"          {Vendor Hold Time},",
				"          {Vendor Pn},",
				"          {Vendor Repair Time},",
				"          {Vendor RMA},",
				"          {ViaSat NMR},",
				"          {ViaSat Parent RMA},",
				"          {ViaSat RMA},",
				"          {Warehouse Code},",
				"          {Warranty Status},",
				"          {AGE Bus Days (Actual_RCVD Date)},",
				"          {Report Date},",
				"          {Repair Order Creation Date},",
				"          {Actual Start Date},",
				"          {DRO Receive Date},",
				"          {Repair Order Closed Date},",
				"          {Arrived at Vendor Date},",
				"          {Received from Vendor Date},",
				"          {Repair Order Promised Date}),",
				"     each(match(name!='Actual Shipment Date'&&name!='Age Bus Days (Rcvd Date)'&&name!='AGE Bus Days (Start Date)'&&name!='AMS Item Name'&&name!='Approval Date'&&name!='Avg Addl Funds'&&name!='Business Area'&&name!='Buyer Name'&&name!='Closure Status'&&name!='Complete Date'&&name!='Concat_NMR Details'&&name!='Contract Number'&&name!='Contract Warranty End Date'&&name!='Customer Po Number'&&name!='DRO Po Number'&&name!='DRO TAT SHIP DATE'&&name!='Failure Cause Code'&&name!='Failure Date'&&name!='Failure Site'&&name!='Item Description'&&name!='Item Number'&&name!='Item Revision'&&name!='Line Creation Date'&&name!='Line Number'&&name!='Line Quantity'&&name!='Line Status'&&name!='NMR Creation Date'&&name!='Nmr Customer'&&name!='NMR DATE CLOSED_DETCLOSED'&&name!='Nmr Det Action Taken'&&name!='Nmr Det Date Action Taken'&&name!='Nmr Det Date Closed'&&name!='Nmr Det Desc Of Def'&&name!='Nmr Det Dispo'&&name!='Nmr Det Line Creation Date'&&name!='Nmr Det Oper Name'&&name!='NMR Det Repair Action'&&name!='Nmr Det Sn'&&name!='Nmr Nmr Date Closed'&&name!='NMR Number'&&name!='NMR Originator'&&name!='Nmr Parent Nmr'&&name!='Nmr Parent Sn'&&name!='Nmr Pgm'&&name!='Nmr Pn'&&name!='Nmr Pn Desc'&&name!='Nmr Po Receipt Date'&&name!='NMR RMA Line No'&&name!='Nmr Sn'&&name!='Nmr Warranty'&&name!='Notes'&&name!='Om Or Pc'&&name!='Order Date'&&name!='Order Type Name'&&name!='Organization Code'&&name!='Po Approved Date'&&name!='Po Item Description'&&name!='Po Line Creation Date'&&name!='Po Line Number'&&name!='Po Line Type'&&name!='Po Revision Number'&&name!='PO Unit Price'&&name!='Po Warranty Status'&&name!='Preparer'&&name!='Price List'&&name!='Product Line'&&name!='Promised Date'&&name!='Quantity Shipped'&&name!='Repair Item Serial Number'&&name!='Repair Line Id'&&name!='Repair Number'&&name!='Repair Order Project'&&name!='Repair Order Task'&&name!='Repair Owner Name'&&name!='Repair Quantity'&&name!='Repair Reason'&&name!='Repair Status'&&name!='Repair Type'&&name!='Repair Type Reference'&&name!='Repair$Actual Repair Price'&&name!='Repair$Metric Completion Date'&&name!='Repair$Tat Adj'&&name!='Repair$Tat Adj Reason'&&name!='Repair$Vendor Name'&&name!='Report Symptom'&&name!='Req Create Date'&&name!='Requested Date'&&name!='Requisition Approval Date'&&name!='Requisition Created By'&&name!='Requisition Line Number'&&name!='Requisition Number'&&name!='Rma Creation Date'&&name!='RMA Nbr/Order Nbr'&&name!='RTV Hold End Date'&&name!='RTV Hold Start Date'&&name!='RTV PO Number'&&name!='RTV Supplier SN'&&name!='Salesforce Num'&&name!='Scheduled Ship Date'&&name!='Service Request Number'&&name!='Ship Date'&&name!='Ship From Location'&&name!='Ship To Address1'&&name!='Ship To City'&&name!='Ship To Country'&&name!='Sold To Customer Name'&&name!='Ship To Location'&&name!='Ship To State'&&name!='Shipped from Vendor Date'&&name!='Shipped Quantity'&&name!='Sr Group Name'&&name!='Sr Item Serial Number'&&name!='Sr Owner Name'&&name!='Sr Status'&&name!='Time In Hold Status'&&name!='Time In Open Status'&&name!='Time In Repair'&&name!='Times Returned'&&name!='Total Actual Amount'&&name!='Total Estimate Amount'&&name!='Unit Selling Price'&&name!='VENDOR AGE (Bus Day)'&&name!='Vendor Hold Time'&&name!='Vendor Pn'&&name!='Vendor Repair Time'&&name!='Vendor RMA'&&name!='ViaSat NMR'&&name!='ViaSat Parent RMA'&&name!='ViaSat RMA'&&name!='Warehouse Code'&&name!='Warranty Status'&&name!='AGE Bus Days (Actual_RCVD Date)'&&name!='Report Date'&&name!='Repair Order Creation Date'&&name!='Actual Start Date'&&name!='DRO Receive Date'&&name!='Repair Order Closed Date'&&name!='Arrived at Vendor Date'&&name!='Received from Vendor Date'&&name!='Repair Order Promised Date'), $$ = first($$))) ~> aggregate3",
				"aggregate3 derive({Repair Status} = iif(!isNull({Repair Number})&&!isNull({Repair Order Closed Date}),'Closed',{Repair Status})) ~> derivedColumn6",
				"derivedColumn6 derive({Repair Status} = iif(!isNull({NMR DATE CLOSED_DETCLOSED}),'Closed',{Repair Status})) ~> derivedColumn7",
				"derivedColumn7 sort(desc({Repair Order Closed Date}, true)) ~> sort2",
				"sort2 select(mapColumn(",
				"          {Actual Shipment Date},",
				"          {Age Bus Days (Rcvd Date)},",
				"          {AGE Bus Days (Start Date)},",
				"          {AMS Item Name},",
				"          {Approval Date},",
				"          {Avg Addl Funds},",
				"          {Business Area},",
				"          {Buyer Name},",
				"          {Closure Status},",
				"          {Complete Date},",
				"          {Concat_NMR Details},",
				"          {Contract Number},",
				"          {Contract Warranty End Date},",
				"          {Customer Po Number},",
				"          {DRO Po Number},",
				"          {DRO TAT SHIP DATE},",
				"          {Failure Cause Code},",
				"          {Failure Date},",
				"          {Failure Site},",
				"          {Item Description},",
				"          {Item Number},",
				"          {Item Revision},",
				"          {Line Creation Date},",
				"          {Line Number},",
				"          {Line Quantity},",
				"          {Line Status},",
				"          {NMR Creation Date},",
				"          {Nmr Customer},",
				"          {NMR DATE CLOSED_DETCLOSED},",
				"          {Nmr Det Action Taken},",
				"          {Nmr Det Date Action Taken},",
				"          {Nmr Det Date Closed},",
				"          {Nmr Det Desc Of Def},",
				"          {Nmr Det Dispo},",
				"          {Nmr Det Line Creation Date},",
				"          {Nmr Det Oper Name},",
				"          {NMR Det Repair Action},",
				"          {Nmr Det Sn},",
				"          {Nmr Nmr Date Closed},",
				"          {NMR Number},",
				"          {NMR Originator},",
				"          {Nmr Parent Nmr},",
				"          {Nmr Parent Sn},",
				"          {Nmr Pgm},",
				"          {Nmr Pn},",
				"          {Nmr Pn Desc},",
				"          {Nmr Po Receipt Date},",
				"          {NMR RMA Line No},",
				"          {Nmr Sn},",
				"          {Nmr Warranty},",
				"          Notes,",
				"          {Om Or Pc},",
				"          {Order Date},",
				"          {Order Type Name},",
				"          {Organization Code},",
				"          {Po Approved Date},",
				"          {Po Item Description},",
				"          {Po Line Creation Date},",
				"          {Po Line Number},",
				"          {Po Line Type},",
				"          {Po Revision Number},",
				"          {PO Unit Price},",
				"          {Po Warranty Status},",
				"          Preparer,",
				"          {Price List},",
				"          {Product Line},",
				"          {Promised Date},",
				"          {Quantity Shipped},",
				"          {Repair Item Serial Number},",
				"          {Repair Line Id},",
				"          {Repair Number},",
				"          {Repair Order Project},",
				"          {Repair Order Task},",
				"          {Repair Owner Name},",
				"          {Repair Quantity},",
				"          {Repair Reason},",
				"          {Repair Status},",
				"          {Repair Type},",
				"          {Repair Type Reference},",
				"          {Repair$Actual Repair Price},",
				"          {Repair$Metric Completion Date},",
				"          {Repair$Tat Adj},",
				"          {Repair$Tat Adj Reason},",
				"          {Repair$Vendor Name},",
				"          {Report Symptom},",
				"          {Req Create Date},",
				"          {Requested Date},",
				"          {Requisition Approval Date},",
				"          {Requisition Created By},",
				"          {Requisition Line Number},",
				"          {Requisition Number},",
				"          {Rma Creation Date},",
				"          {RMA Nbr/Order Nbr},",
				"          {RTV Hold End Date},",
				"          {RTV Hold Start Date},",
				"          {RTV PO Number},",
				"          {RTV Supplier SN},",
				"          {Salesforce Num},",
				"          {Scheduled Ship Date},",
				"          {Service Request Number},",
				"          {Ship Date},",
				"          {Ship From Location},",
				"          {Ship To Address1},",
				"          {Ship To City},",
				"          {Ship To Country},",
				"          {Sold To Customer Name},",
				"          {Ship To Location},",
				"          {Ship To State},",
				"          {Shipped from Vendor Date},",
				"          {Shipped Quantity},",
				"          {Sr Group Name},",
				"          {Sr Item Serial Number},",
				"          {Sr Owner Name},",
				"          {Sr Status},",
				"          {Time In Hold Status},",
				"          {Time In Open Status},",
				"          {Time In Repair},",
				"          {Times Returned},",
				"          {Total Actual Amount},",
				"          {Total Estimate Amount},",
				"          {Unit Selling Price},",
				"          {VENDOR AGE (Bus Day)},",
				"          {Vendor Hold Time},",
				"          {Vendor Pn},",
				"          {Vendor Repair Time},",
				"          {Vendor RMA},",
				"          {ViaSat NMR},",
				"          {ViaSat Parent RMA},",
				"          {ViaSat RMA},",
				"          {Warehouse Code},",
				"          {Warranty Status},",
				"          {AGE Bus Days (Actual_RCVD Date)},",
				"          {Report Date},",
				"          {Repair Order Creation Date},",
				"          {Actual Start Date},",
				"          {DRO Receive Date},",
				"          {Repair Order Closed Date},",
				"          {Arrived at Vendor Date},",
				"          {Received from Vendor Date},",
				"          {Repair Order Promised Date},",
				"          {3PL RMA},",
				"          {Incoming Days},",
				"          Customer = {Customer Name},",
				"          {Nmr Det Def Desc},",
				"          {PO Closed Date},",
				"          {RTV Receipt Date},",
				"          {RTV Ship Date},",
				"          {Ship To Customer Name},",
				"          {RMA Received Date},",
				"          {Right_RMA Received Date},",
				"          {Task Number2},",
				"          {Right_Nmr Det Def Desc},",
				"          {Right_Right_NMR Det Repair Action},",
				"          {Right_Task Number2},",
				"          {Left_Right_NMR Det Repair Action},",
				"          {Unit Selling Price OM},",
				"          {Right_3PL RMA},",
				"          {Right_RTV Ship Date},",
				"          {Right_RTV Receipt Date},",
				"          {Right_Unit Selling Price OM},",
				"          {Cancelled Quantity},",
				"          {Line$Acceptance Point},",
				"          {Line Cancelled Flag},",
				"          {Org Avg Item Cost},",
				"          {Repo Load Dttm},",
				"          {Right_Cancelled Quantity},",
				"          {Right_Line$Acceptance Point},",
				"          {Right_Line Cancelled Flag},",
				"          {Right_Org Avg Item Cost},",
				"          {Right_Repo Load Dttm},",
				"          {Hold End Date RO},",
				"          {Hold Start Date RO},",
				"          {Hold Age}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select11",
				"select10 derive({DRO TAT SHIP DATE} = toDate({3PL RMA})) ~> derivedColumn8",
				"derivedColumn8 select(mapColumn(",
				"          {3PL RMA},",
				"          {Actual Shipment Date},",
				"          {Actual Start Date},",
				"          {Age Bus Days (Rcvd Date)},",
				"          {AGE Bus Days (Start Date)},",
				"          {AMS Item Name},",
				"          {Approval Date},",
				"          {Arrived at Vendor Date},",
				"          {Avg Addl Funds},",
				"          {Business Area},",
				"          {Buyer Name},",
				"          {Closure Status},",
				"          {Complete Date},",
				"          {Concat_NMR Details},",
				"          {Contract Number},",
				"          {Contract Warranty End Date},",
				"          {Incoming Days},",
				"          Customer = {Customer Name},",
				"          {Customer Po Number},",
				"          {DRO Po Number},",
				"          {DRO Receive Date},",
				"          {DRO TAT SHIP DATE},",
				"          {Failure Cause Code},",
				"          {Failure Date},",
				"          {Failure Site},",
				"          {Item Description},",
				"          {Returned Item} = {Item Number},",
				"          {Item Revision},",
				"          {Line Creation Date},",
				"          {Line Number},",
				"          {Line Quantity},",
				"          {Line Status},",
				"          {NMR Creation Date},",
				"          {Nmr Customer},",
				"          {NMR DATE CLOSED_DETCLOSED},",
				"          {Nmr Det Action Taken},",
				"          {Nmr Det Date Action Taken},",
				"          {Nmr Det Date Closed},",
				"          {Nmr Det Def Desc},",
				"          {Nmr Det Desc Of Def},",
				"          {Nmr Det Dispo},",
				"          {Nmr Det Line Creation Date},",
				"          {Nmr Det Oper Name},",
				"          {NMR Det Repair Action},",
				"          {Nmr Det Sn},",
				"          {Nmr Nmr Date Closed},",
				"          {NMR Number},",
				"          {NMR Originator},",
				"          {Nmr Parent Nmr},",
				"          {Nmr Parent Sn},",
				"          {Nmr Pgm},",
				"          {Nmr Pn},",
				"          {Nmr Pn Desc},",
				"          {Nmr Po Receipt Date},",
				"          {NMR RMA Line No},",
				"          {Nmr Sn},",
				"          {Nmr Warranty},",
				"          Notes,",
				"          {Om Or Pc},",
				"          {Order Date},",
				"          {Order Type Name},",
				"          {Organization Code},",
				"          {Po Approved Date},",
				"          {PO Closed Date},",
				"          {Po Item Description},",
				"          {Po Line Creation Date},",
				"          {Po Line Number},",
				"          {Po Line Type},",
				"          {Po Revision Number},",
				"          {PO Unit Price},",
				"          {Po Warranty Status},",
				"          Preparer,",
				"          {Price List},",
				"          {Product Line},",
				"          {Promised Date},",
				"          {Quantity Shipped},",
				"          {Received from Vendor Date},",
				"          {Returned SN} = {Repair Item Serial Number},",
				"          {Repair Line Id},",
				"          {Repair Number},",
				"          {Repair Order Closed Date},",
				"          {Repair Order Creation Date},",
				"          {Repair Order Project},",
				"          {Repair Order Promised Date},",
				"          {Repair Order Task},",
				"          {Repair Owner Name},",
				"          {Repair Quantity},",
				"          {Repair Reason},",
				"          {Repair Status},",
				"          {Repair Type},",
				"          {Repair Type Reference},",
				"          {Repair$Actual Repair Price},",
				"          {Repair$Metric Completion Date},",
				"          {Repair$Tat Adj},",
				"          {Repair$Tat Adj Reason},",
				"          {Repair Vendor Name} = {Repair$Vendor Name},",
				"          {Report Symptom},",
				"          {Req Create Date},",
				"          {Requested Date},",
				"          {Requisition Approval Date},",
				"          {Requisition Created By},",
				"          {Requisition Line Number},",
				"          {Requisition Number},",
				"          {Rma Creation Date},",
				"          {RMA Nbr/Order Nbr},",
				"          {RTV Hold End Date},",
				"          {RTV Hold Start Date},",
				"          {RTV Po Number} = {RTV PO Number},",
				"          {RTV Receipt Date},",
				"          {RTV Ship Date},",
				"          {RTV Supplier SN},",
				"          {Salesforce Num},",
				"          {Scheduled Ship Date},",
				"          {Service Request Number},",
				"          {Ship Date},",
				"          {Ship From Location},",
				"          {Ship To Address1},",
				"          {Ship To City},",
				"          {Ship To Country},",
				"          {Ship To Customer Name},",
				"          {Ship To Location},",
				"          {Ship To State},",
				"          {Shipped from Vendor Date},",
				"          {Shipped Quantity},",
				"          {Sold To Customer Name},",
				"          {Sr Group Name},",
				"          {Sr Item Serial Number},",
				"          {Sr Owner Name},",
				"          {Sr Status},",
				"          {Time In Hold Status},",
				"          {Time In Open Status},",
				"          {Time In Repair},",
				"          {Times Returned},",
				"          {Total Actual Amount},",
				"          {Total Estimate Amount},",
				"          {Unit Selling Price},",
				"          {VENDOR AGE (Bus Day)},",
				"          {Vendor Hold Time},",
				"          {Vendor Pn},",
				"          {Vendor Repair Time},",
				"          {Vendor RMA},",
				"          {ViaSat NMR},",
				"          {ViaSat Parent RMA},",
				"          {ViaSat RMA},",
				"          {Warehouse Code},",
				"          {Warranty Status},",
				"          {RMA Received Date},",
				"          {Right_RMA Received Date},",
				"          {Task Number2},",
				"          {Right_Nmr Det Def Desc},",
				"          {Right_Right_NMR Det Repair Action},",
				"          {Right_Task Number2},",
				"          {Left_Right_NMR Det Repair Action},",
				"          {Unit Selling Price OM},",
				"          {Right_3PL RMA},",
				"          {Right_RTV Ship Date},",
				"          {Right_RTV Receipt Date},",
				"          {Right_Unit Selling Price OM},",
				"          {Cancelled Quantity},",
				"          {Line$Acceptance Point},",
				"          {Line Cancelled Flag},",
				"          {Org Avg Item Cost},",
				"          {Repo Load Dttm},",
				"          {Right_Cancelled Quantity},",
				"          {Right_Line$Acceptance Point},",
				"          {Right_Line Cancelled Flag},",
				"          {Right_Org Avg Item Cost},",
				"          {Right_Repo Load Dttm},",
				"          {Hold End Date RO},",
				"          {Hold Start Date RO},",
				"          {Hold Age},",
				"          {AGE Bus Days (Actual_RCVD Date)},",
				"          {Report Date}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select12",
				"select12 derive({Business Area} = iif(isNull({Business Area}),'AS',{Business Area}),",
				"          {Product Line} = iif(isNull({Product Line}),'Unknown',{Product Line}),",
				"          {RMA Received Date} = iif(isNull({RMA Received Date}),{DRO Receive Date},{RMA Received Date})) ~> derivedColumn9",
				"derivedColumn9 select(mapColumn(",
				"          {3PL RMA},",
				"          {Actual Shipment Date},",
				"          {Actual Start Date},",
				"          {Age Bus Days (Rcvd Date)},",
				"          {AGE Bus Days (Start Date)},",
				"          {AMS Item Name},",
				"          {Approval Date},",
				"          {Arrived at Vendor Date},",
				"          {Avg Addl Funds},",
				"          {Business Area},",
				"          {Buyer Name},",
				"          {Closure Status},",
				"          {Complete Date},",
				"          {Concat_NMR Details},",
				"          {Contract Number},",
				"          {Contract Warranty End Date},",
				"          {Incoming Days},",
				"          Customer,",
				"          {Customer Po Number},",
				"          {DRO Po Number},",
				"          {DRO Receive Date},",
				"          {DRO TAT SHIP DATE},",
				"          {Failure Cause Code},",
				"          {Failure Date},",
				"          {Failure Site},",
				"          {Item Description},",
				"          {Returned Item},",
				"          {Item Revision},",
				"          {Line Creation Date},",
				"          {Line Number},",
				"          {Line Quantity},",
				"          {Line Status},",
				"          {NMR Creation Date},",
				"          {Nmr Customer},",
				"          {NMR DATE CLOSED_DETCLOSED},",
				"          {Nmr Det Action Taken},",
				"          {Nmr Det Date Action Taken},",
				"          {Nmr Det Date Closed},",
				"          {Nmr Det Def Desc},",
				"          {Nmr Det Desc Of Def},",
				"          {Nmr Det Dispo},",
				"          {Nmr Det Line Creation Date},",
				"          {Nmr Det Oper Name},",
				"          {NMR Det Repair Action},",
				"          {Nmr Det Sn},",
				"          {Nmr Nmr Date Closed},",
				"          {NMR Number},",
				"          {NMR Originator},",
				"          {Nmr Parent Nmr},",
				"          {Nmr Parent Sn},",
				"          {Nmr Pgm},",
				"          {Nmr Pn},",
				"          {Nmr Pn Desc},",
				"          {Nmr Po Receipt Date},",
				"          {NMR RMA Line No},",
				"          {Nmr Sn},",
				"          {Nmr Warranty},",
				"          Notes,",
				"          {Om Or Pc},",
				"          {Order Date},",
				"          {Order Type Name},",
				"          {Organization Code},",
				"          {Po Approved Date},",
				"          {PO Closed Date},",
				"          {Po Item Description},",
				"          {Po Line Creation Date},",
				"          {Po Line Number},",
				"          {Po Line Type},",
				"          {Po Revision Number},",
				"          {PO Unit Price},",
				"          {Po Warranty Status},",
				"          Preparer,",
				"          {Price List},",
				"          {Product Line},",
				"          {Promised Date},",
				"          {Quantity Shipped},",
				"          {Received from Vendor Date},",
				"          {Returned SN},",
				"          {Repair Line Id},",
				"          {Repair Number},",
				"          {Repair Order Closed Date},",
				"          {Repair Order Creation Date},",
				"          {Repair Order Project},",
				"          {Repair Order Promised Date},",
				"          {Repair Order Task},",
				"          {Repair Owner Name},",
				"          {Repair Quantity},",
				"          {Repair Reason},",
				"          {Repair Status},",
				"          {Repair Type},",
				"          {Repair Type Reference},",
				"          {Repair$Actual Repair Price},",
				"          {Repair$Metric Completion Date},",
				"          {Repair$Tat Adj},",
				"          {Repair$Tat Adj Reason},",
				"          {Repair Vendor Name},",
				"          {Report Symptom},",
				"          {Req Create Date},",
				"          {Requested Date},",
				"          {Requisition Approval Date},",
				"          {Requisition Created By},",
				"          {Requisition Line Number},",
				"          {Requisition Number},",
				"          {Rma Creation Date},",
				"          {RMA Nbr/Order Nbr},",
				"          {RTV Hold End Date},",
				"          {RTV Hold Start Date},",
				"          {RTV Po Number},",
				"          {RTV Receipt Date},",
				"          {RTV Ship Date},",
				"          {RTV Supplier SN},",
				"          {Salesforce Num},",
				"          {Scheduled Ship Date},",
				"          {Service Request Number},",
				"          {Ship Date},",
				"          {Ship From Location},",
				"          {Ship To Address1},",
				"          {Ship To City},",
				"          {Ship To Country},",
				"          {Ship To Customer Name},",
				"          {Ship To Location},",
				"          {Ship To State},",
				"          {Shipped from Vendor Date},",
				"          {Shipped Quantity},",
				"          {Sold To Customer Name},",
				"          {Sr Group Name},",
				"          {Sr Item Serial Number},",
				"          {Sr Owner Name},",
				"          {Sr Status},",
				"          {Time In Hold Status},",
				"          {Time In Open Status},",
				"          {Time In Repair},",
				"          {Times Returned},",
				"          {Total Actual Amount},",
				"          {Total Estimate Amount},",
				"          {Unit Selling Price},",
				"          {VENDOR AGE (Bus Day)},",
				"          {Vendor Hold Time},",
				"          {Vendor Pn},",
				"          {Vendor Repair Time},",
				"          {Vendor RMA},",
				"          {ViaSat NMR},",
				"          {ViaSat Parent RMA},",
				"          {ViaSat RMA},",
				"          {Warehouse Code},",
				"          {Warranty Status},",
				"          {RMA Received Date},",
				"          {Right_RMA Received Date},",
				"          {Task Number2},",
				"          {Right_Nmr Det Def Desc},",
				"          {Right_Right_NMR Det Repair Action},",
				"          {Right_Task Number2},",
				"          {Left_Right_NMR Det Repair Action},",
				"          {Unit Selling Price OM},",
				"          {Right_3PL RMA},",
				"          {Right_RTV Ship Date},",
				"          {Right_RTV Receipt Date},",
				"          {Right_Unit Selling Price OM},",
				"          {Cancelled Quantity},",
				"          {Line$Acceptance Point},",
				"          {Line Cancelled Flag},",
				"          {Org Avg Item Cost},",
				"          {Repo Load Dttm},",
				"          {Right_Cancelled Quantity},",
				"          {Right_Line$Acceptance Point},",
				"          {Right_Line Cancelled Flag},",
				"          {Right_Org Avg Item Cost},",
				"          {Right_Repo Load Dttm},",
				"          {Hold End Date RO},",
				"          {Hold Start Date RO},",
				"          {Hold Age},",
				"          {AGE Bus Days (Actual_RCVD Date)},",
				"          {Report Date}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select13",
				"select13 derive({WIP EOM Date} = iif(isNull({Repair Order Closed Date}),currentDate(),toDate({Repair Order Closed Date})),",
				"          {Start_Rcvd Date} = toDate(iif(isNull({Actual Start Date}),{DRO Receive Date},{Actual Start Date}))) ~> derivedColumn10",
				"flatten2 sort(desc({WIP Inventory}, true)) ~> sort3",
				"sort3 derive({In WIP} = iif({Repair Order Closed Date} <= {WIP Inventory},null(),1)) ~> derivedColumn11",
				"derivedColumn10 filter(isNull({Actual Start Date})&&isNull({DRO Receive Date})) ~> filter3",
				"flatten3 select(mapColumn(",
				"          {3PL RMA},",
				"          {Actual Shipment Date},",
				"          {Actual Start Date},",
				"          {Age Bus Days (Rcvd Date)},",
				"          {AGE Bus Days (Start Date)},",
				"          {AMS Item Name},",
				"          {Approval Date},",
				"          {Arrived at Vendor Date},",
				"          {Avg Addl Funds},",
				"          {Business Area},",
				"          {Buyer Name},",
				"          {Closure Status},",
				"          {Complete Date},",
				"          {Concat_NMR Details},",
				"          {Contract Number},",
				"          {Contract Warranty End Date},",
				"          {Incoming Days},",
				"          Customer,",
				"          {Customer Po Number},",
				"          {DRO Po Number},",
				"          {DRO Receive Date},",
				"          {DRO TAT SHIP DATE},",
				"          {Failure Cause Code},",
				"          {Failure Date},",
				"          {Failure Site},",
				"          {Item Description},",
				"          {Returned Item},",
				"          {Item Revision},",
				"          {Line Creation Date},",
				"          {Line Number},",
				"          {Line Quantity},",
				"          {Line Status},",
				"          {NMR Creation Date},",
				"          {Nmr Customer},",
				"          {NMR DATE CLOSED_DETCLOSED},",
				"          {Nmr Det Action Taken},",
				"          {Nmr Det Date Action Taken},",
				"          {Nmr Det Date Closed},",
				"          {Nmr Det Def Desc},",
				"          {Nmr Det Desc Of Def},",
				"          {Nmr Det Dispo},",
				"          {Nmr Det Line Creation Date},",
				"          {Nmr Det Oper Name},",
				"          {NMR Det Repair Action},",
				"          {Nmr Det Sn},",
				"          {Nmr Nmr Date Closed},",
				"          {NMR Number},",
				"          {NMR Originator},",
				"          {Nmr Parent Nmr},",
				"          {Nmr Parent Sn},",
				"          {Nmr Pgm},",
				"          {Nmr Pn},",
				"          {Nmr Pn Desc},",
				"          {Nmr Po Receipt Date},",
				"          {NMR RMA Line No},",
				"          {Nmr Sn},",
				"          {Nmr Warranty},",
				"          Notes,",
				"          {Om Or Pc},",
				"          {Order Date},",
				"          {Order Type Name},",
				"          {Organization Code},",
				"          {Po Approved Date},",
				"          {PO Closed Date},",
				"          {Po Item Description},",
				"          {Po Line Creation Date},",
				"          {Po Line Number},",
				"          {Po Line Type},",
				"          {Po Revision Number},",
				"          {PO Unit Price},",
				"          {Po Warranty Status},",
				"          Preparer,",
				"          {Price List},",
				"          {Product Line},",
				"          {Promised Date},",
				"          {Quantity Shipped},",
				"          {Received from Vendor Date},",
				"          {Returned SN},",
				"          {Repair Line Id},",
				"          {Repair Number},",
				"          {Repair Order Closed Date},",
				"          {Repair Order Creation Date},",
				"          {Repair Order Project},",
				"          {Repair Order Promised Date},",
				"          {Repair Order Task},",
				"          {Repair Owner Name},",
				"          {Repair Quantity},",
				"          {Repair Reason},",
				"          {Repair Status},",
				"          {Repair Type},",
				"          {Repair Type Reference},",
				"          {Repair$Actual Repair Price},",
				"          {Repair$Metric Completion Date},",
				"          {Repair$Tat Adj},",
				"          {Repair$Tat Adj Reason},",
				"          {Repair Vendor Name},",
				"          {Report Symptom},",
				"          {Req Create Date},",
				"          {Requested Date},",
				"          {Requisition Approval Date},",
				"          {Requisition Created By},",
				"          {Requisition Line Number},",
				"          {Requisition Number},",
				"          {Rma Creation Date},",
				"          {RMA Nbr/Order Nbr},",
				"          {RTV Hold End Date},",
				"          {RTV Hold Start Date},",
				"          {RTV Po Number},",
				"          {RTV Receipt Date},",
				"          {RTV Ship Date},",
				"          {RTV Supplier SN},",
				"          {Salesforce Num},",
				"          {Scheduled Ship Date},",
				"          {Service Request Number},",
				"          {Ship Date},",
				"          {Ship From Location},",
				"          {Ship To Address1},",
				"          {Ship To City},",
				"          {Ship To Country},",
				"          {Ship To Customer Name},",
				"          {Ship To Location},",
				"          {Ship To State},",
				"          {Shipped from Vendor Date},",
				"          {Shipped Quantity},",
				"          {Sold To Customer Name},",
				"          {Sr Group Name},",
				"          {Sr Item Serial Number},",
				"          {Sr Owner Name},",
				"          {Sr Status},",
				"          {Time In Hold Status},",
				"          {Time In Open Status},",
				"          {Time In Repair},",
				"          {Times Returned},",
				"          {Total Actual Amount},",
				"          {Total Estimate Amount},",
				"          {Unit Selling Price},",
				"          {VENDOR AGE (Bus Day)},",
				"          {Vendor Hold Time},",
				"          {Vendor Pn},",
				"          {Vendor Repair Time},",
				"          {Vendor RMA},",
				"          {ViaSat NMR},",
				"          {ViaSat Parent RMA},",
				"          {ViaSat RMA},",
				"          {Warehouse Code},",
				"          {Warranty Status},",
				"          {RMA Received Date},",
				"          {Right_RMA Received Date},",
				"          {Task Number2},",
				"          {Right_Nmr Det Def Desc},",
				"          {Right_Right_NMR Det Repair Action},",
				"          {Right_Task Number2},",
				"          {Left_Right_NMR Det Repair Action},",
				"          {Unit Selling Price OM},",
				"          {Right_3PL RMA},",
				"          {Right_RTV Ship Date},",
				"          {Right_RTV Receipt Date},",
				"          {Right_Unit Selling Price OM},",
				"          {Cancelled Quantity},",
				"          {Line$Acceptance Point},",
				"          {Line Cancelled Flag},",
				"          {Org Avg Item Cost},",
				"          {Repo Load Dttm},",
				"          {Right_Cancelled Quantity},",
				"          {Right_Line$Acceptance Point},",
				"          {Right_Line Cancelled Flag},",
				"          {Right_Org Avg Item Cost},",
				"          {Right_Repo Load Dttm},",
				"          {Hold End Date RO},",
				"          {Hold Start Date RO},",
				"          {Hold Age},",
				"          {AGE Bus Days (Actual_RCVD Date)},",
				"          {Report Date},",
				"          {WIP EOM Date},",
				"          {Start_Rcvd Date},",
				"          {WIP Inventory},",
				"          {In WIP},",
				"          DateBetweenDRO",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select14",
				"select14, select22 join(DateBetweenDRO == Date,",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join3",
				"join3 filter(IsBusinessDay>='1') ~> filter4",
				"filter4 filter(dayOfWeek(DateBetweenDRO) != 1 && dayOfWeek(DateBetweenDRO) != 7) ~> filter5",
				"union9 aggregate(groupBy({Arrived at Vendor Date},",
				"          {Business Area},",
				"          {Buyer Name},",
				"          {Customer Po Number},",
				"          {DRO Receive Date},",
				"          {Failure Cause Code},",
				"          {Item Description},",
				"          {Line Creation Date},",
				"          {Line Quantity},",
				"          {Nmr Customer},",
				"          {NMR Number},",
				"          Notes,",
				"          {Order Type Name},",
				"          {Product Line},",
				"          {Promised Date},",
				"          {Received from Vendor Date},",
				"          {Repair Number},",
				"          {Repair Order Closed Date},",
				"          {Repair Order Creation Date},",
				"          {Repair Order Promised Date},",
				"          {Repair Order Task},",
				"          {Repair Owner Name},",
				"          {Repair Quantity},",
				"          {Repair Reason},",
				"          {Repair Status},",
				"          {Repair Type},",
				"          {Repair$Tat Adj},",
				"          {Requested Date},",
				"          {Requisition Line Number},",
				"          {Requisition Number},",
				"          {RMA Nbr/Order Nbr},",
				"          {RTV Hold End Date},",
				"          {RTV Hold Start Date},",
				"          {RTV Po Number},",
				"          {RTV Supplier SN},",
				"          {Scheduled Ship Date},",
				"          {Ship Date},",
				"          {Ship From Location},",
				"          {Ship To Country},",
				"          {Ship To Customer Name},",
				"          {Ship To Location},",
				"          {Shipped from Vendor Date},",
				"          {Shipped Quantity},",
				"          {Sr Owner Name},",
				"          {Time In Hold Status},",
				"          {Time In Open Status},",
				"          {Time In Repair},",
				"          {Vendor Hold Time},",
				"          {Vendor Repair Time},",
				"          {Warehouse Code},",
				"          {Warranty Status},",
				"          {Actual Shipment Date},",
				"          {Actual Start Date},",
				"          {AMS Item Name},",
				"          {Approval Date},",
				"          {Avg Addl Funds},",
				"          {Closure Status},",
				"          {Concat_NMR Details},",
				"          {Contract Number},",
				"          {Contract Warranty End Date},",
				"          {DRO Po Number},",
				"          {Failure Date},",
				"          {Failure Site},",
				"          {Line Number},",
				"          {Line Status},",
				"          {NMR Creation Date},",
				"          {NMR DATE CLOSED_DETCLOSED},",
				"          {Nmr Det Action Taken},",
				"          {Nmr Det Date Action Taken},",
				"          {Nmr Det Date Closed},",
				"          {Nmr Det Desc Of Def},",
				"          {Nmr Det Dispo},",
				"          {Nmr Det Line Creation Date},",
				"          {Nmr Det Oper Name},",
				"          {NMR Det Repair Action},",
				"          {Nmr Det Sn},",
				"          {Nmr Nmr Date Closed},",
				"          {NMR Originator},",
				"          {Nmr Parent Nmr},",
				"          {Nmr Parent Sn},",
				"          {Nmr Pgm},",
				"          {Nmr Pn},",
				"          {Nmr Pn Desc},",
				"          {Nmr Po Receipt Date},",
				"          {NMR RMA Line No},",
				"          {Nmr Sn},",
				"          {Nmr Warranty},",
				"          {Om Or Pc},",
				"          {Order Date},",
				"          {Organization Code},",
				"          {Po Approved Date},",
				"          {Po Item Description},",
				"          {Po Line Creation Date},",
				"          {Po Line Number},",
				"          {Po Line Type},",
				"          {Po Revision Number},",
				"          {PO Unit Price},",
				"          {Po Warranty Status},",
				"          Preparer,",
				"          {Price List},",
				"          {Quantity Shipped},",
				"          {Repair Line Id},",
				"          {Repair Type Reference},",
				"          {Repair$Actual Repair Price},",
				"          {Repair$Metric Completion Date},",
				"          {Repair$Tat Adj Reason},",
				"          {Report Symptom},",
				"          {Req Create Date},",
				"          {Requisition Approval Date},",
				"          {Requisition Created By},",
				"          {Rma Creation Date},",
				"          {Salesforce Num},",
				"          {Service Request Number},",
				"          {Ship To Address1},",
				"          {Ship To City},",
				"          {Ship To State},",
				"          {Sold To Customer Name},",
				"          {Sr Group Name},",
				"          {Sr Item Serial Number},",
				"          {Sr Status},",
				"          {Times Returned},",
				"          {Total Actual Amount},",
				"          {Total Estimate Amount},",
				"          {Unit Selling Price},",
				"          {Vendor Pn},",
				"          {Vendor RMA},",
				"          {ViaSat NMR},",
				"          {ViaSat Parent RMA},",
				"          {ViaSat RMA},",
				"          {Item Revision},",
				"          {Complete Date},",
				"          Customer,",
				"          {Repair Vendor Name},",
				"          {Report Date},",
				"          {Returned Item},",
				"          {Returned SN},",
				"          {AGE Bus Days (Actual_RCVD Date)},",
				"          {Age Bus Days (Rcvd Date)},",
				"          {AGE Bus Days (Start Date)},",
				"          {VENDOR AGE (Bus Day)},",
				"          {WIP Inventory},",
				"          {WIP EOM Date},",
				"          {Incoming Days},",
				"          {In WIP},",
				"          {PO Closed Date},",
				"          {DRO TAT SHIP DATE},",
				"          {Hold Age},",
				"          {Hold End Date RO},",
				"          {Hold Start Date RO},",
				"          {Nmr Det Def Desc},",
				"          {3PL RMA},",
				"          {RTV Ship Date},",
				"          {RTV Receipt Date}),",
				"     Count = count({DRO TAT SHIP DATE})) ~> aggregate4",
				"aggregate4 derive() ~> derivedColumn12",
				"derivedColumn12 derive() ~> derivedColumn13",
				"derivedColumn13 window(over({Returned SN},",
				"          {3PL RMA}),",
				"     asc({Returned SN}, true),",
				"     asc({3PL RMA}, true),",
				"     Y1 = lead({RTV Ship Date}, 1, 0)) ~> window1",
				"window1 derive({RTV Ship Date} = iif(isNull({RTV Ship Date}),Y1,{RTV Ship Date})) ~> derivedColumn14",
				"derivedColumn14 sort(asc({3PL RMA}, true),",
				"     asc({Returned SN}, true),",
				"     asc({RTV Receipt Date}, true)) ~> sort4",
				"sort4 window(over({Returned SN},",
				"          {3PL RMA}),",
				"     asc({Returned SN}, true),",
				"     asc({3PL RMA}, true),",
				"     Y2 = lead({RTV Receipt Date}, 1,0)) ~> window2",
				"window2 derive({RTV Receipt Date} = iif(isNull({RTV Receipt Date}),Y2,{RTV Receipt Date})) ~> derivedColumn15",
				"derivedColumn15 aggregate() ~> aggregate5",
				"aggregate5 select(skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select15",
				"select15 derive() ~> derivedColumn16",
				"select22, derivedColumn16 join(ERROR_FUNCTION('') == ERROR_FUNCTION(''),",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join4",
				"join4 select(skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select16",
				"derivedColumn7 split({Repair Status}==\"Open\" ||{Repair Status}==\"Hold\",",
				"     disjoint: false) ~> split2@(spilt1inputcsv2, split2inputcsv2)",
				"select11 split(!isNull({Repair Number}),",
				"     disjoint: false) ~> split4@(split13inputcsv2, split14inputcsv2)",
				"select11 split(regexMatch(Customer,'NBN'),",
				"     disjoint: false) ~> split5@(split11inputcsv2, split12inputcsv2)",
				"split5@split11inputcsv2 filter({Organization Code}==\"76\"||{Organization Code}==\"16\") ~> filter15",
				"split4@split13inputcsv2 filter(regexMatch({Repair Owner Name}, \"Laranang\")) ~> filter22",
				"flatten1 select(mapColumn(",
				"          REPAIR_LINE_ID,",
				"          REPAIR_NUMBER,",
				"          {Hold End Date RO},",
				"          {Hold Start Date RO},",
				"          DateBetweenDRO",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select18",
				"select18, select22 join(DateBetweenDRO == Date,",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join5",
				"join5 filter(IsBusinessDay>='1') ~> filter23",
				"filter23 filter(dayOfWeek(DateBetweenDRO) != 1 && dayOfWeek(DateBetweenDRO) != 7) ~> filter24",
				"filter24 aggregate(groupBy(REPAIR_LINE_ID,",
				"          REPAIR_NUMBER,",
				"          {Hold End Date RO},",
				"          {Hold Start Date RO}),",
				"     {Hold Age} = count(DateBetweenDRO)) ~> aggregate6",
				"aggregate6 select(mapColumn(",
				"          REPAIR_LINE_ID,",
				"          REPAIR_NUMBER,",
				"          {Hold End Date RO},",
				"          {Hold Start Date RO},",
				"          {Hold Age}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select19",
				"union1 select(skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select20",
				"split2@split2inputcsv2 sort(asc({Repair Order Closed Date}, true)) ~> sort7",
				"union2 select(mapColumn(",
				"          ACTUAL_SHIPMENT_DATE = {Actual Shipment Date},",
				"          {Age Bus Days (Rcvd Date)},",
				"          {AGE Bus Days (Start Date)},",
				"          {AMS Item Name},",
				"          {Approval Date},",
				"          {Avg Addl Funds},",
				"          {Business Area},",
				"          {Buyer Name},",
				"          {Closure Status},",
				"          {Complete Date},",
				"          {Concat_NMR Details},",
				"          {Contract Number},",
				"          {Contract Warranty End Date},",
				"          {Customer Po Number},",
				"          {DRO Po Number},",
				"          {DRO TAT SHIP DATE},",
				"          {Failure Cause Code},",
				"          {Failure Date},",
				"          {Failure Site},",
				"          {Item Description},",
				"          {Item Number},",
				"          {Item Revision},",
				"          {Line Creation Date},",
				"          {Line Number},",
				"          {Line Quantity},",
				"          {Line Status},",
				"          {NMR Creation Date},",
				"          {Nmr Customer},",
				"          {NMR DATE CLOSED_DETCLOSED},",
				"          {Nmr Det Action Taken},",
				"          {Nmr Det Date Action Taken},",
				"          {Nmr Det Date Closed},",
				"          {Nmr Det Desc Of Def},",
				"          {Nmr Det Dispo},",
				"          {Nmr Det Line Creation Date},",
				"          {Nmr Det Oper Name},",
				"          {NMR Det Repair Action},",
				"          {Nmr Det Sn},",
				"          {Nmr Nmr Date Closed},",
				"          {NMR Number},",
				"          {NMR Originator},",
				"          {Nmr Parent Nmr},",
				"          {Nmr Parent Sn},",
				"          {Nmr Pgm},",
				"          {Nmr Pn},",
				"          {Nmr Pn Desc},",
				"          {Nmr Po Receipt Date},",
				"          {NMR RMA Line No},",
				"          {Nmr Sn},",
				"          {Nmr Warranty},",
				"          Notes,",
				"          {Om Or Pc},",
				"          {Order Date},",
				"          {Order Type Name},",
				"          {Organization Code},",
				"          {Po Approved Date},",
				"          {Po Item Description},",
				"          {Po Line Creation Date},",
				"          {Po Line Number},",
				"          {Po Line Type},",
				"          {Po Revision Number},",
				"          {PO Unit Price},",
				"          {Po Warranty Status},",
				"          Preparer,",
				"          {Price List},",
				"          {Product Line},",
				"          {Promised Date},",
				"          {Quantity Shipped},",
				"          {Repair Item Serial Number},",
				"          {Repair Line Id},",
				"          {Repair Number},",
				"          {Repair Order Project},",
				"          {Repair Order Task},",
				"          {Repair Owner Name},",
				"          {Repair Quantity},",
				"          {Repair Reason},",
				"          {Repair Status},",
				"          {Repair Type},",
				"          {Repair Type Reference},",
				"          {Repair$Actual Repair Price},",
				"          {Repair$Metric Completion Date},",
				"          {Repair$Tat Adj},",
				"          {Repair$Tat Adj Reason},",
				"          {Repair$Vendor Name},",
				"          {Report Symptom},",
				"          {Req Create Date},",
				"          {Requested Date},",
				"          {Requisition Approval Date},",
				"          {Requisition Created By},",
				"          {Requisition Line Number},",
				"          {Requisition Number},",
				"          {Rma Creation Date},",
				"          {RMA Nbr/Order Nbr},",
				"          {RTV Hold End Date},",
				"          {RTV Hold Start Date},",
				"          {RTV PO Number},",
				"          {RTV Supplier SN},",
				"          {Salesforce Num},",
				"          {Scheduled Ship Date},",
				"          {Service Request Number},",
				"          {Ship Date},",
				"          {Ship From Location},",
				"          {Ship To Address1},",
				"          {Ship To City},",
				"          {Ship To Country},",
				"          {Sold To Customer Name},",
				"          {Ship To Location},",
				"          {Ship To State},",
				"          {Shipped from Vendor Date},",
				"          {Shipped Quantity},",
				"          {Sr Group Name},",
				"          {Sr Item Serial Number},",
				"          {Sr Owner Name},",
				"          {Sr Status},",
				"          {Time In Hold Status},",
				"          {Time In Open Status},",
				"          {Time In Repair},",
				"          {Times Returned},",
				"          {Total Actual Amount},",
				"          {Total Estimate Amount},",
				"          {Unit Selling Price},",
				"          {VENDOR AGE (Bus Day)},",
				"          {Vendor Hold Time},",
				"          {Vendor Pn},",
				"          {Vendor Repair Time},",
				"          {Vendor RMA},",
				"          {ViaSat NMR},",
				"          {ViaSat Parent RMA},",
				"          {ViaSat RMA},",
				"          {Warehouse Code},",
				"          {Warranty Status},",
				"          {AGE Bus Days (Actual_RCVD Date)},",
				"          {Report Date},",
				"          {Repair Order Creation Date},",
				"          {Actual Start Date},",
				"          {DRO Receive Date},",
				"          {Repair Order Closed Date},",
				"          {Arrived at Vendor Date},",
				"          {Received from Vendor Date},",
				"          {Repair Order Promised Date},",
				"          {3PL RMA},",
				"          {Incoming Days},",
				"          Customer = {Customer Name},",
				"          {Nmr Det Def Desc},",
				"          {PO Closed Date},",
				"          {RTV Receipt Date},",
				"          {RTV Ship Date},",
				"          {Ship To Customer Name},",
				"          {RMA Received Date},",
				"          {Right_RMA Received Date},",
				"          {Task Number2},",
				"          {Right_Nmr Det Def Desc},",
				"          {Right_Right_NMR Det Repair Action},",
				"          {Right_Task Number2},",
				"          {Left_Right_NMR Det Repair Action},",
				"          {Unit Selling Price OM},",
				"          {Right_3PL RMA},",
				"          {Right_RTV Ship Date},",
				"          {Right_RTV Receipt Date},",
				"          {Right_Unit Selling Price OM},",
				"          {Cancelled Quantity},",
				"          {Line$Acceptance Point},",
				"          {Line Cancelled Flag},",
				"          {Org Avg Item Cost},",
				"          {Repo Load Dttm},",
				"          {Right_Cancelled Quantity},",
				"          {Right_Line$Acceptance Point},",
				"          {Right_Line Cancelled Flag},",
				"          {Right_Org Avg Item Cost},",
				"          {Right_Repo Load Dttm},",
				"          {Hold End Date RO},",
				"          {Hold Start Date RO},",
				"          {Hold Age}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select21",
				"select21 filter(!regexMatch(Customer,'NBN')) ~> filter25",
				"filter25 filter({Organization Code} == \"75\" ||{Organization Code} == \"76\") ~> filter26",
				"filter25 split(!isNull({Repair Number}),",
				"     disjoint: false) ~> split9@(split3inputcsv2, split4inputcsv2)",
				"split9@split3inputcsv2 filter(regexMatch({Repair Owner Name}, \"Breault\")|| \r",
				"regexMatch({Repair Owner Name}, \"Bivins\") ||\r",
				"regexMatch({Repair Owner Name}, \"Chretien\") ||\r",
				"regexMatch({Repair Owner Name}, \"Kentory\") ||\r",
				"regexMatch({Repair Owner Name}, \"Tolever\") || \r",
				"regexMatch({Repair Owner Name}, \"Payne\") ||\r",
				"regexMatch({Repair Owner Name}, \"Henkle\") ||\r",
				"regexMatch({Repair Owner Name}, \"Layson\") ||\r",
				"regexMatch({Repair Owner Name}, \"Birmingham\") ||\r",
				"regexMatch({Repair Owner Name}, \"Maddox\") ||\r",
				"regexMatch({Repair Owner Name}, \"Laranang\")) ~> filter28",
				"filter26 split(!isNull({Repair Number}),",
				"     disjoint: false) ~> split10@(split9inputcsv2, split10inputcsv2)",
				"split10@split9inputcsv2 filter(regexMatch({Repair Owner Name}, \"Maddox\")) ~> filter32",
				"filter26 split(!isNull({Repair Number}),",
				"     disjoint: false) ~> split11@(split7inputcsv2, split8inputcsv2)",
				"split11@split7inputcsv2 filter(regexMatch({Repair Owner Name}, \"Henkle\")||regexMatch({Repair Owner Name}, \"Layson\")) ~> filter34",
				"filter26 split(!isNull({Repair Number}),",
				"     disjoint: false) ~> split12@(split5inputcsv2, split6inputcsv2)",
				"split12@split5inputcsv2 filter(regexMatch({Repair Owner Name}, \"Birmingham\")) ~> filter36",
				"split5@split12inputcsv2 filter({Organization Code}=='76') ~> filter37",
				"split4@split14inputcsv2 filter(regexMatch({NMR Originator}, \"Laranang\")) ~> filter38",
				"Datedimension select(mapColumn(",
				"          Date,",
				"          MonthYear,",
				"          YearMonth,",
				"          LastDayOfMonth,",
				"          FiscalYearQuarter,",
				"          FiscalYear,",
				"          IsBusinessDay,",
				"          WeekEndingDate_Sunday",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select22",
				"MapDrifted1 select(mapColumn(",
				"          REPAIR_LINE_ID,",
				"          REPAIR_NUMBER,",
				"          {Hold End Date RO},",
				"          {Hold Start Date RO}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select23",
				"crosstab derive({Hold End Date RO} = toDate(byName('Hold End Date RO')),",
				"          {Hold Start Date RO} = toDate(byName('Hold Start Date RO'))) ~> MapDrifted1",
				"filter1@split1inputcsv1 derive(DateBetweenDRO = mapLoop(toInteger({Hold End Date RO}-{Hold Start Date RO}),addDays({Hold Start Date RO},toInteger(#index)-1))) ~> derivedColumn17",
				"derivedColumn2 split(!(isNull({Hold Start Date RO})),",
				"     disjoint: false) ~> filter1@(split1inputcsv1, split2inputcsv1)",
				"derivedColumn17 derive(DateBetweenDRO = mapLoop(toInteger({WIP AGE DATE}-{Start_Rcvd Date}),addDays({Start_Rcvd Date},toInteger(#index)-1))) ~> flatten1",
				"select19, filter1@split2inputcsv1 union(byName: true)~> union1",
				"sort8, sort7 union(byName: true)~> union2",
				"split9@split4inputcsv2 filter(regexMatch({NMR Originator}, \"Breault\")||\r",
				"regexMatch({NMR Originator}, \"Bivins\")||\r",
				"regexMatch({NMR Originator}, \"Chretien\")||\r",
				"regexMatch({NMR Originator}, \"Kentory\")||\r",
				"regexMatch({NMR Originator}, \"Tolever\")||\r",
				"regexMatch({NMR Originator}, \"Payne\")||\r",
				"regexMatch({NMR Originator}, \"Layson\")||\r",
				"regexMatch({NMR Originator}, \"Henkle\")||\r",
				"regexMatch({NMR Originator}, \"Birmingham\")||\r",
				"regexMatch({NMR Originator}, \"Maddox\")||\r",
				"regexMatch({NMR Originator}, \"Laranang\")) ~> filter39",
				"filter28, filter39 union(byName: true)~> union3",
				"union3 filter({Warranty Status}=='In Warranty') ~> filter40",
				"filter40 filter({AGE Bus Days (Actual_RCVD Date)} >= 30 && {AGE Bus Days (Actual_RCVD Date)} <= 60) ~> filter41",
				"split12@split6inputcsv2 filter(regexMatch({NMR Originator},\"Birmingham\")) ~> filter42",
				"filter36, filter42 union(byName: true)~> union4",
				"split11@split8inputcsv2 filter(regexMatch({NMR Originator}, \"Henkle\")||\r",
				"regexMatch({NMR Originator}, \"Layson\")) ~> filter43",
				"filter34, filter43 union(byName: true)~> union5",
				"split10@split10inputcsv2 filter(regexMatch({NMR Originator}, \"Maddox\")) ~> filter44",
				"filter32, filter44 union(byName: true)~> union6",
				"filter22, filter38 union(byName: true)~> union7",
				"split2@spilt1inputcsv2 sort(asc({Customer Name}, true),",
				"     desc({Repair Order Creation Date}, true)) ~> sort8",
				"derivedColumn10 derive({WIP Inventory} = mapLoop(toInteger(substring(toString({WIP EOM Date}),6,2))-toInteger(substring(toString({Start_Rcvd Date}),6,2)),toString(addMonths(lastDayOfMonth(toDate(toString({Start_Rcvd Date}))),toInteger(#index)-1)))) ~> derivedColumn18",
				"derivedColumn18 derive(DateBetweenDRO = mapLoop(toInteger({WIP AGE DATE}-{Start_Rcvd Date}),addDays({Start_Rcvd Date},toInteger(#index)-1))) ~> flatten2",
				"derivedColumn11 derive(DateBetweenDRO = mapLoop(toInteger({WIP AGE DATE}-{Start_Rcvd Date}),addDays({Start_Rcvd Date},toInteger(#index)-1))) ~> derivedColumn19",
				"derivedColumn19 derive(DateBetweenDRO = mapLoop(toInteger({WIP AGE DATE}-{Start_Rcvd Date}),addDays({Start_Rcvd Date},toInteger(#index)-1))) ~> flatten3",
				"filter3, filter5 union(byName: true)~> union9",
				"select16 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:false,",
				"     format: 'table',",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     errorHandlingOption: 'stopOnFirstError') ~> sink1",
				"filter15 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> sink5",
				"union7 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> sink6",
				"union3 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> sink7",
				"filter41 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> sink8",
				"union4 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> sink9",
				"union5 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> sink10",
				"union6 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> sink11",
				"filter37 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> sink12"
			]
		}
	}
}