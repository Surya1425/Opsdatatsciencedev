{
	"name": "all_repair_orders_df",
	"properties": {
		"folder": {
			"name": "all_repair_orders"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "ds_csv_input",
						"type": "DatasetReference"
					},
					"name": "CSD0"
				},
				{
					"dataset": {
						"referenceName": "ds_csv_input",
						"type": "DatasetReference"
					},
					"name": "INVG0"
				},
				{
					"dataset": {
						"referenceName": "ds_csv_input",
						"type": "DatasetReference"
					},
					"name": "PAG0"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "ds_csv_output",
						"type": "DatasetReference"
					},
					"name": "DailyData"
				},
				{
					"dataset": {
						"referenceName": "ds_AzSql",
						"type": "DatasetReference"
					},
					"name": "HistoricalData"
				}
			],
			"transformations": [
				{
					"name": "selectingCSD0Columns"
				},
				{
					"name": "initCapCols3"
				},
				{
					"name": "joiningCSD0PAG0LeftOuter1"
				},
				{
					"name": "selectingINVG0Columns"
				},
				{
					"name": "filteringOrgCodeMAS"
				},
				{
					"name": "finalSelectfromINVG0"
				},
				{
					"name": "joiningWithINVG0LeftOuter2"
				},
				{
					"name": "FormulaeApplied"
				},
				{
					"name": "selectingFinalOfFinal"
				},
				{
					"name": "filteringProjectNumber"
				},
				{
					"name": "ProductLineSecondFormula"
				},
				{
					"name": "selectingColumns"
				},
				{
					"name": "initCapCols1"
				},
				{
					"name": "initCapCols2"
				},
				{
					"name": "selectingCols"
				}
			],
			"scriptLines": [
				"source(output(",
				"          APPROVAL_REQUIRED_FLAG as string,",
				"          AUTOMATIC_RMA_PROCESS_FLAG as string,",
				"          AVG_ADDL_FUNDS as string,",
				"          BILL_TO_ADDRESS1 as string,",
				"          BILL_TO_ADDRESS2 as string,",
				"          BILL_TO_ADDRESS3 as integer,",
				"          BILL_TO_ADDRESS4 as string,",
				"          BILL_TO_CITY as string,",
				"          BILL_TO_COUNTRY as string,",
				"          BILL_TO_COUNTY as string,",
				"          BILL_TO_POSTAL_CODE as string,",
				"          BILL_TO_STATE as string,",
				"          CONTACT_PERSON_NAME as string,",
				"          CONTACT_PERSON_NUMBER as integer,",
				"          CONTACT_PHONE as string,",
				"          CONTACT_RELATIONSHIP as string,",
				"          CONTACT_TYPE as string,",
				"          CONTRACT_LINE_ID as string,",
				"          CONTRACT_NUMBER as string,",
				"          CONTRACT_WARRANTY_END_DATE as string,",
				"          CUSTOMER_NAME as string,",
				"          CUSTOMER_NUMBER as string,",
				"          CUSTOMER_PHONE as string,",
				"          CUSTOMER_PRODUCT_ID as integer,",
				"          CUSTOMER_TYPE as string,",
				"          ESTIMATE_APPROVAL_STATUS as string,",
				"          INCIDENT_TYPE as string,",
				"          INSTALL_SITE_ADDRESS1 as string,",
				"          INSTALL_SITE_ADDRESS2 as string,",
				"          INSTALL_SITE_ADDRESS3 as string,",
				"          INSTALL_SITE_ADDRESS4 as string,",
				"          INSTALL_SITE_CITY as string,",
				"          INSTALL_SITE_COUNTRY as string,",
				"          INSTALL_SITE_COUNTY as string,",
				"          INSTALL_SITE_POSTAL_CODE as string,",
				"          INSTALL_SITE_STATE as string,",
				"          INSTANCE_WARRANTY_END_DATE as string,",
				"          INTERNAL_ORDER_FLAG as boolean,",
				"          INVENTORY_ORGANIZATION_NAME as string,",
				"          {ITEM$INVENTORY_ITEM_ID} as integer,",
				"          {ITEM$ORGANIZATION_ID} as short,",
				"          {ITEM$SV$PART_NUMBER} as string,",
				"          ITEM_DESCRIPTION as string,",
				"          ITEM_INSTANCE_NUMBER as integer,",
				"          ITEM_INSTANCE_STATUS as string,",
				"          ITEM_LOT_NUMBER as string,",
				"          ITEM_REVISION as string,",
				"          LOCATOR as string,",
				"          PO_NUMBER as string,",
				"          PRICE_LIST as string,",
				"          QUANTITY_IN_WIP as short,",
				"          RMA_ORDER_NUMBER as integer,",
				"          RECEIVE_DATE as string,",
				"          RECEIVED_QUANTITY as boolean,",
				"          {REPAIR$ACTUAL_COMPLETE_DATE} as timestamp,",
				"          {REPAIR$ACTUAL_REPAIR_PRICE} as string,",
				"          {REPAIR$ACTUAL_START_DATE} as timestamp,",
				"          {REPAIR$COST_JUSTIFICATION} as string,",
				"          {REPAIR$CUST_RL_ORIGINAL_FAILUR} as string,",
				"          {REPAIR$CUST_RL_TRX_CONTEXT_VAL} as string,",
				"          {REPAIR$CUSTOMER_RL_FILE_NAME} as string,",
				"          {REPAIR$ECD} as string,",
				"          {REPAIR$METRIC_COMPLETION_DATE} as timestamp,",
				"          {REPAIR$OUT_OF_SCOPE_REPAIR_EST} as string,",
				"          {REPAIR$PROGRAM} as string,",
				"          {REPAIR$RETURNING_PLATFORM} as string,",
				"          {REPAIR$SSL} as string,",
				"          {REPAIR$SERVICE_AFFILIATION} as string,",
				"          {REPAIR$TAT_ADJ} as short,",
				"          {REPAIR$TAT_ADJ_REASON} as string,",
				"          {REPAIR$TAIL_NUMBER} as string,",
				"          {REPAIR$VENDOR_NAME} as string,",
				"          {REPAIR$VENDOR_RMA} as string,",
				"          REPAIR_CURRENCY_CODE as string,",
				"          REPAIR_ITEM_SERIAL_NUMBER as string,",
				"          REPAIR_ITEM_UOM as string,",
				"          REPAIR_LINE_ID as integer,",
				"          REPAIR_MODE_CODE as string,",
				"          REPAIR_NUMBER as integer,",
				"          REPAIR_ORDER_CLOSED_DATE as string,",
				"          REPAIR_ORDER_CREATION_DATE as string,",
				"          REPAIR_ORDER_PROJECT as string,",
				"          REPAIR_ORDER_PROMISED_DATE as string,",
				"          REPAIR_ORDER_SPLIT_FLAG as boolean,",
				"          REPAIR_ORDER_TASK as string,",
				"          REPAIR_OWNER_NAME as string,",
				"          REPAIR_PRIORITY as string,",
				"          REPAIR_QUANTITY as boolean,",
				"          REPAIR_REASON as string,",
				"          REPAIR_STATUS as string,",
				"          REPAIR_TYPE as string,",
				"          REPAIR_TYPE_REFERENCE as string,",
				"          SR_GROUP_NAME as string,",
				"          SR_ITEM_SERIAL_NUMBER as string,",
				"          SR_OPERATING_UNIT_NAME as string,",
				"          SR_OWNER_NAME as string,",
				"          SR_SEVERITY as short,",
				"          SR_STATUS as string,",
				"          SALESFORCE_RMA as string,",
				"          SERVICE_REQUEST_NUMBER as integer,",
				"          SHIP_DATE as string,",
				"          SHIP_TO_ADDRESS1 as string,",
				"          SHIP_TO_ADDRESS2 as string,",
				"          SHIP_TO_ADDRESS3 as string,",
				"          SHIP_TO_ADDRESS4 as string,",
				"          SHIP_TO_CITY as string,",
				"          SHIP_TO_COUNTRY as string,",
				"          SHIP_TO_COUNTY as string,",
				"          SHIP_TO_POSTAL_CODE as short,",
				"          SHIP_TO_STATE as string,",
				"          SHIPPED_QUANTITY as short,",
				"          SUBINVENTORY as string,",
				"          TIME_IN_HOLD_STATUS as double,",
				"          TIME_IN_OPEN_STATUS as double,",
				"          TIME_IN_REPAIR as double,",
				"          TIMES_RETURNED as short,",
				"          TOTAL_ACTUAL_AMOUNT as boolean,",
				"          TOTAL_ESTIMATE_AMOUNT as string,",
				"          UNIT_SELLING_PRICE as double,",
				"          WAREHOUSE_CODE as short,",
				"          WARRANTY_STATUS as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     inferDriftedColumnTypes: true,",
				"     ignoreNoFilesFound: false,",
				"     fileSystem: 'all-repair-orders',",
				"     folderPath: 'input',",
				"     fileName: 'CSDG0_Repair_Orders.csv',",
				"     columnDelimiter: ',',",
				"     escapeChar: '\\\\',",
				"     quoteChar: '\\\"',",
				"     columnNamesAsHeader: true) ~> CSD0",
				"source(output(",
				"          {A$CHART_OF_ACCOUNTS_NAME} as string,",
				"          {A$ITEM_DESCRIPTION} as string,",
				"          {A$MASTER_ORGANIZATION_NAME} as string,",
				"          {A$ORGANIZATION_NAME} as string,",
				"          {A$ZZ__________________________} as string,",
				"          {CAT$CUSTOM_COMMODITY_CODE} as string,",
				"          {CAT$DEFAULT_CATEGORY_LEAD_TIME} as string,",
				"          {CAT$METAL_RANKING_APPLIES_ON_B} as string,",
				"          {CAT$WEB_ENABLED_Y_N} as string,",
				"          CATEGORY_DESCRIPTION as string,",
				"          CHART_OF_ACCOUNTS_NAME as string,",
				"          {ITEM$AGILE_ACCESS_RESTRICTION} as string,",
				"          {ITEM$AGILE_ITEM__PART__CATEGOR} as string,",
				"          {ITEM$ASSET_NAME} as string,",
				"          {ITEM$ASSET_NOMENCLATURE} as string,",
				"          {ITEM$ASSET_VARIANT} as string,",
				"          {ITEM$BIN_QTY} as string,",
				"          {ITEM$BUILD_IN_SOLUMINA_DATE} as string,",
				"          {ITEM$COMSEC} as boolean,",
				"          {ITEM$CUI} as boolean,",
				"          {ITEM$COUNTRY_OF_ORIGIN} as string,",
				"          {ITEM$ESD_HANDLING} as string,",
				"          {ITEM$EXCLUDE_FROM_LEAD_TIME_UP} as boolean,",
				"          {ITEM$EXTERNAL_SYSTEMS} as string,",
				"          {ITEM$INVOICE_UOM} as string,",
				"          {ITEM$ITEM_NET_WEIGHT__LBS} as string,",
				"          {ITEM$ITEM_SETUP_VERIFIED} as timestamp,",
				"          {ITEM$LEAD_TIME_UPDATED} as string,",
				"          {ITEM$LEGACY_SYSTEM_ITEM_NUMBER} as string,",
				"          {ITEM$MATERIAL_EXPIRATION_VALUE} as string,",
				"          {ITEM$MOISTURE_SENSITIVITY_LEVE} as string,",
				"          {ITEM$NON_MRP_ACTIONABLE} as string,",
				"          {ITEM$REPLENISHMENT_TYPE} as string,",
				"          {ITEM$RESERVED_PN} as boolean,",
				"          {ITEM$ST_APPLIES} as boolean,",
				"          {ITEM$SPACE_FLIGHT_DELIVERABLE} as boolean,",
				"          {ITEM$STORAGE_CONDITION} as string,",
				"          {ITEM$TARGET_COST} as string,",
				"          {ITEM$USE_AS_REQUIRED} as string,",
				"          {ITEM$VMI_ITEM} as string,",
				"          {ITEM$WARRANTY_PERIOD} as string,",
				"          {ITEM$INVENTORY_ITEM_ID} as integer,",
				"          {ITEM$ORGANIZATION_ID} as short,",
				"          {ITEM$SV$PART_NUMBER} as string,",
				"          {ITEMCAT$CATEGORY_ID} as integer,",
				"          {ITEMCAT$SV$AMS} as string,",
				"          ITEM_DESCRIPTION as string,",
				"          ITEM_STATUS as string,",
				"          ITEM_STATUS_CODE as string,",
				"          ITEM_TYPE as string,",
				"          MASTER_ORGANIZATION_NAME as string,",
				"          ORGANIZATION as string,",
				"          ORGANIZATION_CODE as string,",
				"          ORGANIZATION_NAME as string,",
				"          {Z$$_________________________} as string,",
				"          {Z$INVG0_ITEMS} as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     fileSystem: 'all-repair-orders',",
				"     folderPath: 'input',",
				"     fileName: 'INVG0_Category_AMS_Category.csv',",
				"     columnDelimiter: ',',",
				"     escapeChar: '\\\\',",
				"     quoteChar: '\\\"',",
				"     columnNamesAsHeader: true) ~> INVG0",
				"source(output(",
				"          {A$PROJECT_NAME} as string,",
				"          {A$PROJECT_NUMBER} as string,",
				"          {A$PROJECT_TYPE} as string,",
				"          {A$ZZ__________________________} as string,",
				"          AFTER_MARKET_SERVICE as boolean,",
				"          CLASSIFICATION as string,",
				"          CUSTOMER_GROUP as string,",
				"          DEPOT_PRODUCT_LINE as string,",
				"          PRODUCT_LINE as string,",
				"          PRODUCT_LINE_BUSINESS_AREA as string,",
				"          PRODUCT_SERVICE as string,",
				"          PROJECT_NAME as string,",
				"          PROJECT_NUMBER as string,",
				"          PROJECT_TYPE as string,",
				"          REVENUE_TYPE as string,",
				"          SEGMENT as string,",
				"          SUB_CATEGORY as string,",
				"          {Z$$_________________________} as string,",
				"          {Z$PAG0_PROJECTS} as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     fileSystem: 'all-repair-orders',",
				"     folderPath: 'input',",
				"     fileName: 'PAG0_Project_Class_Categories.csv',",
				"     columnDelimiter: ',',",
				"     escapeChar: '\\\\',",
				"     quoteChar: '\\\"',",
				"     columnNamesAsHeader: true) ~> PAG0",
				"initCapCols1 select(mapColumn(",
				"          {Warehouse Code},",
				"          {Unit Selling Price},",
				"          {Total Estimate Amount},",
				"          {Total Actual Amount},",
				"          {Times Returned},",
				"          {Time In Repair},",
				"          {Time In Open Status},",
				"          {Time In Hold Status},",
				"          Subinventory,",
				"          {Shipped Quantity},",
				"          {Ship To State},",
				"          {Ship To Postal Code},",
				"          {Ship To County},",
				"          {Ship To Country},",
				"          {Ship To City},",
				"          {Ship To Address4},",
				"          {Ship To Address3},",
				"          {Ship To Address2},",
				"          {Ship To Address1},",
				"          {Ship Date},",
				"          {Service Request Number},",
				"          {Salesforce Rma},",
				"          {Sr Status},",
				"          {Sr Severity},",
				"          {Sr Owner Name},",
				"          {Sr Operating Unit Name},",
				"          {Sr Item Serial Number},",
				"          {Sr Group Name},",
				"          {Repair Type Reference},",
				"          {Repair Type},",
				"          {Repair Status},",
				"          {Repair Reason},",
				"          {Repair Quantity},",
				"          {Repair Priority},",
				"          {Repair Owner Name},",
				"          {Repair Order Task},",
				"          {Repair Order Split Flag},",
				"          {Repair Order Promised Date},",
				"          {Repair Order Project},",
				"          {Repair Order Creation Date},",
				"          {Repair Order Closed Date},",
				"          {Repair Number},",
				"          {Repair Mode Code},",
				"          {Repair Line Id},",
				"          {Repair Item Uom},",
				"          {Repair Item Serial Number},",
				"          {Repair Currency Code},",
				"          {Repair$Vendor Rma},",
				"          {Repair$Vendor Name},",
				"          {Repair$Tail Number},",
				"          {Repair$Tat Adj Reason},",
				"          {Repair$Tat Adj},",
				"          {Repair$Service Affiliation},",
				"          {Repair$Ssl},",
				"          {Repair$Returning Platform},",
				"          {Repair$Program},",
				"          {Repair$Out Of Scope Repair Est},",
				"          {Repair$Metric Completion Date},",
				"          {Repair$Ecd},",
				"          {Repair$Customer Rl File Name},",
				"          {Repair$Cust Rl Trx Context Val},",
				"          {Repair$Cust Rl Original Failur},",
				"          {Repair$Cost Justification},",
				"          {Repair$Actual Start Date},",
				"          {Repair$Actual Repair Price},",
				"          {Repair$Actual Complete Date},",
				"          {Received Quantity},",
				"          {Receive Date},",
				"          {Rma Order Number},",
				"          {Quantity In Wip},",
				"          {Problem Description},",
				"          {Price List},",
				"          {Po Number},",
				"          Locator,",
				"          {Item Revision},",
				"          {Item Lot Number},",
				"          {Item Instance Status},",
				"          {Item Instance Number},",
				"          {Item Description},",
				"          {Item Number} = {Item$Sv$Part Number},",
				"          {Item$Organization Id},",
				"          {Item$Inventory Item Id},",
				"          {Inventory Organization Name},",
				"          {Internal Order Flag},",
				"          {Instance Warranty End Date},",
				"          {Install Site State},",
				"          {Install Site Postal Code},",
				"          {Install Site County},",
				"          {Install Site Country},",
				"          {Install Site City},",
				"          {Install Site Address4},",
				"          {Install Site Address3},",
				"          {Install Site Address2},",
				"          {Install Site Address1},",
				"          {Incident Type},",
				"          {Estimate Approval Status},",
				"          {Customer Type},",
				"          {Customer Product Id},",
				"          {Customer Phone},",
				"          {Customer Number},",
				"          {Customer Name},",
				"          {Contract Warranty End Date},",
				"          {Contract Number},",
				"          {Contract Line Id},",
				"          {Contact Type},",
				"          {Contact Relationship},",
				"          {Contact Phone},",
				"          {Contact Person Number},",
				"          {Contact Person Name},",
				"          {Bill To State},",
				"          {Bill To Postal Code},",
				"          {Bill To County},",
				"          {Bill To Country},",
				"          {Bill To City},",
				"          {Bill To Address4},",
				"          {Bill To Address3},",
				"          {Bill To Address2},",
				"          {Bill To Address1},",
				"          {Avg Addl Funds},",
				"          {Automatic Rma Process Flag},",
				"          {Approval Required Flag},",
				"          {Warranty Status},",
				"          {Repo Load Dttm}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> selectingCSD0Columns",
				"PAG0 select(mapColumn(",
				"          each(match(true()),",
				"               initCap(replace(initCap($$),'_',' ')) = $$)",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> initCapCols3",
				"selectingCSD0Columns, initCapCols3 join({Repair Order Project} == {Project Number},",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> joiningCSD0PAG0LeftOuter1",
				"initCapCols2 select(mapColumn(",
				"          {Item Status Code},",
				"          {Item Type},",
				"          {Master Organization Name},",
				"          Organization,",
				"          {Org Code} = {Organization Code},",
				"          {Organization Name},",
				"          {Cat$Custom Commodity Code},",
				"          {Cat$Default Category Lead Time},",
				"          {Cat$Metal Ranking Applies On B},",
				"          {Cat$Web Enabled Y N},",
				"          {Category Description},",
				"          {Chart Of Accounts Name},",
				"          {Item$Agile Access Restriction},",
				"          {Item$Agile Item  Part  Categor},",
				"          {Item$Asset Name},",
				"          {Item$Asset Nomenclature},",
				"          {Item$Asset Variant},",
				"          {Item$Bin Qty},",
				"          {Item$Build In Solumina Date},",
				"          {Item$Comsec},",
				"          {Item$Cui},",
				"          {Item$Country Of Origin},",
				"          {Item$Esd Handling},",
				"          {Item$Exclude From Lead Time Up},",
				"          {Item$External Systems},",
				"          {Item$Invoice Uom},",
				"          {Item$Item Net Weight  Lbs},",
				"          {Item$Item Setup Verified},",
				"          {Item$Lead Time Updated},",
				"          {Item$Legacy System Item Number},",
				"          {Item$Material Expiration Value},",
				"          {Item$Moisture Sensitivity Leve},",
				"          {Item$Non Mrp Actionable},",
				"          {Item$Replenishment Type},",
				"          {Item$Reserved Pn},",
				"          {Item$St Applies},",
				"          {Item$Space Flight Deliverable},",
				"          {Item$Storage Condition},",
				"          {Item$Target Cost},",
				"          {Item$Use As Required},",
				"          {Item$Vmi Item},",
				"          {Item$Warranty Period},",
				"          {Item$Inventory Item Id},",
				"          {Item$Organization Id},",
				"          {Item Number} = {Item$Sv$Part Number},",
				"          {Itemcat$Category Id},",
				"          {Itemcat$Sv$Ams},",
				"          {Item Description},",
				"          {Item Status},",
				"          {Repo Load Dttm}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> selectingINVG0Columns",
				"selectingINVG0Columns filter({Org Code}=='MAS') ~> filteringOrgCodeMAS",
				"filteringOrgCodeMAS select(mapColumn(",
				"          {Item Number},",
				"          {Itemcat$Sv$Ams}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> finalSelectfromINVG0",
				"joiningCSD0PAG0LeftOuter1, finalSelectfromINVG0 join(selectingCSD0Columns@{Item Number} == finalSelectfromINVG0@{Item Number},",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> joiningWithINVG0LeftOuter2",
				"selectingColumns derive({Repair$Actual Complete Date} = toString(toTimestamp({Repair$Actual Complete Date}, 'yyyy/MM/dd HH:mm:ss'),'yyyy-MM-dd HH:mm:ss'),",
				"          {Repair$Actual Start Date} = toString(toTimestamp({Repair$Actual Start Date}, 'yyyy/MM/dd HH:mm:ss'),'yyyy-MM-dd HH:mm:ss'),",
				"          {Product Line} = iif(isNull({Product Line}),'Unknown',{Product Line}),",
				"          report_date = toString(currentTimestamp(),'yyyy-MM-dd'),",
				"          {Business Area} = iif (contains(['75','76'],#item==toString({Warehouse Code})),'AS',iif(isNull({Product Line Business Area}),'Unknown',{Product Line Business Area})),",
				"          {Warranty Status} = iif(regexMatch({Repair Type},'OUT') || regexMatch({Repair Type},'OOW') || regexMatch({Repair Type},'Non'),'Out of Warranty',iif(regexMatch({Repair Type},'spare'),'Spare',iif(regexMatch({Repair Type},'CONTRACT'),'Contract Warranty','In Warranty'))),",
				"          {AMS Item Name} = iif(isNull({Itemcat$Sv$Ams}),'Unknown',{Itemcat$Sv$Ams})) ~> FormulaeApplied",
				"ProductLineSecondFormula select(mapColumn(",
				"          each(match(/* All input columns */true()),",
				"               /* Input name */$$ = $$)",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> selectingFinalOfFinal",
				"selectingFinalOfFinal filter(not(in(['2699997','2626981','2626991'],{Project Number}))) ~> filteringProjectNumber",
				"FormulaeApplied derive({Product Line} = replace({Product Line}, 'KG', 'SNS'),",
				"          {Ship Date} = iif({Project Number}=='8468140' && {Repair Status}=='Closed' && isNull({Ship Date}),{Repair$Actual Complete Date},{Ship Date})) ~> ProductLineSecondFormula",
				"joiningWithINVG0LeftOuter2 select(mapColumn(",
				"          {Warehouse Code},",
				"          {Unit Selling Price},",
				"          {Total Estimate Amount},",
				"          {Total Actual Amount},",
				"          {Times Returned},",
				"          {Time In Repair},",
				"          {Time In Open Status},",
				"          {Time In Hold Status},",
				"          Subinventory,",
				"          {Shipped Quantity},",
				"          {Ship To State},",
				"          {Ship To City},",
				"          {Ship To Address1},",
				"          {Ship Date},",
				"          {Service Request Number},",
				"          {Salesforce Rma},",
				"          {Sr Status},",
				"          {Sr Severity},",
				"          {Sr Operating Unit Name},",
				"          {Sr Item Serial Number},",
				"          {Sr Group Name},",
				"          {Repair Type Reference},",
				"          {Repair Type},",
				"          {Repair Status},",
				"          {Repair Reason},",
				"          {Repair Quantity},",
				"          {Repair Priority},",
				"          {Repair Owner Name},",
				"          {Repair Order Task},",
				"          {Repair Order Promised Date},",
				"          {Repair Order Project},",
				"          {Repair Order Creation Date},",
				"          {Repair Order Closed Date},",
				"          {Repair Number},",
				"          {Repair Line Id},",
				"          {Repair Item Uom},",
				"          {Repair Item Serial Number},",
				"          {Repair Currency Code},",
				"          {Repair$Vendor Name},",
				"          {Repair$Tail Number},",
				"          {Repair$Tat Adj Reason},",
				"          {Repair$Service Affiliation},",
				"          {Repair$Ssl},",
				"          {Repair$Returning Platform},",
				"          {Repair$Program},",
				"          {Repair$Metric Completion Date},",
				"          {Repair$Ecd},",
				"          {Repair$Cust Rl Trx Context Val},",
				"          {Repair$Cust Rl Original Failur},",
				"          {Repair$Actual Start Date},",
				"          {Repair$Actual Repair Price},",
				"          {Repair$Actual Complete Date},",
				"          {Received Quantity},",
				"          {Receive Date},",
				"          {Price List},",
				"          Locator,",
				"          {Item Revision},",
				"          {Item Lot Number},",
				"          {Item Instance Status},",
				"          {Item Instance Number},",
				"          {Item Description},",
				"          {Item Number} = {selectingCSD0Columns@Item Number},",
				"          {Item$Organization Id},",
				"          {Item$Inventory Item Id},",
				"          {Inventory Organization Name},",
				"          {Internal Order Flag},",
				"          {Instance Warranty End Date},",
				"          {Incident Type},",
				"          {Estimate Approval Status},",
				"          {Customer Type},",
				"          {Customer Product Id},",
				"          {Customer Name},",
				"          {Contract Warranty End Date},",
				"          {Contract Number},",
				"          {Avg Addl Funds},",
				"          {Warranty Status},",
				"          {Product Line Business Area},",
				"          {Project Number},",
				"          {Product Line},",
				"          {Itemcat$Sv$Ams}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> selectingColumns",
				"CSD0 select(mapColumn(",
				"          each(match(true()),",
				"               initCap(replace(initCap($$),'_',' ')) = $$)",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> initCapCols1",
				"INVG0 select(mapColumn(",
				"          each(match(true()),",
				"               initCap(replace(initCap($$),'_',' ')) = $$)",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> initCapCols2",
				"initCapCols3 select(mapColumn(",
				"          {Product Line},",
				"          {Product Line Business Area},",
				"          {Project Number}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> selectingCols",
				"filteringProjectNumber sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     partitionFileNames:['all_repair_orders_daily.csv'],",
				"     umask: 0022,",
				"     preCommands: [],",
				"     postCommands: [],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     partitionBy('hash', 1)) ~> DailyData",
				"filteringProjectNumber sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:false,",
				"     format: 'table',",
				"     preSQLs:['delete\\nfrom all_repair_orders_hist\\nwhere report_date = date(\\'now\\')'],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     errorHandlingOption: 'stopOnFirstError',",
				"     partitionBy('hash', 1),",
				"     preCommands: [],",
				"     postCommands: []) ~> HistoricalData"
			]
		}
	}
}