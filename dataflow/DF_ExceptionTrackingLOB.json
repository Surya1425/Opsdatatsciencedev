{
	"name": "DF_ExceptionTrackingLOB",
	"properties": {
		"description": "DF_ExceptionTrackingLOB",
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "ds_csv_input",
						"type": "DatasetReference"
					},
					"name": "source1"
				},
				{
					"dataset": {
						"referenceName": "ds_csv_input",
						"type": "DatasetReference"
					},
					"name": "source2"
				},
				{
					"dataset": {
						"referenceName": "ds_csv_input",
						"type": "DatasetReference"
					},
					"name": "source3"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "ds_csv_output",
						"type": "DatasetReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "select1",
					"description": "unpper to lower  format"
				},
				{
					"name": "select2"
				},
				{
					"name": "select3"
				},
				{
					"name": "filter1"
				},
				{
					"name": "aggregate1"
				},
				{
					"name": "select4"
				},
				{
					"name": "aggregate2"
				},
				{
					"name": "derivedColumn1"
				},
				{
					"name": "filter2"
				},
				{
					"name": "filter3"
				},
				{
					"name": "derivedColumn3"
				},
				{
					"name": "derivedColumn4"
				},
				{
					"name": "select5"
				},
				{
					"name": "union2"
				},
				{
					"name": "join1"
				},
				{
					"name": "derivedColumn5"
				},
				{
					"name": "select6"
				},
				{
					"name": "select7"
				},
				{
					"name": "derivedColumn6"
				},
				{
					"name": "filter4"
				},
				{
					"name": "aggregate4"
				},
				{
					"name": "cast1"
				},
				{
					"name": "derivedColumn7"
				},
				{
					"name": "select8"
				},
				{
					"name": "sort1"
				},
				{
					"name": "derivedColumn8"
				},
				{
					"name": "union3"
				},
				{
					"name": "select9"
				},
				{
					"name": "select10"
				},
				{
					"name": "aggregate5"
				},
				{
					"name": "cast2"
				},
				{
					"name": "sort2"
				},
				{
					"name": "select11"
				},
				{
					"name": "filter5"
				},
				{
					"name": "filter6"
				},
				{
					"name": "join2"
				},
				{
					"name": "join3"
				},
				{
					"name": "derivedColumn9"
				},
				{
					"name": "derivedColumn10"
				},
				{
					"name": "select12"
				},
				{
					"name": "select13"
				},
				{
					"name": "select14"
				},
				{
					"name": "union4"
				},
				{
					"name": "select15"
				},
				{
					"name": "derivedColumn11"
				},
				{
					"name": "derivedColumn12"
				},
				{
					"name": "union5"
				},
				{
					"name": "derivedColumn13"
				},
				{
					"name": "select16"
				},
				{
					"name": "derivedColumn14"
				},
				{
					"name": "select17"
				},
				{
					"name": "aggregate6"
				},
				{
					"name": "derivedColumn15"
				},
				{
					"name": "sort3"
				},
				{
					"name": "select19"
				},
				{
					"name": "cast3"
				},
				{
					"name": "select20"
				},
				{
					"name": "aggregate7"
				},
				{
					"name": "sort4"
				},
				{
					"name": "select21"
				},
				{
					"name": "derivedColumn16"
				},
				{
					"name": "surrogateKey1"
				},
				{
					"name": "select22"
				},
				{
					"name": "filter7"
				},
				{
					"name": "join4"
				},
				{
					"name": "filter8"
				},
				{
					"name": "select23"
				},
				{
					"name": "join5"
				},
				{
					"name": "sort5"
				},
				{
					"name": "join6"
				},
				{
					"name": "join7"
				},
				{
					"name": "select25"
				},
				{
					"name": "select26"
				},
				{
					"name": "cast4"
				},
				{
					"name": "join8"
				},
				{
					"name": "aggregate9"
				},
				{
					"name": "select27"
				},
				{
					"name": "select28"
				},
				{
					"name": "derivedColumn17"
				},
				{
					"name": "window1"
				},
				{
					"name": "derivedColumn18"
				},
				{
					"name": "derivedColumn19"
				},
				{
					"name": "select29"
				},
				{
					"name": "select30",
					"description": "column optimizing"
				},
				{
					"name": "select31"
				}
			],
			"scriptLines": [
				"source(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> source1",
				"source(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> source2",
				"source(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> source3",
				"source1 select(mapColumn(",
				"          each(match(true()),",
				"               initCap($$) = $$)",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select1",
				"source2 select(mapColumn(",
				"          {Average Cost},",
				"          {Buyer Name},",
				"          {Cum Manufacturing Lead Time},",
				"          {Cumulative Total Lead Time},",
				"          {Fixed Lead Time},",
				"          {Inventory Planning Method Code},",
				"          {Item Creation Date},",
				"          {Item Description},",
				"          {Item Number},",
				"          {Item Status Code},",
				"          {Item Type},",
				"          {Itemcatinv Item Category Kff},",
				"          {Items$Agile Access Restriction},",
				"          {Items$Agile Item  Part  Catego},",
				"          {Items$Item Setup Verified},",
				"          {Items$Vmi Item},",
				"          {Minimum Order Quantity},",
				"          {Mrp Planning Method},",
				"          {Organization Code},",
				"          {Planner Code},",
				"          {Planning Make Buy Code},",
				"          {Postprocessing Lead Time},",
				"          {Preprocessing Lead Time},",
				"          {Processing Lead Time},",
				"          {Purchase Commod},",
				"          {Purchase Commod Description},",
				"          {Receipt Routing},",
				"          {Unit Of Measure},",
				"          {Wip Supply Type},",
				"          {Target Cost},",
				"          {Item Revision Control Flag},",
				"          {Items$Comsec},",
				"          {List Price Per Unit},",
				"          {Lot Control Flag},",
				"          {Serial Number Control Code},",
				"          {Serial Starting Number},",
				"          {Serial Starting Prefix},",
				"          {Shelf Life Code},",
				"          {Shrinkage Rate},",
				"          {Track In Installed Base},",
				"          {Variable Lead Time},",
				"          {Workflow Publishing Data},",
				"          {Fixed Days Supply},",
				"          {Fixed Order Quantity},",
				"          {Right_Minimum Order Quantity}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select2",
				"source3 select(mapColumn(",
				"          each(match(/* All input columns */true()),",
				"               /* Input name */$$ = $$)",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select3",
				"select30 filter(lower(nettable) == \"nettable inventory\" && !isNull(lot_exp_date)) ~> filter1",
				"select31 aggregate(groupBy({Item Number},",
				"          {Organization Code},",
				"          {Planning Group},",
				"          {Lot Exp Date}),",
				"     {Expiring QTY} = sum({Onhand Qty})) ~> aggregate1",
				"aggregate1 select(mapColumn(",
				"          {Item Number},",
				"          {Organization Code},",
				"          {Planning Group},",
				"          {Lot Exp Date},",
				"          {Expiring QTY}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select4",
				"select4 aggregate(groupBy({Item Number},",
				"          {Organization Code},",
				"          {Planning Group}),",
				"     {Min_Lot Exp Date} = min({Lot Exp Date}),",
				"          {Sum_Expiring QTY} = sum({Expiring QTY})) ~> aggregate2",
				"aggregate2 derive(Tracker = 'Expiring Material') ~> derivedColumn1",
				"derivedColumn1 filter({Sum_Expiring QTY}>0) ~> filter2",
				"derivedColumn3 filter({Order Type} != \"Planned order\"\r",
				"&& {Order Type} != \"Purchase requisition\"\r",
				"&& {Order Type}!='Expired lot') ~> filter3",
				"select3 derive(v_date = iif( {Order Type} == 'Project inventory', toString(currentDate()),\r",
				"iif( Date < (toString(currentDate())), toString(currentDate()),Date))) ~> derivedColumn3",
				"select4 derive(Qty = concat(\"-\" , toString({Expiring QTY})),",
				"          {Order Type} = 'Expiring Lot Demand',",
				"          {Expiring Lot Demand} = concat(\"-\" , toString({Expiring QTY})),",
				"          v_lot_exp_date = iif({Lot Exp Date} < currentDate(),currentDate(),{Lot Exp Date})) ~> derivedColumn4",
				"derivedColumn4 select(mapColumn(",
				"          {Item Number},",
				"          Org = {Organization Code},",
				"          {Planning Group},",
				"          Qty,",
				"          {Order Type},",
				"          {Expiring Lot Demand},",
				"          {Date     } = v_lot_exp_date",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select5",
				"filter3, select5 union(byName: true)~> union2",
				"union2, select2 join(Org == {Organization Code}",
				"     && union2@{Item Number} == select2@{Item Number},",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join1",
				"select6 derive(Inventory = iif( {Order Type}=='Project inventory', Qty,\"0\"),",
				"          Supply = iif( toString(Qty) > '0' && {Order Type} != 'Project inventory' && {Order Type} != 'Planned order' , toString(Qty) ,'0'),",
				"          {AR Demand} = iif(toString(Qty) < '0' && \r",
				"    instr({Using Assembly},'PB') !=0 || \r",
				"    instr({Using Assembly},'SS') !=0 ,\r",
				"    toString(Qty),'0')) ~> derivedColumn5",
				"join1 select(mapColumn(",
				"          Action,",
				"          {Alternate Bom Designator},",
				"          {Alternate Routing Designator},",
				"          Applied,",
				"          {Avg Item Cost},",
				"          {Award Classification},",
				"          {Award Group},",
				"          {BOM Item Type},",
				"          {Build In Wip Flag},",
				"          {Build Sequence},",
				"          Buyer,",
				"          {Buyer Org},",
				"          {Buyer Type},",
				"          {Cfm Routing Flag},",
				"          {Change Notice},",
				"          {Component Revision},",
				"          {Compression Days},",
				"          {Cum Manufacturing Lead Time},",
				"          {Cumulative Total Lead Time},",
				"          Date,",
				"          {Date Published},",
				"          {Days From Today},",
				"          Division,",
				"          {Extended Cost},",
				"          {Extended Cost (ABS)},",
				"          {Firm Planned Type},",
				"          {First Unit Start Date},",
				"          {Fiscal Date},",
				"          {Right_Fixed Lead Time} = {Fixed Lead Time},",
				"          {Full Pegging},",
				"          {Implement As Text},",
				"          {Implement Date},",
				"          {Implement Employee Id},",
				"          {Implement Quantity Rate},",
				"          {Implementation Date},",
				"          {Implemented Quantity},",
				"          {In Source Plan},",
				"          {Inventory Item Id},",
				"          {Item Avg Cost},",
				"          {Item Description},",
				"          {Item MRP Plan},",
				"          {Item Number},",
				"          {Item Planning Cat Code},",
				"          {Item Purchasable Flag},",
				"          {Item Rev},",
				"          {Item Status Code},",
				"          {Item Type},",
				"          {Last Unit Completion Date},",
				"          {Last Unit Start Date},",
				"          {Line Code},",
				"          {List Price},",
				"          {Locator Id},",
				"          {Lot Number},",
				"          {Lot Status},",
				"          {Make Buy},",
				"          Manager,",
				"          {Mrp Planning Method},",
				"          Nettable,",
				"          {New Date},",
				"          {New Quantity},",
				"          {Old Dock Date},",
				"          {Old Due Date},",
				"          {Old Order Quantity},",
				"          {On Hand Qty},",
				"          {Order Number},",
				"          {Order Type},",
				"          Org,",
				"          {Organization Id},",
				"          {Planner Code},",
				"          {Planning Group Quantity},",
				"          {PO Price},",
				"          {Postprocessing Lead Time},",
				"          {Preprocessing Lead Time},",
				"          {Process Days},",
				"          {Processing Lead Time},",
				"          {Product Line},",
				"          {Product Line Segment},",
				"          {Product Segment},",
				"          Project,",
				"          {Project Business Area},",
				"          {Project Manager Name},",
				"          {Project Name},",
				"          {Project Number},",
				"          {Purchase Commod},",
				"          Qty,",
				"          {Quantity In Process},",
				"          {Receipt Routing},",
				"          {Release Errors},",
				"          {Release Time Fence Code},",
				"          {Repetitive Type},",
				"          {Report Date},",
				"          {Rescheduled Flag},",
				"          {Schedule Group},",
				"          {Source Org},",
				"          {Source Schedule},",
				"          {Source Table},",
				"          Status,",
				"          {Status Code},",
				"          {Sugg Dock Date},",
				"          {Sugg Due Date},",
				"          {Sugg Order Date},",
				"          {Sugg Start Date},",
				"          {Suggested Req Buyer},",
				"          {Sum_Project Onhand Qty},",
				"          Supplier,",
				"          {Supplier Code},",
				"          {Supply Avail Date},",
				"          {Task Number},",
				"          {Transaction Id},",
				"          {Unit Number},",
				"          {Using Assembly},",
				"          {Wip Supply Type},",
				"          {Workflow Publishing Data},",
				"          {Planning Group},",
				"          {Hold Attribute},",
				"          {Suggested Buyer Name},",
				"          {Itemcatpur Category Desc},",
				"          {Items$Comsec},",
				"          {Item Revision Control Flag},",
				"          {List Price Per Unit},",
				"          {Lot Control Flag},",
				"          {Serial Number Control Code},",
				"          {Serial Starting Number},",
				"          {Serial Starting Prefix},",
				"          {Shelf Life Code},",
				"          {Shelf Life Days},",
				"          {Shrinkage Rate},",
				"          {Track In Installed Base},",
				"          {Variable Lead Time},",
				"          {Purchase Commod Description},",
				"          {Items$Vmi Item},",
				"          {Items$Target Cost},",
				"          {Hazard Class},",
				"          {Hazard Class Description},",
				"          {Hazardous Material Flag},",
				"          {Item Replenishment Type},",
				"          {Mtl Transactions Enabled Flag},",
				"          {Minimum Order Quantity},",
				"          {Items$Country Of Origin},",
				"          {Solumina Security Group},",
				"          {Items$Agile Access Restriction},",
				"          {Repo Load Dttm},",
				"          {Right_Repo Load Dttm},",
				"          {Supply/Demand},",
				"          {Supply Planning},",
				"          v_date,",
				"          {Expiring Lot Demand},",
				"          {Date     },",
				"          {Average Cost},",
				"          {Buyer Name},",
				"          {Cum Manufacturing Lead Time} = select2@{Cum Manufacturing Lead Time},",
				"          {Cumulative Total Lead Time} = select2@{Cumulative Total Lead Time},",
				"          {Fixed Lead Time} = select2@{Fixed Lead Time},",
				"          {Right_Inventory Planning Method Code} = {Inventory Planning Method Code},",
				"          {Item Creation Date},",
				"          {Right_Item Description} = select2@{Item Description},",
				"          {Right_Item Number} = select2@{Item Number},",
				"          {Item Status Code} = select2@{Item Status Code},",
				"          {Right_Item Type} = select2@{Item Type},",
				"          {Itemcatinv Item Category Kff},",
				"          {Right_Items$Agile Access Restriction} = select2@{Items$Agile Access Restriction},",
				"          {Items$Agile Item  Part  Catego},",
				"          {Items$Item Setup Verified},",
				"          {Right_Items$Vmi Item} = select2@{Items$Vmi Item},",
				"          {Right_Minimum Order Quantity} = select2@{Minimum Order Quantity},",
				"          {Right_Mrp Planning Method} = select2@{Mrp Planning Method},",
				"          {Organization Code},",
				"          {Planner Code} = select2@{Planner Code},",
				"          {Planning Make Buy Code},",
				"          {Right_Postprocessing Lead Time} = select2@{Postprocessing Lead Time},",
				"          {Right_Preprocessing Lead Time} = select2@{Preprocessing Lead Time},",
				"          {Right_Processing Lead Time} = select2@{Processing Lead Time},",
				"          {Purchase Commod} = select2@{Purchase Commod},",
				"          {Purchase Commod Description} = select2@{Purchase Commod Description},",
				"          {Receipt Routing} = select2@{Receipt Routing},",
				"          {Unit Of Measure},",
				"          {Wip Supply Type} = select2@{Wip Supply Type},",
				"          {Target Cost},",
				"          {Item Revision Control Flag} = select2@{Item Revision Control Flag},",
				"          {Items$Comsec} = select2@{Items$Comsec},",
				"          {List Price Per Unit} = select2@{List Price Per Unit},",
				"          {Lot Control Flag} = select2@{Lot Control Flag},",
				"          {Serial Number Control Code} = select2@{Serial Number Control Code},",
				"          {Serial Starting Number} = select2@{Serial Starting Number},",
				"          {Serial Starting Prefix} = select2@{Serial Starting Prefix},",
				"          {Right_Shelf Life Code} = select2@{Shelf Life Code},",
				"          {Shrinkage Rate} = select2@{Shrinkage Rate},",
				"          {Track In Installed Base} = select2@{Track In Installed Base},",
				"          {Variable Lead Time} = select2@{Variable Lead Time},",
				"          {Workflow Publishing Data} = select2@{Workflow Publishing Data},",
				"          {Fixed Days Supply},",
				"          {Fixed Order Quantity},",
				"          {Right_Minimum Order Quantity}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select6",
				"cast2 select(mapColumn(",
				"          each(match(/* All input columns */true()),",
				"               /* Input name */$$ = $$)",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select7",
				"select7 derive({PO Date} = iif ({Order Type}!='Project Inventory' && {Supply/Demand}=='Supply', Date,'')) ~> derivedColumn6",
				"derivedColumn7 filter({PO Date}!= '') ~> filter4",
				"sort1 aggregate(groupBy({Item Number},",
				"          Org,",
				"          {Planning Group}),",
				"     MIN_PO_Date = min(Date),",
				"          {Sum_AR Demand} = sum({AR Demand})) ~> aggregate4",
				"filter4 cast(output(",
				"          {AR Demand} as integer",
				"     ),",
				"     errors: true) ~> cast1",
				"derivedColumn6 derive(v_po_date = iif({PO Date}< toString(currentDate()),toString(currentDate()),{PO Date} )) ~> derivedColumn7",
				"cast1 select(mapColumn(",
				"          each(match(/* All input columns */true()),",
				"               /* Input name */$$ = $$)",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select8",
				"select8 sort(asc({Item Number}, true),",
				"     asc(Org, true),",
				"     asc({Planning Group}, true)) ~> sort1",
				"aggregate4 derive(Tracker = 'Planning BOM') ~> derivedColumn8",
				"select10, select9 union(byName: true)~> union3",
				"derivedColumn8 select(mapColumn(",
				"          {Item Number},",
				"          Org,",
				"          {Planning Group},",
				"          MIN_PO_Date,",
				"          {Sum_AR Demand},",
				"          Tracker",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select9",
				"filter2 select(mapColumn(",
				"          {Item Number},",
				"          {Organization Code},",
				"          {Planning Group},",
				"          {Min_Lot Exp Date},",
				"          {Sum_Expiring QTY},",
				"          Tracker",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select10",
				"sort2 aggregate(groupBy({Item Number},",
				"          Org,",
				"          {Planning Group},",
				"          {Shelf Life Code}),",
				"     {AR Demand} = sum({AR Demand}),",
				"          {Expiring Lot Demand} = sum({Expiring Lot Demand})) ~> aggregate5",
				"derivedColumn5 cast(output(",
				"          {Expiring Lot Demand} as integer,",
				"          {AR Demand} as integer",
				"     ),",
				"     errors: true) ~> cast2",
				"select7 sort(asc({Item Number}, true),",
				"     asc(Org, true),",
				"     asc({Planning Group}, true),",
				"     asc({Shelf Life Code}, true)) ~> sort2",
				"aggregate5 select(mapColumn(",
				"          {Item Number},",
				"          Org,",
				"          {Planning Group},",
				"          {Shelf Life Code},",
				"          {AR Demand},",
				"          {Expiring Lot Demand}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select11",
				"select11 filter({AR Demand} < 0) ~> filter5",
				"select11 filter({Expiring Lot Demand} < 0 || {Shelf Life Code} != \"No shelf life control\") ~> filter6",
				"select7, filter6 join(select7@{Item Number} == select11@{Item Number}",
				"     && select7@Org == select11@Org",
				"     && select7@{Planning Group} == select11@{Planning Group},",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join2",
				"select7, filter5 join(select7@{Item Number} == select11@{Item Number}",
				"     && select7@Org == select11@Org",
				"     && select7@{Planning Group} == select11@{Planning Group},",
				"     joinType:'inner',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join3",
				"join2 derive(Demand = iif( toString(Qty)< '0' , toString(Qty), '0'),",
				"          Tracker = 'Expiring Material') ~> derivedColumn9",
				"join3 derive(Demand = iif(toString(Qty)< '0' && {Order Type}!='Expiring Lot Demand', toString(Qty), '0'),",
				"          Tracker = 'Planning BOM') ~> derivedColumn10",
				"union3 select(mapColumn(",
				"          {Item Number},",
				"          {Organization Code},",
				"          {Planning Group},",
				"          {Min_Lot Exp Date},",
				"          {Sum_Expiring QTY},",
				"          Tracker,",
				"          Org,",
				"          MIN_PO_Date,",
				"          {Sum_AR Demand}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select12",
				"derivedColumn10 select(mapColumn(",
				"          Action,",
				"          {Alternate Bom Designator},",
				"          {Alternate Routing Designator},",
				"          Applied,",
				"          {Avg Item Cost},",
				"          {Award Classification},",
				"          {Award Group},",
				"          {BOM Item Type},",
				"          {Build In Wip Flag},",
				"          {Build Sequence},",
				"          Buyer,",
				"          {Buyer Org},",
				"          {Buyer Type},",
				"          {Cfm Routing Flag},",
				"          {Change Notice},",
				"          {Component Revision},",
				"          {Compression Days},",
				"          {Cum Manufacturing Lead Time},",
				"          {Cumulative Total Lead Time},",
				"          Date,",
				"          {Date Published},",
				"          {Days From Today},",
				"          Division,",
				"          {Extended Cost},",
				"          {Extended Cost (ABS)},",
				"          {Firm Planned Type},",
				"          {First Unit Start Date},",
				"          {Fiscal Date},",
				"          {Right_Fixed Lead Time},",
				"          {Full Pegging},",
				"          {Implement As Text},",
				"          {Implement Date},",
				"          {Implement Employee Id},",
				"          {Implement Quantity Rate},",
				"          {Implementation Date},",
				"          {Implemented Quantity},",
				"          {In Source Plan},",
				"          {Inventory Item Id},",
				"          {Item Avg Cost},",
				"          {Item Description},",
				"          {Item MRP Plan},",
				"          {Item Number} = select7@{Item Number},",
				"          {Item Planning Cat Code},",
				"          {Item Purchasable Flag},",
				"          {Item Rev},",
				"          {Item Status Code},",
				"          {Item Type},",
				"          {Last Unit Completion Date},",
				"          {Last Unit Start Date},",
				"          {Line Code},",
				"          {List Price},",
				"          {Locator Id},",
				"          {Lot Number},",
				"          {Lot Status},",
				"          {Make Buy},",
				"          Manager,",
				"          {Mrp Planning Method},",
				"          Nettable,",
				"          {New Date},",
				"          {New Quantity},",
				"          {Old Dock Date},",
				"          {Old Due Date},",
				"          {Old Order Quantity},",
				"          {On Hand Qty},",
				"          {Order Number},",
				"          {Order Type},",
				"          Org = select7@Org,",
				"          {Organization Id},",
				"          {Planner Code},",
				"          {Planning Group Quantity},",
				"          {PO Price},",
				"          {Postprocessing Lead Time},",
				"          {Preprocessing Lead Time},",
				"          {Process Days},",
				"          {Processing Lead Time},",
				"          {Product Line},",
				"          {Product Line Segment},",
				"          {Product Segment},",
				"          Project,",
				"          {Project Business Area},",
				"          {Project Manager Name},",
				"          {Project Name},",
				"          {Project Number},",
				"          {Purchase Commod},",
				"          Qty,",
				"          {Quantity In Process},",
				"          {Receipt Routing},",
				"          {Release Errors},",
				"          {Release Time Fence Code},",
				"          {Repetitive Type},",
				"          {Report Date},",
				"          {Rescheduled Flag},",
				"          {Schedule Group},",
				"          {Source Org},",
				"          {Source Schedule},",
				"          {Source Table},",
				"          Status,",
				"          {Status Code},",
				"          {Sugg Dock Date},",
				"          {Sugg Due Date},",
				"          {Sugg Order Date},",
				"          {Sugg Start Date},",
				"          {Suggested Req Buyer},",
				"          {Sum_Project Onhand Qty},",
				"          Supplier,",
				"          {Supplier Code},",
				"          {Supply Avail Date},",
				"          {Task Number},",
				"          {Transaction Id},",
				"          {Unit Number},",
				"          {Using Assembly},",
				"          {Wip Supply Type},",
				"          {Workflow Publishing Data},",
				"          {Planning Group} = select7@{Planning Group},",
				"          {Hold Attribute},",
				"          {Suggested Buyer Name},",
				"          {Itemcatpur Category Desc},",
				"          {Items$Comsec},",
				"          {Item Revision Control Flag},",
				"          {List Price Per Unit},",
				"          {Lot Control Flag},",
				"          {Serial Number Control Code},",
				"          {Serial Starting Number},",
				"          {Serial Starting Prefix},",
				"          {Shelf Life Code} = select7@{Shelf Life Code},",
				"          {Shelf Life Days},",
				"          {Shrinkage Rate},",
				"          {Track In Installed Base},",
				"          {Variable Lead Time},",
				"          {Purchase Commod Description},",
				"          {Items$Vmi Item},",
				"          {Items$Target Cost},",
				"          {Hazard Class},",
				"          {Hazard Class Description},",
				"          {Hazardous Material Flag},",
				"          {Item Replenishment Type},",
				"          {Mtl Transactions Enabled Flag},",
				"          {Minimum Order Quantity},",
				"          {Items$Country Of Origin},",
				"          {Solumina Security Group},",
				"          {Items$Agile Access Restriction},",
				"          {Repo Load Dttm},",
				"          {Right_Repo Load Dttm},",
				"          {Supply/Demand},",
				"          {Supply Planning},",
				"          v_date,",
				"          {Expiring Lot Demand} = select7@{Expiring Lot Demand},",
				"          {Date     },",
				"          {Average Cost},",
				"          {Buyer Name},",
				"          {Fixed Lead Time},",
				"          {Right_Inventory Planning Method Code},",
				"          {Item Creation Date},",
				"          {Right_Item Description},",
				"          {Right_Item Number},",
				"          {Right_Item Type},",
				"          {Itemcatinv Item Category Kff},",
				"          {Right_Items$Agile Access Restriction},",
				"          {Items$Agile Item  Part  Catego},",
				"          {Items$Item Setup Verified},",
				"          {Right_Items$Vmi Item},",
				"          {Right_Minimum Order Quantity},",
				"          {Right_Mrp Planning Method},",
				"          {Organization Code},",
				"          {Planning Make Buy Code},",
				"          {Right_Postprocessing Lead Time},",
				"          {Right_Preprocessing Lead Time},",
				"          {Right_Processing Lead Time},",
				"          {Unit Of Measure},",
				"          {Target Cost},",
				"          {Right_Shelf Life Code},",
				"          {Fixed Days Supply},",
				"          {Fixed Order Quantity},",
				"          Inventory,",
				"          Supply,",
				"          {AR Demand} = select7@{AR Demand},",
				"          {Item Number} = select11@{Item Number},",
				"          Org = select11@Org,",
				"          {Planning Group} = select11@{Planning Group},",
				"          {Shelf Life Code},",
				"          {AR Demand} = select11@{AR Demand},",
				"          {Expiring Lot Demand} = select11@{Expiring Lot Demand},",
				"          Demand,",
				"          Tracker",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select13",
				"derivedColumn9 select(mapColumn(",
				"          Action,",
				"          {Alternate Bom Designator},",
				"          {Alternate Routing Designator},",
				"          Applied,",
				"          {Avg Item Cost},",
				"          {Award Classification},",
				"          {Award Group},",
				"          {BOM Item Type},",
				"          {Build In Wip Flag},",
				"          {Build Sequence},",
				"          Buyer,",
				"          {Buyer Org},",
				"          {Buyer Type},",
				"          {Cfm Routing Flag},",
				"          {Change Notice},",
				"          {Component Revision},",
				"          {Compression Days},",
				"          {Cum Manufacturing Lead Time},",
				"          {Cumulative Total Lead Time},",
				"          Date,",
				"          {Date Published},",
				"          {Days From Today},",
				"          Division,",
				"          {Extended Cost},",
				"          {Extended Cost (ABS)},",
				"          {Firm Planned Type},",
				"          {First Unit Start Date},",
				"          {Fiscal Date},",
				"          {Right_Fixed Lead Time},",
				"          {Full Pegging},",
				"          {Implement As Text},",
				"          {Implement Date},",
				"          {Implement Employee Id},",
				"          {Implement Quantity Rate},",
				"          {Implementation Date},",
				"          {Implemented Quantity},",
				"          {In Source Plan},",
				"          {Inventory Item Id},",
				"          {Item Avg Cost},",
				"          {Item Description},",
				"          {Item MRP Plan},",
				"          {Item Number} = select7@{Item Number},",
				"          {Item Planning Cat Code},",
				"          {Item Purchasable Flag},",
				"          {Item Rev},",
				"          {Item Status Code},",
				"          {Item Type},",
				"          {Last Unit Completion Date},",
				"          {Last Unit Start Date},",
				"          {Line Code},",
				"          {List Price},",
				"          {Locator Id},",
				"          {Lot Number},",
				"          {Lot Status},",
				"          {Make Buy},",
				"          Manager,",
				"          {Mrp Planning Method},",
				"          Nettable,",
				"          {New Date},",
				"          {New Quantity},",
				"          {Old Dock Date},",
				"          {Old Due Date},",
				"          {Old Order Quantity},",
				"          {On Hand Qty},",
				"          {Order Number},",
				"          {Order Type},",
				"          Org = select7@Org,",
				"          {Organization Id},",
				"          {Planner Code},",
				"          {Planning Group Quantity},",
				"          {PO Price},",
				"          {Postprocessing Lead Time},",
				"          {Preprocessing Lead Time},",
				"          {Process Days},",
				"          {Processing Lead Time},",
				"          {Product Line},",
				"          {Product Line Segment},",
				"          {Product Segment},",
				"          Project,",
				"          {Project Business Area},",
				"          {Project Manager Name},",
				"          {Project Name},",
				"          {Project Number},",
				"          {Purchase Commod},",
				"          Qty,",
				"          {Quantity In Process},",
				"          {Receipt Routing},",
				"          {Release Errors},",
				"          {Release Time Fence Code},",
				"          {Repetitive Type},",
				"          {Report Date},",
				"          {Rescheduled Flag},",
				"          {Schedule Group},",
				"          {Source Org},",
				"          {Source Schedule},",
				"          {Source Table},",
				"          Status,",
				"          {Status Code},",
				"          {Sugg Dock Date},",
				"          {Sugg Due Date},",
				"          {Sugg Order Date},",
				"          {Sugg Start Date},",
				"          {Suggested Req Buyer},",
				"          {Sum_Project Onhand Qty},",
				"          Supplier,",
				"          {Supplier Code},",
				"          {Supply Avail Date},",
				"          {Task Number},",
				"          {Transaction Id},",
				"          {Unit Number},",
				"          {Using Assembly},",
				"          {Wip Supply Type},",
				"          {Workflow Publishing Data},",
				"          {Planning Group} = select7@{Planning Group},",
				"          {Hold Attribute},",
				"          {Suggested Buyer Name},",
				"          {Itemcatpur Category Desc},",
				"          {Items$Comsec},",
				"          {Item Revision Control Flag},",
				"          {List Price Per Unit},",
				"          {Lot Control Flag},",
				"          {Serial Number Control Code},",
				"          {Serial Starting Number},",
				"          {Serial Starting Prefix},",
				"          {Shelf Life Code} = select7@{Shelf Life Code},",
				"          {Shelf Life Days},",
				"          {Shrinkage Rate},",
				"          {Track In Installed Base},",
				"          {Variable Lead Time},",
				"          {Purchase Commod Description},",
				"          {Items$Vmi Item},",
				"          {Items$Target Cost},",
				"          {Hazard Class},",
				"          {Hazard Class Description},",
				"          {Hazardous Material Flag},",
				"          {Item Replenishment Type},",
				"          {Mtl Transactions Enabled Flag},",
				"          {Minimum Order Quantity},",
				"          {Items$Country Of Origin},",
				"          {Solumina Security Group},",
				"          {Items$Agile Access Restriction},",
				"          {Repo Load Dttm},",
				"          {Right_Repo Load Dttm},",
				"          {Supply/Demand},",
				"          {Supply Planning},",
				"          v_date,",
				"          {Expiring Lot Demand} = select7@{Expiring Lot Demand},",
				"          {Date     },",
				"          {Average Cost},",
				"          {Buyer Name},",
				"          {Fixed Lead Time},",
				"          {Right_Inventory Planning Method Code},",
				"          {Item Creation Date},",
				"          {Right_Item Description},",
				"          {Right_Item Number},",
				"          {Right_Item Type},",
				"          {Itemcatinv Item Category Kff},",
				"          {Right_Items$Agile Access Restriction},",
				"          {Items$Agile Item  Part  Catego},",
				"          {Items$Item Setup Verified},",
				"          {Right_Items$Vmi Item},",
				"          {Right_Minimum Order Quantity},",
				"          {Right_Mrp Planning Method},",
				"          {Organization Code},",
				"          {Planning Make Buy Code},",
				"          {Right_Postprocessing Lead Time},",
				"          {Right_Preprocessing Lead Time},",
				"          {Right_Processing Lead Time},",
				"          {Unit Of Measure},",
				"          {Target Cost},",
				"          {Right_Shelf Life Code},",
				"          {Fixed Days Supply},",
				"          {Fixed Order Quantity},",
				"          Inventory,",
				"          Supply,",
				"          {AR Demand} = select7@{AR Demand},",
				"          {Item Number} = select11@{Item Number},",
				"          Org = select11@Org,",
				"          {Planning Group} = select11@{Planning Group},",
				"          {Shelf Life Code},",
				"          {AR Demand} = select11@{AR Demand},",
				"          {Expiring Lot Demand} = select11@{Expiring Lot Demand},",
				"          Demand,",
				"          Tracker",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select14",
				"select13, select14 union(byName: true)~> union4",
				"union4 select(mapColumn(",
				"          Action,",
				"          {Alternate Bom Designator},",
				"          {Alternate Routing Designator},",
				"          Applied,",
				"          {Avg Item Cost},",
				"          {Award Classification},",
				"          {Award Group},",
				"          {BOM Item Type},",
				"          {Build In Wip Flag},",
				"          {Build Sequence},",
				"          Buyer,",
				"          {Buyer Org},",
				"          {Buyer Type},",
				"          {Cfm Routing Flag},",
				"          {Change Notice},",
				"          {Component Revision},",
				"          {Compression Days},",
				"          {Cum Manufacturing Lead Time},",
				"          {Cumulative Total Lead Time},",
				"          Date,",
				"          {Date Published},",
				"          {Days From Today},",
				"          Division,",
				"          {Extended Cost},",
				"          {Extended Cost (ABS)},",
				"          {Firm Planned Type},",
				"          {First Unit Start Date},",
				"          {Fiscal Date},",
				"          {Right_Fixed Lead Time},",
				"          {Full Pegging},",
				"          {Implement As Text},",
				"          {Implement Date},",
				"          {Implement Employee Id},",
				"          {Implement Quantity Rate},",
				"          {Implementation Date},",
				"          {Implemented Quantity},",
				"          {In Source Plan},",
				"          {Inventory Item Id},",
				"          {Item Avg Cost},",
				"          {Item Description},",
				"          {Item MRP Plan},",
				"          {Item Number},",
				"          {Item Planning Cat Code},",
				"          {Item Purchasable Flag},",
				"          {Item Rev},",
				"          {Item Status Code},",
				"          {Item Type},",
				"          {Last Unit Completion Date},",
				"          {Last Unit Start Date},",
				"          {Line Code},",
				"          {List Price},",
				"          {Locator Id},",
				"          {Lot Number},",
				"          {Lot Status},",
				"          {Make Buy},",
				"          Manager,",
				"          {Mrp Planning Method},",
				"          Nettable,",
				"          {New Date},",
				"          {New Quantity},",
				"          {Old Dock Date},",
				"          {Old Due Date},",
				"          {Old Order Quantity},",
				"          {On Hand Qty},",
				"          {Order Number},",
				"          {Order Type},",
				"          Org,",
				"          {Organization Id},",
				"          {Planner Code},",
				"          {Planning Group Quantity},",
				"          {PO Price},",
				"          {Postprocessing Lead Time},",
				"          {Preprocessing Lead Time},",
				"          {Process Days},",
				"          {Processing Lead Time},",
				"          {Product Line},",
				"          {Product Line Segment},",
				"          {Product Segment},",
				"          Project,",
				"          {Project Business Area},",
				"          {Project Manager Name},",
				"          {Project Name},",
				"          {Project Number},",
				"          {Purchase Commod},",
				"          Qty,",
				"          {Quantity In Process},",
				"          {Receipt Routing},",
				"          {Release Errors},",
				"          {Release Time Fence Code},",
				"          {Repetitive Type},",
				"          {Report Date},",
				"          {Rescheduled Flag},",
				"          {Schedule Group},",
				"          {Source Org},",
				"          {Source Schedule},",
				"          {Source Table},",
				"          Status,",
				"          {Status Code},",
				"          {Sugg Dock Date},",
				"          {Sugg Due Date},",
				"          {Sugg Order Date},",
				"          {Sugg Start Date},",
				"          {Suggested Req Buyer},",
				"          {Sum_Project Onhand Qty},",
				"          Supplier,",
				"          {Supplier Code},",
				"          {Supply Avail Date},",
				"          {Task Number},",
				"          {Transaction Id},",
				"          {Unit Number},",
				"          {Using Assembly},",
				"          {Wip Supply Type},",
				"          {Workflow Publishing Data},",
				"          {Planning Group},",
				"          {Hold Attribute},",
				"          {Suggested Buyer Name},",
				"          {Itemcatpur Category Desc},",
				"          {Items$Comsec},",
				"          {Item Revision Control Flag},",
				"          {List Price Per Unit},",
				"          {Lot Control Flag},",
				"          {Serial Number Control Code},",
				"          {Serial Starting Number},",
				"          {Serial Starting Prefix},",
				"          {Shelf Life Code},",
				"          {Shelf Life Days},",
				"          {Shrinkage Rate},",
				"          {Track In Installed Base},",
				"          {Variable Lead Time},",
				"          {Purchase Commod Description},",
				"          {Items$Vmi Item},",
				"          {Items$Target Cost},",
				"          {Hazard Class},",
				"          {Hazard Class Description},",
				"          {Hazardous Material Flag},",
				"          {Item Replenishment Type},",
				"          {Mtl Transactions Enabled Flag},",
				"          {Minimum Order Quantity},",
				"          {Items$Country Of Origin},",
				"          {Solumina Security Group},",
				"          {Items$Agile Access Restriction},",
				"          {Repo Load Dttm},",
				"          {Right_Repo Load Dttm},",
				"          {Supply/Demand},",
				"          {Supply Planning},",
				"          v_date,",
				"          {Expiring Lot Demand},",
				"          {Date     },",
				"          {Average Cost},",
				"          {Buyer Name},",
				"          {Fixed Lead Time},",
				"          {Right_Inventory Planning Method Code},",
				"          {Item Creation Date},",
				"          {Right_Item Description},",
				"          {Right_Item Number},",
				"          {Right_Item Type},",
				"          {Itemcatinv Item Category Kff},",
				"          {Right_Items$Agile Access Restriction},",
				"          {Items$Agile Item  Part  Catego},",
				"          {Items$Item Setup Verified},",
				"          {Right_Items$Vmi Item},",
				"          {Right_Minimum Order Quantity},",
				"          {Right_Mrp Planning Method},",
				"          {Organization Code},",
				"          {Planning Make Buy Code},",
				"          {Right_Postprocessing Lead Time},",
				"          {Right_Preprocessing Lead Time},",
				"          {Right_Processing Lead Time},",
				"          {Unit Of Measure},",
				"          {Target Cost},",
				"          {Right_Shelf Life Code},",
				"          {Fixed Days Supply},",
				"          {Fixed Order Quantity},",
				"          Inventory,",
				"          Supply,",
				"          {AR Demand},",
				"          Demand,",
				"          Tracker",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select15",
				"select15 derive({Demand Toggle} = 'AR Demand',",
				"          v_demand = {AR Demand},",
				"          v_qty = iif({Supply/Demand}=='Demand', toString({AR Demand}) ,toString(Qty))) ~> derivedColumn11",
				"select15 derive({Demand Toggle} = 'All Demand') ~> derivedColumn12",
				"derivedColumn12, derivedColumn11 union(byName: true)~> union5",
				"union5 derive(PAB = v_qty) ~> derivedColumn13",
				"derivedColumn13 select(mapColumn(",
				"          {Avg Item Cost},",
				"          Buyer,",
				"          {Buyer Org},",
				"          {Extended Cost},",
				"          {Firm Planned Type},",
				"          {Item Avg Cost},",
				"          {Item Description},",
				"          {Item Number},",
				"          {Item Type},",
				"          {List Price},",
				"          {Make Buy},",
				"          {Mrp Planning Method},",
				"          {Order Type},",
				"          Org,",
				"          {PO Price},",
				"          {Postprocessing Lead Time},",
				"          {Preprocessing Lead Time},",
				"          {Processing Lead Time},",
				"          Project,",
				"          {Project Number},",
				"          {Task Number},",
				"          {Using Assembly},",
				"          {Planning Group},",
				"          {Itemcatpur Category Desc},",
				"          {Items$Comsec},",
				"          {Item Revision Control Flag},",
				"          {List Price Per Unit},",
				"          {Lot Control Flag},",
				"          {Serial Number Control Code},",
				"          {Serial Starting Number},",
				"          {Serial Starting Prefix},",
				"          {Shelf Life Code},",
				"          {Shelf Life Days},",
				"          {Shrinkage Rate},",
				"          {Track In Installed Base},",
				"          {Variable Lead Time},",
				"          {Purchase Commod Description},",
				"          {Items$Vmi Item},",
				"          {Items$Target Cost},",
				"          {Hazard Class},",
				"          {Hazard Class Description},",
				"          {Hazardous Material Flag},",
				"          {Item Replenishment Type},",
				"          {Mtl Transactions Enabled Flag},",
				"          {Minimum Order Quantity},",
				"          {Items$Country Of Origin},",
				"          {Solumina Security Group},",
				"          {Items$Agile Access Restriction},",
				"          {Repo Load Dttm},",
				"          {Right_Repo Load Dttm},",
				"          {Supply/Demand},",
				"          v_date,",
				"          {Expiring Lot Demand},",
				"          {Fixed Lead Time},",
				"          {Right_Minimum Order Quantity},",
				"          {Target Cost},",
				"          {Right_Shelf Life Code},",
				"          Inventory,",
				"          Supply,",
				"          Demand = v_demand,",
				"          Qty = v_qty,",
				"          PAB,",
				"          {Planning Group},",
				"          {AR Demand},",
				"          {Demand Toggle},",
				"          Tracker",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select16",
				"select16 derive({Avg Item Cost} = iifNull({Avg Item Cost},''),",
				"          Buyer = iifNull(Buyer,''),",
				"          {Buyer Org} = iifNull({Buyer Org},''),",
				"          v_date = iifNull(v_date,''),",
				"          {Extended Cost} = iifNull({Extended Cost},''),",
				"          {Firm Planned Type} = iifNull({Firm Planned Type},''),",
				"          {Fixed Lead Time} = iifNull({Fixed Lead Time},''),",
				"          {Item Avg Cost} = iifNull({Item Avg Cost},''),",
				"          {Item Description} = iifNull({Item Description},''),",
				"          {Item Number} = iifNull({Item Number},''),",
				"          {Item Type} = iifNull({Item Type},''),",
				"          {List Price} = iifNull({List Price},''),",
				"          {Make Buy} = iifNull({Make Buy},''),",
				"          {Mrp Planning Method} = iifNull({Mrp Planning Method},''),",
				"          {Order Type} = iifNull({Order Type},''),",
				"          Org = iifNull(Org,''),",
				"          {Planning Group} = iifNull({Planning Group},''),",
				"          {PO Price} = iifNull({PO Price},''),",
				"          {Postprocessing Lead Time} = iifNull({Postprocessing Lead Time},''),",
				"          {Preprocessing Lead Time} = iifNull({Preprocessing Lead Time},''),",
				"          {Processing Lead Time} = iifNull({Processing Lead Time},''),",
				"          Project = iifNull(Project,''),",
				"          {Project Number} = iifNull({Project Number},''),",
				"          Qty = iifNull(Qty,''),",
				"          {Supply/Demand} = iifNull({Supply/Demand},''),",
				"          {Task Number} = iifNull({Task Number},''),",
				"          {Using Assembly} = iifNull({Using Assembly},''),",
				"          {Purchase Commod Description} = iifNull({Purchase Commod Description},''),",
				"          Inventory = iifNull(Inventory,''),",
				"          Supply = iifNull(Supply,''),",
				"          {AR Demand} = iifNull({AR Demand},0),",
				"          Demand = iifNull(Demand,0),",
				"          {Demand Toggle} = iifNull({Demand Toggle},''),",
				"          PAB = iifNull(PAB,''),",
				"          current_date = currentDate()) ~> derivedColumn14",
				"cast3 select(mapColumn(",
				"          {Avg Item Cost},",
				"          Buyer,",
				"          {Buyer Org},",
				"          {Extended Cost},",
				"          {Firm Planned Type},",
				"          {Item Avg Cost},",
				"          {Item Description},",
				"          {Item Number},",
				"          {Item Type},",
				"          {List Price},",
				"          {Make Buy},",
				"          {Mrp Planning Method},",
				"          {Order Type},",
				"          Org,",
				"          {PO Price},",
				"          {Postprocessing Lead Time},",
				"          {Preprocessing Lead Time},",
				"          {Processing Lead Time},",
				"          Project,",
				"          {Project Number},",
				"          {Task Number},",
				"          {Using Assembly},",
				"          {Planning Group},",
				"          {Itemcatpur Category Desc},",
				"          {Items$Comsec},",
				"          {Item Revision Control Flag},",
				"          {List Price Per Unit},",
				"          {Lot Control Flag},",
				"          {Serial Number Control Code},",
				"          {Serial Starting Number},",
				"          {Serial Starting Prefix},",
				"          {Shelf Life Code},",
				"          {Shelf Life Days},",
				"          {Shrinkage Rate},",
				"          {Track In Installed Base},",
				"          {Variable Lead Time},",
				"          {Purchase Commod Description},",
				"          {Items$Vmi Item},",
				"          {Items$Target Cost},",
				"          {Hazard Class},",
				"          {Hazard Class Description},",
				"          {Hazardous Material Flag},",
				"          {Item Replenishment Type},",
				"          {Mtl Transactions Enabled Flag},",
				"          {Minimum Order Quantity},",
				"          {Items$Country Of Origin},",
				"          {Solumina Security Group},",
				"          {Items$Agile Access Restriction},",
				"          {Repo Load Dttm},",
				"          {Right_Repo Load Dttm},",
				"          {Supply/Demand},",
				"          Date = v_date,",
				"          {Expiring Lot Demand},",
				"          {Fixed Lead Time},",
				"          {Right_Minimum Order Quantity},",
				"          {Target Cost},",
				"          {Right_Shelf Life Code},",
				"          Inventory,",
				"          Supply,",
				"          Demand,",
				"          Qty,",
				"          PAB,",
				"          {AR Demand},",
				"          {Demand Toggle},",
				"          Tracker",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select17",
				"select19 aggregate(groupBy(Date,",
				"          {Item Number},",
				"          Org,",
				"          {Planning Group},",
				"          {Demand Toggle},",
				"          Tracker),",
				"     Sum_Demand = sum(Demand),",
				"          Sum_Inventory = sum(Inventory),",
				"          {Sum_AR Demand} = sum({AR Demand}),",
				"          Sum_Supply = sum(Supply),",
				"          Sum_PAB = sum(PAB),",
				"          {Expiring Lot Demand} = sum({Expiring Lot Demand})) ~> aggregate6",
				"select17 derive(Today = iif(Tracker =='Expired Material', toString(addMonths(currentDate(),-3)) , toString(currentDate()) ),",
				"          Max_Date = toString(addMonths(currentDate(),24))) ~> derivedColumn15",
				"select17 sort(asc(Date, true),",
				"     asc({Item Number}, true),",
				"     asc(Org, true),",
				"     asc({Planning Group}, true),",
				"     asc({Demand Toggle}, true),",
				"     asc(Tracker, true)) ~> sort3",
				"sort3 select(mapColumn(",
				"          {Avg Item Cost},",
				"          Buyer,",
				"          {Buyer Org},",
				"          {Extended Cost},",
				"          {Firm Planned Type},",
				"          {Item Avg Cost},",
				"          {Item Description},",
				"          {Item Number},",
				"          {Item Type},",
				"          {List Price},",
				"          {Make Buy},",
				"          {Mrp Planning Method},",
				"          {Order Type},",
				"          Org,",
				"          {PO Price},",
				"          {Postprocessing Lead Time},",
				"          {Preprocessing Lead Time},",
				"          {Processing Lead Time},",
				"          Project,",
				"          {Project Number},",
				"          {Task Number},",
				"          {Using Assembly},",
				"          {Planning Group},",
				"          {Itemcatpur Category Desc},",
				"          {Items$Comsec},",
				"          {Item Revision Control Flag},",
				"          {List Price Per Unit},",
				"          {Lot Control Flag},",
				"          {Serial Number Control Code},",
				"          {Serial Starting Number},",
				"          {Serial Starting Prefix},",
				"          {Shelf Life Code},",
				"          {Shelf Life Days},",
				"          {Shrinkage Rate},",
				"          {Track In Installed Base},",
				"          {Variable Lead Time},",
				"          {Purchase Commod Description},",
				"          {Items$Vmi Item},",
				"          {Items$Target Cost},",
				"          {Hazard Class},",
				"          {Hazard Class Description},",
				"          {Hazardous Material Flag},",
				"          {Item Replenishment Type},",
				"          {Mtl Transactions Enabled Flag},",
				"          {Minimum Order Quantity},",
				"          {Items$Country Of Origin},",
				"          {Solumina Security Group},",
				"          {Items$Agile Access Restriction},",
				"          {Repo Load Dttm},",
				"          {Right_Repo Load Dttm},",
				"          {Supply/Demand},",
				"          Date,",
				"          {Expiring Lot Demand},",
				"          {Fixed Lead Time},",
				"          {Right_Minimum Order Quantity},",
				"          {Target Cost},",
				"          {Right_Shelf Life Code},",
				"          Inventory,",
				"          Supply,",
				"          Demand,",
				"          Qty,",
				"          PAB,",
				"          {AR Demand},",
				"          {Demand Toggle},",
				"          Tracker",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select19",
				"select22 cast(output(",
				"          Inventory as integer,",
				"          Supply as integer,",
				"          PAB as integer",
				"     ),",
				"     errors: false) ~> cast3",
				"aggregate6 select(mapColumn(",
				"          Date,",
				"          {Item Number},",
				"          Org,",
				"          {Planning Group},",
				"          {Demand Toggle},",
				"          Tracker,",
				"          Sum_Demand,",
				"          Sum_Inventory,",
				"          {Sum_AR Demand},",
				"          Sum_Supply,",
				"          Sum_PAB,",
				"          {Expiring Lot Demand}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select20",
				"sort4 aggregate(groupBy(Org,",
				"          {Planning Group},",
				"          {Item Number},",
				"          Max_Date,",
				"          Today,",
				"          {Demand Toggle},",
				"          Tracker),",
				"     v_sample = sum({AR Demand})) ~> aggregate7",
				"derivedColumn15 sort(asc(Org, true),",
				"     asc({Planning Group}, true),",
				"     asc({Item Number}, true),",
				"     asc(Max_Date, true),",
				"     asc(Today, true),",
				"     asc({Demand Toggle}, true),",
				"     asc(Tracker, true)) ~> sort4",
				"filter7 select(mapColumn(",
				"          Org,",
				"          {Planning Group},",
				"          {Item Number},",
				"          Max_Date,",
				"          Today,",
				"          {Demand Toggle},",
				"          Tracker,",
				"          Date = {Promise Date}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select21",
				"surrogateKey1 derive({Promise Date} = toString(addDays(currentDate(),dateIncrementalvalue))) ~> derivedColumn16",
				"aggregate7 keyGenerate(output(dateIncrementalvalue as long),",
				"     startAt: 1L,",
				"     stepValue: 1L) ~> surrogateKey1",
				"derivedColumn14 select(mapColumn(",
				"          each(match(/* All input columns */true()),",
				"               /* Input name */$$ = $$)",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select22",
				"derivedColumn16 filter({Promise Date}<=Max_Date) ~> filter7",
				"select20, select21 join(select20@Date == select21@Date",
				"     && select20@{Item Number} == select21@{Item Number}",
				"     && select20@{Planning Group} == select21@{Planning Group}",
				"     && select20@{Demand Toggle} == select21@{Demand Toggle}",
				"     && select20@Tracker == select21@Tracker",
				"     && select20@Org == select21@Org,",
				"     joinType:'right',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join4",
				"join4 filter(!isNull(Sum_PAB) || !isNull({Expiring Lot Demand}) || !isNull(Sum_Supply)) ~> filter8",
				"filter8 select(mapColumn(",
				"          Date = select20@Date,",
				"          {Item Number} = select20@{Item Number},",
				"          Org = select20@Org,",
				"          {Planning Group} = select20@{Planning Group},",
				"          {Demand Toggle} = select20@{Demand Toggle},",
				"          Tracker = select20@Tracker,",
				"          Sum_Demand,",
				"          Sum_Inventory,",
				"          {Sum_AR Demand},",
				"          Sum_Supply,",
				"          Sum_PAB,",
				"          {Expiring Lot Demand},",
				"          Org = select21@Org,",
				"          {Planning Group} = select21@{Planning Group},",
				"          {Item Number} = select21@{Item Number},",
				"          Max_Date,",
				"          Today,",
				"          {Demand Toggle} = select21@{Demand Toggle},",
				"          Tracker = select21@Tracker,",
				"          Date = select21@Date",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select23",
				"cast4, select4 join(select23@{Item Number} == select4@{Item Number}",
				"     && Org == {Organization Code}",
				"     && select23@{Planning Group} == select4@{Planning Group}",
				"     && Date == {Lot Exp Date},",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join5",
				"join5 sort(asc(Org, true),",
				"     asc(select23@{Planning Group}, true),",
				"     asc(select23@{Item Number}, true),",
				"     asc({Demand Toggle}, true),",
				"     asc(Tracker, true)) ~> sort5",
				"select25, select2 join(select25@{Item Number} == select2@{Item Number}",
				"     && Org == select2@{Organization Code},",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join6",
				"join6, select12 join(select25@{Item Number} == select12@{Item Number}",
				"     && select25@Org == select12@{Organization Code}",
				"     && select25@{Planning Group} == select12@{Planning Group}",
				"     && select25@Tracker == select12@Tracker,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join7",
				"window1 select(mapColumn(",
				"          Date,",
				"          {Item Number} = select23@{Item Number},",
				"          Org,",
				"          {Planning Group} = select23@{Planning Group},",
				"          {Demand Toggle},",
				"          Tracker,",
				"          Sum_Demand,",
				"          Sum_Inventory,",
				"          {Sum_AR Demand},",
				"          Sum_Supply,",
				"          Sum_PAB,",
				"          {Expiring Lot Demand},",
				"          Max_Date,",
				"          Today,",
				"          {Item Number} = select4@{Item Number},",
				"          {Organization Code},",
				"          {Planning Group} = select4@{Planning Group},",
				"          {Lot Exp Date},",
				"          {Expiring QTY},",
				"          RunTot_sum_PAB",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select25",
				"join7 select(mapColumn(",
				"          Org = select25@Org,",
				"          {Item Number} = select25@{Item Number},",
				"          {Planning Group} = select25@{Planning Group},",
				"          {Demand Toggle},",
				"          Tracker = select25@Tracker,",
				"          Sum_PAB,",
				"          RunTot_sum_PAB,",
				"          {Average Cost},",
				"          {Buyer Name},",
				"          {Cum Manufacturing Lead Time},",
				"          {Cumulative Total Lead Time},",
				"          {Fixed Lead Time},",
				"          {Inventory Planning Method Code},",
				"          {Item Creation Date},",
				"          {Item Description},",
				"          {Item Number} = select2@{Item Number},",
				"          {Item Status Code},",
				"          {Item Type},",
				"          {Itemcatinv Item Category Kff},",
				"          {Items$Agile Access Restriction},",
				"          {Items$Agile Item  Part  Catego},",
				"          {Items$Item Setup Verified},",
				"          {Items$Vmi Item},",
				"          {Minimum Order Quantity},",
				"          {Mrp Planning Method},",
				"          {Organization Code} = select2@{Organization Code},",
				"          {Planner Code},",
				"          {Planning Make Buy Code},",
				"          {Postprocessing Lead Time},",
				"          {Preprocessing Lead Time},",
				"          {Processing Lead Time},",
				"          {Purchase Commod},",
				"          {Purchase Commod Description},",
				"          {Receipt Routing},",
				"          {Unit Of Measure},",
				"          {Wip Supply Type},",
				"          {Target Cost},",
				"          {Item Revision Control Flag},",
				"          {Items$Comsec},",
				"          {List Price Per Unit},",
				"          {Lot Control Flag},",
				"          {Serial Number Control Code},",
				"          {Serial Starting Number},",
				"          {Serial Starting Prefix},",
				"          {Shelf Life Code},",
				"          {Shrinkage Rate},",
				"          {Track In Installed Base},",
				"          {Variable Lead Time},",
				"          {Workflow Publishing Data},",
				"          {Fixed Days Supply},",
				"          {Fixed Order Quantity},",
				"          {Right_Minimum Order Quantity},",
				"          {Item Number} = select12@{Item Number},",
				"          {Organization Code} = select12@{Organization Code},",
				"          {Planning Group} = select12@{Planning Group},",
				"          {Min_Lot Exp Date},",
				"          {Sum_Expiring QTY},",
				"          Tracker = select12@Tracker,",
				"          Org = select12@Org,",
				"          MIN_PO_Date,",
				"          {Sum_AR Demand} = select12@{Sum_AR Demand},",
				"          RunTot_sum_PAB",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select26",
				"select23 cast(output(",
				"          Date as date",
				"     ),",
				"     errors: true) ~> cast4",
				"select26, select27 join(select26@Org == select27@Org",
				"     && select26@{Item Number} == select27@{Item Number}",
				"     && select26@{Planning Group} == select27@{Planning Group}",
				"     && select26@{Demand Toggle} == select27@{Demand Toggle}",
				"     && select26@Tracker == select27@Tracker,",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> join8",
				"select20 aggregate(groupBy({Item Number},",
				"          Org,",
				"          {Planning Group},",
				"          {Demand Toggle},",
				"          Tracker),",
				"     {Sum_Sum_AR Demand} = sum({Sum_AR Demand})) ~> aggregate9",
				"aggregate9 select(mapColumn(",
				"          {Item Number},",
				"          Org,",
				"          {Planning Group},",
				"          {Demand Toggle},",
				"          Tracker,",
				"          {Sum_Sum_AR Demand}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select27",
				"join8 select(mapColumn(",
				"          Org = select26@Org,",
				"          {Item Number} = select26@{Item Number},",
				"          {Planning Group} = select26@{Planning Group},",
				"          {Demand Toggle} = select26@{Demand Toggle},",
				"          Tracker = select26@Tracker,",
				"          Sum_PAB,",
				"          RunTot_sum_PAB,",
				"          {Average Cost},",
				"          {Buyer Name},",
				"          {Cum Manufacturing Lead Time},",
				"          {Cumulative Total Lead Time},",
				"          {Fixed Lead Time},",
				"          {Inventory Planning Method Code},",
				"          {Item Creation Date},",
				"          {Item Description},",
				"          {Item Status Code},",
				"          {Item Type},",
				"          {Itemcatinv Item Category Kff},",
				"          {Items$Agile Access Restriction},",
				"          {Items$Agile Item  Part  Catego},",
				"          {Items$Item Setup Verified},",
				"          {Items$Vmi Item},",
				"          {Minimum Order Quantity},",
				"          {Mrp Planning Method},",
				"          {Organization Code},",
				"          {Planner Code},",
				"          {Planning Make Buy Code},",
				"          {Postprocessing Lead Time},",
				"          {Preprocessing Lead Time},",
				"          {Processing Lead Time},",
				"          {Purchase Commod},",
				"          {Purchase Commod Description},",
				"          {Receipt Routing},",
				"          {Unit Of Measure},",
				"          {Wip Supply Type},",
				"          {Target Cost},",
				"          {Item Revision Control Flag},",
				"          {Items$Comsec},",
				"          {List Price Per Unit},",
				"          {Lot Control Flag},",
				"          {Serial Number Control Code},",
				"          {Serial Starting Number},",
				"          {Serial Starting Prefix},",
				"          {Shelf Life Code},",
				"          {Shrinkage Rate},",
				"          {Track In Installed Base},",
				"          {Variable Lead Time},",
				"          {Workflow Publishing Data},",
				"          {Fixed Days Supply},",
				"          {Fixed Order Quantity},",
				"          {Right_Minimum Order Quantity},",
				"          {Min_Lot Exp Date},",
				"          {Sum_Expiring QTY},",
				"          MIN_PO_Date,",
				"          {Sum_AR Demand},",
				"          {Item Number} = select27@{Item Number},",
				"          Org = select27@Org,",
				"          {Planning Group} = select27@{Planning Group},",
				"          {Demand Toggle} = select27@{Demand Toggle},",
				"          Tracker = select27@Tracker,",
				"          {Sum_Sum_AR Demand},",
				"          RunTot_sum_PAB",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select28",
				"select28 derive({PAB Status} = iif(toString(RunTot_sum_PAB) >='0', 'Clear','Short'),",
				"          {Lead Time} = toInteger({Preprocessing Lead Time})+toInteger({Postprocessing Lead Time})+toInteger({Processing Lead Time}),",
				"          {AR Tracking} = iif(toInteger({Sum_Sum_AR Demand}) < 0, 'AR','Not tracked')) ~> derivedColumn17",
				"sort5 window(over(Org,",
				"          select23@{Item Number},",
				"          select23@{Planning Group},",
				"          {Demand Toggle},",
				"          Tracker),",
				"     RunTot_sum_PAB = sum(toInteger(Sum_PAB))) ~> window1",
				"derivedColumn17 derive(LT_Date = toString(addDays(currentDate(),{Lead Time}))) ~> derivedColumn18",
				"derivedColumn18 derive({Order By} = toString(addMonths(currentDate(),-{Lead Time}))) ~> derivedColumn19",
				"derivedColumn19 select(mapColumn(",
				"          Org,",
				"          {Item Number},",
				"          {Planning Group},",
				"          {Demand Toggle},",
				"          Tracker,",
				"          Sum_PAB,",
				"          RunTot_sum_PAB,",
				"          {Average Cost},",
				"          {Buyer Name},",
				"          {Cum Manufacturing Lead Time},",
				"          {Cumulative Total Lead Time},",
				"          {Fixed Lead Time},",
				"          {Inventory Planning Method Code},",
				"          {Item Creation Date},",
				"          {Item Description},",
				"          {Item Status Code},",
				"          {Item Type},",
				"          {Itemcatinv Item Category Kff},",
				"          {Items$Agile Access Restriction},",
				"          {Items$Agile Item  Part  Catego},",
				"          {Items$Item Setup Verified},",
				"          {Items$Vmi Item},",
				"          {Minimum Order Quantity},",
				"          {Mrp Planning Method},",
				"          {Organization Code},",
				"          {Planner Code},",
				"          {Planning Make Buy Code},",
				"          {Postprocessing Lead Time},",
				"          {Preprocessing Lead Time},",
				"          {Processing Lead Time},",
				"          {Purchase Commod},",
				"          {Purchase Commod Description},",
				"          {Receipt Routing},",
				"          {Unit Of Measure},",
				"          {Wip Supply Type},",
				"          {Target Cost},",
				"          {Item Revision Control Flag},",
				"          {Items$Comsec},",
				"          {List Price Per Unit},",
				"          {Lot Control Flag},",
				"          {Serial Number Control Code},",
				"          {Serial Starting Number},",
				"          {Serial Starting Prefix},",
				"          {Shelf Life Code},",
				"          {Shrinkage Rate},",
				"          {Track In Installed Base},",
				"          {Variable Lead Time},",
				"          {Workflow Publishing Data},",
				"          {Fixed Days Supply},",
				"          {Fixed Order Quantity},",
				"          {Right_Minimum Order Quantity},",
				"          {Min_Lot Exp Date},",
				"          {Sum_Expiring QTY},",
				"          MIN_PO_Date,",
				"          {Sum_AR Demand},",
				"          {Sum_Sum_AR Demand},",
				"          {PAB Status},",
				"          {Lead Time},",
				"          {AR Tracking},",
				"          LT_Date,",
				"          {Order By}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select29",
				"select1 select(mapColumn(",
				"          item_description = Item_description,",
				"          {Item Number} = Item_num,",
				"          item_rev = Item_rev,",
				"          {lots$date_code} = {Lots$date_code},",
				"          {lots$die_bin_number} = {Lots$die_bin_number},",
				"          {lots$die_wafer_number} = {Lots$die_wafer_number},",
				"          {lots$mfg_pn} = {Lots$mfg_pn},",
				"          {lots$packaging} = {Lots$packaging},",
				"          lot_creation_date = Lot_creation_date,",
				"          lot_exp_date = Lot_exp_date,",
				"          lot_extended_price = Lot_extended_price,",
				"          lot_number = Lot_number,",
				"          make_buy_code = Make_buy_code,",
				"          material_cost = Material_cost,",
				"          material_overhead_cost = Material_overhead_cost,",
				"          nettable = Nettable,",
				"          onhand_qty = Onhand_qty,",
				"          organization_code = Organization_code,",
				"          orig_date_received = Orig_date_received,",
				"          outside_processing_cost = Outside_processing_cost,",
				"          overhead_cost = Overhead_cost,",
				"          planning_group = Planning_group,",
				"          project_name = Project_name,",
				"          {Project Numbers} = Project_num,",
				"          project_type = Project_type,",
				"          receipt_date = Receipt_date,",
				"          receipt_number = Receipt_number,",
				"          resource_cost = Resource_cost,",
				"          serial_control_code = Serial_control_code,",
				"          service_cat_code = Service_cat_code,",
				"          subinv_custodian = Subinv_custodian,",
				"          supplier_lot_number = Supplier_lot_number,",
				"          task_num = Task_num",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select30",
				"filter1 select(mapColumn(",
				"          each(match(true()),",
				"               initCap(replace($$,'_',' ')) = $$)",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select31",
				"select9 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     umask: 0022,",
				"     preCommands: [],",
				"     postCommands: [],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> sink1"
			]
		}
	}
}